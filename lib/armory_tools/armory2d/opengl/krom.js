(function(e,t){"use strict";function n(e,t){var n=Object.create(e);for(var i in t)n[i]=t[i];return t.toString!==Object.prototype.toString&&(n.toString=t.toString),n}function d(e){return e instanceof Array?f.iter(e):e.iterator()}function r(e,n){if(null==n)return null;null==n.__id__&&(n.__id__=t.$haxeUID++);var i;return null==e.hx__closures__?e.hx__closures__={}:i=e.hx__closures__[n.__id__],null==i&&(i=n.bind(e),e.hx__closures__[n.__id__]=i),i}e.kha=e.kha||{},e.kha.input=e.kha.input||{};var s={},o=function(){return U.__string_rec(this,"")},u=u||{},l=function(e){if(this.lastCanvasH=0,this.lastCanvasW=0,this.lastH=0,this.lastW=0,this.hwin=En.global.nest(0,null),this.selectedElem=null,this.selectedFrame=0,this.rotationSteps=.261799386,this.gridSize=20,this.useRotationSteps=!1,this.gridUseRelative=!0,this.gridSnapPos=!0,this.gridSnapBounds=!1,this.filesDone=null,this.foldersOnly=!1,this.showFiles=!1,this.zoom=1,this.resizeCanvas=!1,this.dragAsset=null,this.assetNames=[""],this.rotate=!1,this.grabY=!1,this.grabX=!1,this.grab=!1,this.dragBottom=!1,this.dragRight=!1,this.dragTop=!1,this.dragLeft=!1,this.drag=!1,this.transformStartedMouse=!1,this.isManipulating=!1,this.currentOperation="",this.dropPath="",this.canvas=e,0<e.assets.length){var t=e.assets;e.assets=[];for(var n=0,i;n<t.length;)i=t[n],++n,this.importAsset(i.file)}K.loadEverything(r(this,this.loaded))},_;s.Elements=l,l.__name__=!0,l.get_uiw=function(){return 0|l.windowW*g.prefs.scaleFactor},l.toRelative=function(e,t){e=H.normalize(e),t=H.normalize(t);for(var n=[],i=e.split("/"),d=t.split("/"),a=0;i[a]==d[a];)++a;for(var r=0,s=d.length-a;r<s;){r++;n.push("..")}for(var o=a,u=i.length;o<u;){var l=o++;n.push(i[l])}return n.join("/")},l.toAbsolute=function(e,t){return H.normalize(t+"/"+e)},l.toDegrees=function(e){return 57.29578*e},l.toRadians=function(e){return .0174532924*e},l.prototype={ui:null,cui:null,canvas:null,toolbarw:null,get_toolbarw:function(){return 0|140*this.ui.SCALE},handleSize:null,get_handleSize:function(){return 0|8*this.ui.SCALE},dropPath:null,currentOperation:null,isManipulating:null,transformInitInput:null,transformInitPos:null,transformInitRot:null,transformInitSize:null,transformStartedMouse:null,drag:null,dragLeft:null,dragTop:null,dragRight:null,dragBottom:null,grab:null,grabX:null,grabY:null,rotate:null,assetNames:null,dragAsset:null,resizeCanvas:null,zoom:null,showFiles:null,foldersOnly:null,filesDone:null,uimodal:null,gridSnapBounds:null,gridSnapPos:null,gridUseRelative:null,useRotationSteps:null,gridSize:null,rotationSteps:null,selectedFrame:null,selectedElem:null,hwin:null,lastW:null,lastH:null,lastCanvasW:null,lastCanvasH:null,loaded:function(){var e=this,n=p.copy(kn.dark);n.FILL_WINDOW_BG=!0,this.ui=new Ln({scaleFactor:g.prefs.scaleFactor,font:K.fonts.font_default,theme:n,color_wheel:K.images.color_wheel}),this.cui=new Ln({scaleFactor:1,font:K.fonts.font_default,autoNotifyInput:!0,theme:kn.light}),this.uimodal=new Ln({font:K.fonts.font_default,scaleFactor:g.prefs.scaleFactor}),pe.notifyOnDropFiles(function(t){e.dropPath=m.rtrim(t),e.dropPath=l.toRelative(e.dropPath,g.cwd)}),pe.notifyOnFrames(r(this,this.onFrames)),_e.addTimeTask(r(this,this.update),0,.016666666666666666)},importAsset:function(e){var t=this,n=m.endsWith(e,".jpg")||m.endsWith(e,".png")||m.endsWith(e,".k")||m.endsWith(e,".hdr"),i=m.endsWith(e,".ttf"),d=l.toAbsolute(e,g.cwd);d="Windows"==pe.get_systemId()?m.replace(d,"/","\\"):d,n?K.loadImageFromPath(d,!1,function(n){var i=e.split("/"),d=i[i.length-1],a=Cn.getAssetId(t.canvas),r={name:d,file:e,id:a};t.canvas.assets.push(r),Cn.assetMap.h[r.id]=n,t.assetNames.push(d),t.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:147,className:"Elements",methodName:"importAsset"}):i&&K.loadFontFromPath(d,function(n){var i=e.split("/"),d=i[i.length-1],a=Cn.getAssetId(t.canvas),r={name:d,file:e,id:a};t.canvas.assets.push(r),Cn.assetMap.h[r.id]=n,t.assetNames.push(d),t.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:159,className:"Elements",methodName:"importAsset"})},unique:function(e){return e},makeElem:function(e){var t="",n=this.cui.t.ELEMENT_H,i=0;0===e?t=this.unique("Text"):1===e?(t=this.unique("Image"),n=100):2===e?(t=this.unique("Button"),i=1):3===e?(t=this.unique("Empty"),n=100):6===e?t=this.unique("Check"):7===e?t=this.unique("Radio"):8===e?t=this.unique("Combo"):9===e?(t=this.unique("Slider"),i=2):10===e?t=this.unique("TextInput"):11===e?t=this.unique("KeyInput"):12===e?(t=this.unique("Filled_Rectangle"),n=100):13===e?(t=this.unique("Rectangle"),n=100):14===e?t=this.unique("Filled_Circle"):15===e?t=this.unique("Circle"):16===e?t=this.unique("Filled_Triangle"):17===e?t=this.unique("Triangle"):18===e?t=this.unique("Progress_bar"):19===e?t=this.unique("CProgress_bar"):void 0;var d={id:Cn.getElementId(this.canvas),type:e,name:t,event:"",x:0,y:0,width:150,height:n,rotation:0,text:"My "+t,asset:"",color:-12040120,color_text:-1513499,color_hover:-12895429,color_press:-15000805,color_progress:-1513499,progress_at:0,progress_total:100,strength:1,alignment:U.__cast(i,Bn),anchor:0,parent:null,children:[],visible:!0};return this.canvas.elements.push(d),d},unparent:function(e){var t=this.elemById(e.parent);null!=t&&(e.x+=this.absx(t),e.y+=this.absy(t),e.parent=null,f.remove(t.children,e.id))},setParent:function(e,t){var n=this.elemById(e.parent);n==t||(this.unparent(e),null!=t&&(null==t.children&&(e.children=[]),t.children.push(e.id),e.parent=t.id,e.x-=this.absx(t),e.y-=this.absy(t)))},duplicateElem:function(e,t){if(null!=e){null==t&&(t=e.parent);var n={id:Cn.getElementId(this.canvas),type:e.type,name:e.name,event:e.event,x:e.x+10,y:e.y+10,width:e.width,height:e.height,rotation:e.rotation,text:e.text,asset:e.asset,color:e.color,color_text:e.color_text,color_hover:e.color_hover,color_press:e.color_press,color_progress:e.color_progress,progress_at:e.progress_at,progress_total:e.progress_total,strength:e.strength,anchor:e.anchor,parent:t,children:[],visible:e.visible};if(this.canvas.elements.push(n),null!=t){var i=this.elemById(t);i.children.push(n.id),e.parent!=t&&(n.x=e.x,n.y=e.y)}for(var d=0,a=e.children,r;d<a.length;)r=a[d],++d,this.duplicateElem(this.elemById(r),n.id);return n}return null},getEnumTexts:function(){return 0<this.assetNames.length?this.assetNames:[""]},getAssetIndex:function(e){for(var t=0,n=this.canvas.assets.length;t<n;){var d=t++;if(e==this.canvas.assets[d].name)return d+1}return 0},resize:function(){null!=l.grid&&(l.grid.unload(),l.grid=null),null!=l.timeline&&(l.timeline.unload(),l.timeline=null)},drawGrid:function(){var e=2*this.gridSize,t=pe.windowWidth(),n=pe.windowHeight(),d=t+2*e,a=n+2*e;l.grid=de.createRenderTarget(d,a),l.grid.get_g2().begin(!0,-14408668);for(var r=0;r<(0|a/e)+1;){var s=r++;l.grid.get_g2().set_color(-14145496),l.grid.get_g2().drawLine(0,s*e,d,s*e),l.grid.get_g2().set_color(-13487566),l.grid.get_g2().drawLine(0,s*e+this.gridSize,d,s*e+this.gridSize)}for(var i=0;i<(0|d/e)+1;){var o=i++;l.grid.get_g2().set_color(-14145496),l.grid.get_g2().drawLine(o*e,0,o*e,a),l.grid.get_g2().set_color(-13487566),l.grid.get_g2().drawLine(o*e+this.gridSize,0,o*e+this.gridSize,a)}l.grid.get_g2().end()},drawTimeline:function(e,t){var n=this.ui.SCALE,d=e+t;l.timeline=de.createRenderTarget(pe.windowWidth()-l.get_uiw()-this.get_toolbarw(),d);var a=l.timeline.get_g2();a.begin(!0,-14540254),a.set_font(K.fonts.font_default),a.set_fontSize(0|16*n);for(var r=0|l.timeline.get_width()/(11*n),s=0;s<(0|r/5)+1;){var o=s++,i=5*o,u=K.fonts.font_default.width(a.get_fontSize(),i+"");a.drawString(i+"",55*o*n+5*n-u/2,e/2-a.get_fontSize()/2)}for(var _=0;_<r;){var f=_++;a.set_color(0==f%5?-12303292:-13421773),a.fillRect(11*f*n,d-t,10*n,t)}a.end()},onFrames:function(e){var t=this,n=e[0];""!=this.dropPath&&(this.importAsset(this.dropPath),this.dropPath="");var i=this.ui.SCALE,d=0|30*i,r=0|40*i;null==l.grid&&this.drawGrid(),(null==l.timeline||l.timeline.get_height()!=d+r)&&this.drawTimeline(d,r);var s=n.get_g2();if(s.begin(),s.set_color(-1),s.drawImage(l.grid,l.coffX%40-40,l.coffY%40-40),this.canvas.x=l.coffX,this.canvas.y=l.coffY,s.drawRect(this.canvas.x,this.canvas.y,0|this.canvas.width*this.cui.SCALE,0|this.canvas.height*this.cui.SCALE,1),s.drawRect(this.canvas.x+(0|this.canvas.width*this.cui.SCALE)-3,this.canvas.y+(0|this.canvas.height*this.cui.SCALE)-3,6,6,1),Cn.screenW=this.canvas.width,Cn.screenH=this.canvas.height,Cn.draw(this.cui,this.canvas,s),null!=this.selectedElem){s.set_color(-1);var o=0|this.absx(this.selectedElem)*this.cui.SCALE,u=0|this.absy(this.selectedElem)*this.cui.SCALE,_=0|this.selectedElem.width*this.cui.SCALE,c=0|this.selectedElem.height*this.cui.SCALE,p=this.canvas.x+o+_/2,b=this.canvas.y+u+c/2;s.pushRotation(this.selectedElem.rotation,p,b),s.drawRect(this.canvas.x+o,this.canvas.y+u,_,c),s.set_color(-16777216),s.drawRect(this.canvas.x+o+1,this.canvas.y+u+1,_,c),s.set_color(-1);for(var S=this.rotatePoint(this.ui.inputX,this.ui.inputY,p,b,-this.selectedElem.rotation),T=0;3>T;)for(var E=T++,C=E/2,I=0;3>I;){var v=I++,k=v/2;if(.5!=C||.5!=k){var L=this.canvas.x+o+_*C-(0|8*this.ui.SCALE)/2,O=this.canvas.y+u+c*k-(0|8*this.ui.SCALE)/2,N=!1;0==C&&this.dragLeft?0==k&&this.dragTop?N=!0:.5!=k||this.dragTop||this.dragBottom?1==k&&this.dragBottom&&(N=!0):N=!0:.5!=C||this.dragLeft||this.dragRight?1==C&&this.dragRight&&(0==k&&this.dragTop?N=!0:.5!=k||this.dragTop||this.dragBottom?1==k&&this.dragBottom&&(N=!0):N=!0):0==k&&this.dragTop?N=!0:1==k&&this.dragBottom&&(N=!0),N=N&&this.drag,(S.x>L&&S.x<L+(0|8*this.ui.SCALE)||N)&&(S.y>O&&S.y<O+(0|8*this.ui.SCALE)||N)&&(s.set_color(-14656100),s.fillRect(L,O,0|8*this.ui.SCALE,0|8*this.ui.SCALE),s.set_color(-1)),s.drawRect(L,O,0|8*this.ui.SCALE,0|8*this.ui.SCALE)}}s.drawLine(p,this.canvas.y+u,p,this.canvas.y+u-2*(0|8*this.ui.SCALE));var A=p,P=this.canvas.y+u-2*(0|8*this.ui.SCALE);null==P&&(P=0),null==A&&(A=0);var R=A,V=P,D=S.x-R,F=S.y-V;null==F&&(F=0),null==D&&(D=0);var M=D,H=F;(Math.sqrt(M*M+H*H)<=(0|8*this.ui.SCALE)/2||this.rotate)&&(s.set_color(-14656100),ut.fillCircle(s,R,V,(0|8*this.ui.SCALE)/2),s.set_color(-1)),ut.drawCircle(s,R,V,(0|8*this.ui.SCALE)/2),s.popTransformation()}""!=this.currentOperation&&(s.set_fontSize(0|14*this.ui.SCALE),s.set_color(-5592406),s.drawString(this.currentOperation,this.get_toolbarw(),pe.windowHeight()-l.timeline.get_height()-s.get_fontSize()));s.set_color(-1);var W=pe.windowHeight()-l.timeline.get_height();s.drawImage(l.timeline,this.get_toolbarw(),W),s.set_color(-14656100),s.fillRect(this.get_toolbarw()+11*this.selectedFrame*i,W+d,10*i,r),s.set_font(K.fonts.font_default),s.set_fontSize(0|16*i);var U=4*i,G=4*i,z=30*i,X=K.fonts.font_default.width(s.get_fontSize(),""+this.selectedFrame);if(X>z+G&&(z=X+G),s.fillRect(this.get_toolbarw()+11*this.selectedFrame*i+5*i-z/2,W+U,z,d-2*U),s.set_color(-1),s.drawString(""+this.selectedFrame,this.get_toolbarw()+11*this.selectedFrame*i+5*i-X/2,W+d/2-s.get_fontSize()/2),(s.end(),this.ui.begin(s),this.ui.window(En.global.nest(1,null),0,0,this.get_toolbarw(),pe.windowHeight())&&(this.ui.text("Add Elements:"),this.ui.panel(En.global.nest(2,{selected:!0}),"Basic")&&(this.ui.indent(),this.ui.button("Empty")&&(this.selectedElem=this.makeElem(3)),this.ui.isHovered&&this.ui.tooltip("Creates empty element"),this.ui.button("Text")&&(this.selectedElem=this.makeElem(0)),this.ui.isHovered&&this.ui.tooltip("Create text element"),this.ui.button("Image")&&(this.selectedElem=this.makeElem(1)),this.ui.isHovered&&this.ui.tooltip("Creates image element"),this.ui.unindent()),this.ui.panel(En.global.nest(3,{selected:!0}),"Buttons")&&(this.ui.indent(),this.ui.button("Button")&&(this.selectedElem=this.makeElem(2)),this.ui.isHovered&&this.ui.tooltip("Creates button element"),this.ui.button("Check")&&(this.selectedElem=this.makeElem(6)),this.ui.isHovered&&this.ui.tooltip("Creates check box element"),this.ui.button("Radio")&&(this.selectedElem=this.makeElem(7)),this.ui.isHovered&&this.ui.tooltip("Creates inline-radio element"),this.ui.unindent()),this.ui.panel(En.global.nest(4,{selected:!0}),"Inputs")&&(this.ui.indent(),this.ui.button("Text Input")&&(this.selectedElem=this.makeElem(10)),this.ui.isHovered&&this.ui.tooltip("Creates text input element"),this.ui.button("Key Input")&&(this.selectedElem=this.makeElem(11)),this.ui.isHovered&&this.ui.tooltip("Creates key input element"),this.ui.button("Combo Box")&&(this.selectedElem=this.makeElem(8)),this.ui.isHovered&&this.ui.tooltip("Creates combo box element"),this.ui.button("Slider")&&(this.selectedElem=this.makeElem(9)),this.ui.isHovered&&this.ui.tooltip("Creates slider element"),this.ui.unindent()),this.ui.panel(En.global.nest(5,{selected:!0}),"Shapes")&&(this.ui.indent(),this.ui.button("Rect")&&(this.selectedElem=this.makeElem(13)),this.ui.isHovered&&this.ui.tooltip("Creates rectangle shaped element"),this.ui.button("Fill Rect")&&(this.selectedElem=this.makeElem(12)),this.ui.isHovered&&this.ui.tooltip("Creates filled rectangle shaped element"),this.ui.button("Circle")&&(this.selectedElem=this.makeElem(15)),this.ui.isHovered&&this.ui.tooltip("Creates circle shaped element"),this.ui.button("Fill Circle")&&(this.selectedElem=this.makeElem(14)),this.ui.isHovered&&this.ui.tooltip("Creates filled circle shaped element"),this.ui.button("Triangle")&&(this.selectedElem=this.makeElem(17)),this.ui.isHovered&&this.ui.tooltip("Creates triangle shaped element"),this.ui.button("Fill Triangle")&&(this.selectedElem=this.makeElem(16)),this.ui.isHovered&&this.ui.tooltip("Creates filled triangle shaped element"),this.ui.unindent()),this.ui.panel(En.global.nest(6,{selected:!0}),"ProgressBars")&&(this.ui.indent(),this.ui.button("RectPB")&&(this.selectedElem=this.makeElem(18)),this.ui.isHovered&&this.ui.tooltip("Creates rectangular progress bar"),this.ui.button("CircularPB")&&(this.selectedElem=this.makeElem(19)),this.ui.isHovered&&this.ui.tooltip("Creates circular progress bar"),this.ui.unindent())),this.ui.window(En.global.nest(7,null),this.get_toolbarw(),0,pe.windowWidth()-l.get_uiw()-this.get_toolbarw(),0|(this.ui.t.ELEMENT_H+2)*this.ui.SCALE)&&this.ui.tab(En.global.nest(8,null),this.canvas.name),this.ui.window(this.hwin,pe.windowWidth()-l.get_uiw(),0,l.get_uiw(),pe.windowHeight()))){var Y=En.global.nest(9,null);if(this.ui.tab(Y,"Project")){if(this.ui.button("Save")){this.canvas.x=0,this.canvas.y=0,Krom.fileSaveBytes(g.prefs.path,B.ofString(JSON.stringify(this.canvas)).b.bufferValue);var j=f.substr(g.prefs.path,0,g.prefs.path.length-5);j+=".files";for(var Z="",q=0,Q=this.canvas.assets,J;q<Q.length;)J=Q[q],++q,Z+=J.file+"\n";Krom.fileSaveBytes(j,B.ofString(Z).b.bufferValue),this.canvas.x=l.coffX,this.canvas.y=l.coffY}if(this.ui.panel(En.global.nest(10,{selected:!1}),"Canvas")){this.ui.indent(),this.ui.button("New")&&(this.canvas.elements=[],this.selectedElem=null),this.ui.isHovered&&this.ui.tooltip("Create new canvas");var $=this.ui,ee=En.global.nest(11,{text:this.canvas.name});this.canvas.name=$.textInput(ee,"Name",2),this.ui.row([.5,.5]);var te=En.global.nest(12,{text:this.canvas.width+""}),ne=En.global.nest(13,{text:this.canvas.height+""});te.text=this.canvas.width+"",ne.text=this.canvas.height+"";var ie=this.ui.textInput(te,"Width",2),de=this.ui.textInput(ne,"Height",2);this.canvas.width=h.parseInt(ie),this.canvas.height=h.parseInt(de),this.ui.unindent()}if(this.ui.panel(En.global.nest(14,{selected:!0}),"Outliner")){this.ui.indent();var ae=null;ae=function(e,n){var d=!1;t.selectedElem==n&&(t.ui.g.set_color(-14656100),t.ui.g.fillRect(0,t.ui._y,t.ui._windowW,t.ui.t.ELEMENT_H*t.ui.SCALE),t.ui.g.set_color(-1));var a=t.ui.getStarted();if(a&&!t.ui.inputDownR&&(t.selectedElem=n),a&&t.ui.inputDownR&&(n==t.selectedElem?t.unparent(n):t.setParent(t.selectedElem,n)),null!=n.children&&0<n.children.length?(t.ui.row([.07692307692307693,.9230769230769231]),d=t.ui.panel(e.nest(n.id,{selected:!0}),"",0,!0),t.ui.text(n.name)):(t.ui._x+=18,t.ui.text(n.name),t.ui._x-=18),d)for(var r=n.children.length;0<r;){--r;var s=n.children[n.children.length-1-r];t.ui.indent();var o=t.elemById(s);ae(e,o),t.ui.unindent()}};for(var re=0,se=this.canvas.elements.length;re<se;){var oe=re++,ue=this.canvas.elements[this.canvas.elements.length-1-oe];if(null==ue.parent){var le=En.global.nest(15,null);ae(le,ue)}}this.ui.row([.25,.25,.25,.25]);this.canvas.elements;this.ui.button("Up")&&null!=this.selectedElem&&this.moveElem(1),this.ui.isHovered&&this.ui.tooltip("Move element up"),this.ui.button("Down")&&null!=this.selectedElem&&this.moveElem(-1),this.ui.isHovered&&this.ui.tooltip("Move element down"),this.ui.button("Remove")&&null!=this.selectedElem&&this.removeSelectedElem(),this.ui.isHovered&&this.ui.tooltip("Delete element"),this.ui.button("Duplicate")&&null!=this.selectedElem&&(this.selectedElem=this.duplicateElem(this.selectedElem)),this.ui.isHovered&&this.ui.tooltip("Create duplicate of element"),this.ui.unindent()}if(null!=this.selectedElem){var _e=this.selectedElem,fe=_e.id;if(this.ui.panel(En.global.nest(16,{selected:!0}),"Properties")){this.ui.indent();var ce=null==_e.visible||_e.visible;_e.visible=this.ui.check(En.global.nest(17,null).nest(fe,{selected:ce}),"Visible"),_e.name=this.ui.textInput(En.global.nest(18,null).nest(fe,{text:_e.name}),"Name",2),_e.text=this.ui.textInput(En.global.nest(19,null).nest(fe,{text:_e.text}),"Text",2),this.ui.row([.25,.25,.25,.25]);var ge=_e.x+"",he=En.global.nest(20,null).nest(fe,{text:ge}),me=_e.y+"",be=En.global.nest(21,null).nest(fe,{text:me});he.text=_e.x+"",be.text=_e.y+"";var xe=this.ui.textInput(he,"X",2),Se=this.ui.textInput(be,"Y",2);_e.x=parseFloat(xe),_e.y=parseFloat(Se);var ye=_e.width+"",we=En.global.nest(22,null).nest(fe,{text:ye}),Te=_e.height+"",Ee=En.global.nest(23,null).nest(fe,{text:Te});we.text=_e.width+"",Ee.text=_e.height+"";var Ce=this.ui.textInput(we,"W",2),Ie=this.ui.textInput(Ee,"H",2);if(_e.width=0|parseFloat(Ce),_e.height=0|parseFloat(Ie),13==_e.type||15==_e.type||17==_e.type||18==_e.type||19==_e.type){var ve=_e.strength+"",ke=En.global.nest(24,null).nest(fe,{text:ve}),Le=this.ui.textInput(ke,"Line Strength",2);_e.strength=0|parseFloat(Le)}if(18==_e.type||19==_e.type){var Be=_e.progress_at+"",Oe=En.global.nest(25,null).nest(fe,{text:Be}),Ne=this.ui.textInput(Oe,"Progress",2),Ae=_e.progress_total+"",Pe=En.global.nest(26,null).nest(fe,{text:Ae}),Re=this.ui.textInput(Pe,"Total Progress",2);_e.progress_total=0|parseFloat(Re),_e.progress_at=0|parseFloat(Ne)}var Ve=En.global.nest(27,null).nest(fe,{value:this.roundPrecision(57.29578*(null==_e.rotation?0:_e.rotation),2)});Ve.value=this.roundPrecision(57.29578*_e.rotation,2),360<=Ve.value&&(Ve.value=0),_e.rotation=.0174532924*this.ui.slider(Ve,"Rotation",0,360,!0);var De=this.ui.combo(En.global.nest(28,null).nest(fe,{position:this.getAssetIndex(_e.asset)}),this.getEnumTexts(),"Asset",!0,2);_e.asset=this.getEnumTexts()[De],this.ui.unindent()}if(this.ui.panel(En.global.nest(29,{selected:!1}),"Color")&&(this.ui.indent(),0==_e.type?(this.ui.text("Text:"),_e.color_text=In.colorWheel(this.ui,En.global.nest(30,null).nest(fe,{color:_e.color_text}),!0,null,!0)):2==_e.type?(this.ui.text("Text:"),_e.color_text=In.colorWheel(this.ui,En.global.nest(31,null).nest(fe,{color:_e.color_text}),!0,null,!0),this.ui.text("Background:"),_e.color=In.colorWheel(this.ui,En.global.nest(32,null).nest(fe,{color:_e.color}),!0,null,!0),this.ui.text("On Hover:"),_e.color_hover=In.colorWheel(this.ui,En.global.nest(33,null).nest(fe,{color:_e.color_hover}),!0,null,!0),this.ui.text("On Pressed:"),_e.color_press=In.colorWheel(this.ui,En.global.nest(34,null).nest(fe,{color:_e.color_press}),!0,null,!0)):12==_e.type||14==_e.type||13==_e.type||15==_e.type||17==_e.type||16==_e.type?(this.ui.text("Color:"),_e.color=In.colorWheel(this.ui,En.global.nest(35,null).nest(fe,{color:_e.color}),!0,null,!0)):18==_e.type||19==_e.type?(this.ui.text("Progress:"),_e.color_progress=In.colorWheel(this.ui,En.global.nest(36,null).nest(fe,{color:_e.color_progress}),!0,null,!0),this.ui.text("Background:"),_e.color=In.colorWheel(this.ui,En.global.nest(37,null).nest(fe,{color:_e.color}),!0,null,!0)):3==_e.type?this.ui.text("No color for element type empty"):(this.ui.text("Text:"),_e.color_text=In.colorWheel(this.ui,En.global.nest(38,null).nest(fe,{color:_e.color_text}),!0,null,!0),this.ui.text("Background:"),_e.color=In.colorWheel(this.ui,En.global.nest(39,null).nest(fe,{color:_e.color}),!0,null,!0),this.ui.text("On Hover:"),_e.color_hover=In.colorWheel(this.ui,En.global.nest(40,null).nest(fe,{color:_e.color_hover}),!0,null,!0)),this.ui.unindent()),this.ui.panel(En.global.nest(41,{selected:!1}),"Align")){this.ui.indent();var Fe=En.global.nest(42,null).nest(fe,{position:_e.alignment});this.ui.row([.3333333333333333,.3333333333333333,.3333333333333333]),this.ui.radio(Fe,0,"Left"),this.ui.radio(Fe,1,"Center"),this.ui.radio(Fe,2,"Right"),this.selectedElem.alignment=Fe.position,this.ui.unindent()}if(this.ui.panel(En.global.nest(43,{selected:!1}),"Anchor")){this.ui.indent();var Me=En.global.nest(44,null).nest(fe,{position:_e.anchor});this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(Me,0,"Top-Left"),this.ui.radio(Me,1,"Top"),this.ui.radio(Me,2,"Top-Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(Me,3,"Left"),this.ui.radio(Me,4,"Center"),this.ui.radio(Me,5,"Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(Me,6,"Bot-Left"),this.ui.radio(Me,7,"Bottom"),this.ui.radio(Me,8,"Bot-Right"),_e.anchor=Me.position,this.ui.unindent()}this.ui.panel(En.global.nest(45,{selected:!1}),"Script")&&(this.ui.indent(),_e.event=this.ui.textInput(En.global.nest(46,null).nest(fe,{text:_e.event}),"Event",2),this.ui.unindent());this.ui.panel(En.global.nest(47,{selected:!1}),"Timeline")}}if(this.ui.tab(Y,"Assets"))if(this.ui.button("Import Asset")&&(this.showFiles=!0,this.foldersOnly=!1,this.filesDone=function(e){e=m.rtrim(e),e=l.toRelative(e,g.cwd),t.importAsset(e)}),0<this.canvas.assets.length){this.ui.text("(Drag and drop assets to canvas)",1);for(var He=this.canvas.assets.length-1;0<=He;){var We=this.canvas.assets[He],Ue=m.endsWith(We.name,".ttf");Ue||1!=this.ui.image(this.getImage(We))||(this.dragAsset=We),this.ui.row([.875,.125]),We.name=this.ui.textInput(En.global.nest(48,null).nest(We.id,{text:We.name}),"",2),this.assetNames[He+1]=We.name,this.ui.button("X")&&(this.getImage(We).unload(),this.canvas.assets.splice(He,1),this.assetNames.splice(He+1,1)),--He}}else this.ui.text("(Drag and drop images and fonts here)",1);if(this.ui.tab(Y,"Preferences")){if(this.ui.panel(En.global.nest(49,{selected:!0}),"Application")){this.ui.indent();var Ge=En.global.nest(50,{value:1});this.ui.slider(Ge,"UI Scale",.5,4,!0),Ge.changed&&!this.ui.inputDown&&(this.ui.setScale(Ge.value),l.windowW=0|l.defaultWindowW*Ge.value);var ze=this.ui,Xe=En.global.nest(51,{selected:!0});g.prefs.window_vsync=ze.check(Xe,"VSync"),this.ui.unindent()}if(this.ui.panel(En.global.nest(52,{selected:!0}),"Grid")){this.ui.indent();var Ye=En.global.nest(53,{value:20});this.ui.slider(Ye,"Grid Size",1,128,!0,1),this.gridSnapPos=this.ui.check(En.global.nest(54,{selected:!0}),"Grid Snap Position"),this.ui.isHovered&&this.ui.tooltip("Snap the element's position to the grid"),this.gridSnapBounds=this.ui.check(En.global.nest(55,{selected:!1}),"Grid Snap Bounds"),this.ui.isHovered&&this.ui.tooltip("Snap the element's bounds to the grid"),this.gridUseRelative=this.ui.check(En.global.nest(56,{selected:!0}),"Use Relative Grid"),this.ui.isHovered&&this.ui.tooltip("Use a grid that's relative to the selected element"),Ye.changed&&!this.ui.inputDown&&(this.gridSize=0|Ye.value),this.useRotationSteps=this.ui.check(En.global.nest(57,{selected:!1}),"Use Fixed Rotation Steps"),this.ui.isHovered&&this.ui.tooltip("Rotate elements by a fixed step size");var je=En.global.nest(58,{value:15});this.useRotationSteps&&this.ui.slider(je,"Rotation Step Size",1,180,!0,1),je.changed&&!this.ui.inputDown&&(this.rotationSteps=.0174532924*je.value),this.ui.unindent()}if(this.ui.panel(En.global.nest(59,{selected:!0}),"Shortcuts")){this.ui.indent(),this.ui.row([.5,.5]),this.ui.text("Select");var Ze=En.global.nest(60,{position:0});this.ui.combo(Ze,["Left Click","Right Click"],""),this.ui.isHovered&&this.ui.tooltip("Mouse button used for element selection."),Ze.changed&&(g.prefs.keyMap.selectMouseButton=["Left","Right"][Ze.position]),this.ui.separator(8,!1),this.ui.row([.5,.5]),this.ui.text("Grab");var Ke=this.ui,qe=En.global.nest(61,{value:71});g.prefs.keyMap.grabKey=In.keyInput(Ke,qe,"Key"),this.ui.isHovered&&this.ui.tooltip("Key used for grabbing elements"),this.ui.row([.5,.5]),this.ui.text("Rotate");var Qe=this.ui,Je=En.global.nest(62,{value:82});g.prefs.keyMap.rotateKey=In.keyInput(Qe,Je,"Key"),this.ui.isHovered&&this.ui.tooltip("Key used for rotating elements"),this.ui.row([.5,.5]),this.ui.text("Size");var $e=this.ui,et=En.global.nest(63,{value:83});g.prefs.keyMap.sizeKey=In.keyInput($e,et,"Key"),this.ui.isHovered&&this.ui.tooltip("Key used for resizing elements"),this.ui.separator(8,!1),this.ui.row([.5,.5]),this.ui.text("Precision Transform");var tt=this.ui,nt=En.global.nest(64,{value:16});g.prefs.keyMap.slowMovement=In.keyInput(tt,nt,"Key"),this.ui.isHovered&&this.ui.tooltip("More precise transformations"),this.ui.row([.5,.5]),this.ui.text("Invert Grid");var it=this.ui,dt=En.global.nest(65,{value:17});g.prefs.keyMap.gridInvert=In.keyInput(it,dt,"Key"),this.ui.isHovered&&this.ui.tooltip("Invert the grid setting"),this.ui.row([.5,.5]),this.ui.text("Invert Rel. Grid");var at=this.ui,rt=En.global.nest(66,{value:18});g.prefs.keyMap.gridInvertRelative=In.keyInput(at,rt,"Key"),this.ui.isHovered&&this.ui.tooltip("Invert the relative grid setting"),this.ui.unindent()}this.ui.panel(En.global.nest(67,{selected:!1}),"Console")&&(this.ui.indent(),this.ui.text("Mouse X: "+this.ui.inputX),this.ui.text("Mouse Y: "+this.ui.inputY),this.ui.unindent())}}if(this.ui.end(),this.ui.changed&&!this.ui.inputDown&&this.drawGrid(),s.begin(!1),null!=this.dragAsset){var st=Math.min(128,this.getImage(this.dragAsset).get_width()),w=st/this.getImage(this.dragAsset).get_width(),ot=this.getImage(this.dragAsset).get_height()*w;s.drawScaledImage(this.getImage(this.dragAsset),this.ui.inputX,this.ui.inputY,st,ot)}s.end(),0<this.lastW&&(this.lastW!=pe.windowWidth()||this.lastH!=pe.windowHeight())?this.resize():0<this.lastCanvasW&&(this.lastCanvasW!=this.canvas.width||this.lastCanvasH!=this.canvas.height)&&this.resize(),this.lastW=pe.windowWidth(),this.lastH=pe.windowHeight(),this.lastCanvasW=this.canvas.width,this.lastCanvasH=this.canvas.height,this.showFiles&&this.renderFiles(s)},elemById:function(t){for(var n=0,i=this.canvas.elements,d;n<i.length;)if(d=i[n],++n,d.id==t)return d;return null},moveElem:function(e){for(var t=this.canvas.elements,n=t.indexOf(this.selectedElem),d=this.selectedElem.parent;n+=e,!(0>n||n>=t.length);)if(t[n].parent==d){f.remove(t,this.selectedElem),t.splice(n,0,this.selectedElem);break}},getImage:function(e){return Cn.assetMap.h[e.id]},removeElem:function(e){if(null!=e.children)for(var t=0,n=e.children,i;t<n.length;)i=n[t],++t,this.removeElem(this.elemById(i));f.remove(this.canvas.elements,e),null!=e.parent&&(f.remove(this.elemById(e.parent).children,e.id),e.parent=null)},removeSelectedElem:function(){this.removeElem(this.selectedElem),this.selectedElem=null},acceptDrag:function(e){var t=this.makeElem(1);t.asset=this.assetNames[e+1],t.x=this.ui.inputX-this.canvas.x,t.y=this.ui.inputY-this.canvas.y,t.width=this.getImage(this.canvas.assets[e]).get_width(),t.height=this.getImage(this.canvas.assets[e]).get_height(),this.selectedElem=t},hitbox:function(e,t,n,i,d){var a=this.rotatePoint(this.ui.inputX,this.ui.inputY,e+n/2,t+i/2,-d);return!!(a.x>e&&a.x<e+n&&a.y>t)&&a.y<t+i},update:function(){if(this.ui.inputReleased&&null!=this.dragAsset){if(this.ui.inputX<pe.windowWidth()-l.get_uiw()){for(var e=0,t=0,n=this.canvas.assets.length,d;t<n;)if(d=t++,this.canvas.assets[d]==this.dragAsset){e=d;break}this.acceptDrag(e)}this.dragAsset=null}if(null==this.dragAsset){if(this.updateCanvas(),null!=l.timeline){var a=pe.windowHeight()-l.timeline.get_height();this.ui.inputDown&&this.ui.inputY>a&&this.ui.inputX<pe.windowWidth()-l.get_uiw()&&this.ui.inputX>this.get_toolbarw()&&(this.selectedFrame=0|(this.ui.inputX-this.get_toolbarw())/11/this.ui.SCALE)}if(null!=this.selectedElem){var r=this.selectedElem,s=0|this.absx(r)*this.cui.SCALE,o=0|this.absy(r)*this.cui.SCALE,u=0|r.width*this.cui.SCALE,_=0|r.height*this.cui.SCALE,f=this.rotatePoint(this.ui.inputX,this.ui.inputY,this.canvas.x+s+u/2,this.canvas.y+o+_/2,-r.rotation);if(this.ui.inputStarted&&this.ui.inputDown)if(this.hitbox(this.canvas.x+s-(0|8*this.ui.SCALE)/2,this.canvas.y+o-(0|8*this.ui.SCALE)/2,u+(0|8*this.ui.SCALE),_+(0|8*this.ui.SCALE),this.selectedElem.rotation))this.drag=!0,this.dragLeft=this.dragRight=this.dragTop=this.dragBottom=!1,f.x>this.canvas.x+s+u-(0|8*this.ui.SCALE)?this.dragRight=!0:f.x<this.canvas.x+s+(0|8*this.ui.SCALE)&&(this.dragLeft=!0),f.y>this.canvas.y+o+_-(0|8*this.ui.SCALE)?this.dragBottom=!0:f.y<this.canvas.y+o+(0|8*this.ui.SCALE)&&(this.dragTop=!0),this.startElementManipulation(!0);else{var c=this.canvas.x+s+u/2,p=this.canvas.y+o-2*(0|8*this.ui.SCALE);null==p&&(p=0),null==c&&(c=0);var h=c,m=p,b=f.x-h,S=f.y-m;null==S&&(S=0),null==b&&(b=0);var w=b,T=S;Math.sqrt(w*w+T*T)<=(0|8*this.ui.SCALE)&&(this.rotate=!0,this.startElementManipulation(!0))}if(this.isManipulating)if(this.hwin.redraws=2,this.transformStartedMouse&&this.ui.inputReleased||!this.transformStartedMouse&&this.ui.inputStarted)this.endElementManipulation();else if(this.ui.isKeyPressed&&this.ui.isEscapeDown||this.ui.inputStartedR)this.endElementManipulation(!0);else if(this.drag){var E=this.ui.inputX,C=this.ui.inputY;null==C&&(C=0),null==E&&(E=0);var I=E,v=C,k=this.transformInitInput,L=I-k.x,B=v-k.y;null==B&&(B=0),null==L&&(L=0);var O=L,N=B;this.transformStartedMouse||(this.ui.isKeyPressed&&88==this.ui.key&&(r.width=0|this.transformInitSize.x,r.height=0|this.transformInitSize.y,this.dragRight=!0,this.dragBottom=!this.dragBottom),this.ui.isKeyPressed&&89==this.ui.key&&(r.width=0|this.transformInitSize.x,r.height=0|this.transformInitSize.y,this.dragBottom=!0,this.dragRight=!this.dragRight)),this.dragRight?(O=this.calculateTransformDelta(O,this.transformInitPos.x+this.transformInitSize.x),r.width=0|this.transformInitSize.x+O):this.dragLeft&&(O=this.calculateTransformDelta(O,this.transformInitPos.x),r.x=this.transformInitPos.x+O,r.width=0|this.transformInitSize.x-O),this.dragBottom?(N=this.calculateTransformDelta(N,this.transformInitPos.y+this.transformInitSize.y),r.height=0|this.transformInitSize.y+N):this.dragTop&&(N=this.calculateTransformDelta(N,this.transformInitPos.y),r.y=this.transformInitPos.y+N,r.height=0|this.transformInitSize.y-N),1!=r.type&&(1>r.width&&(r.width=1),1>r.height&&(r.height=1)),this.dragLeft||this.dragRight||this.dragBottom||this.dragTop?(this.dragBottom||this.dragTop?!this.dragLeft&&!this.dragRight&&(N=0):N=0,this.currentOperation=" x: "+r.x+"  y: "+r.y+"  w: "+r.width+"  h: "+r.height+"  (dx: "+O+"  dy: "+N+")"):(this.grab=!0,this.grabX=!0,this.grabY=!0,this.drag=!1)}else if(this.grab){var A=this.ui.inputX,P=this.ui.inputY;null==P&&(P=0),null==A&&(A=0);var R=A,V=P,D=this.transformInitInput,F=R-D.x,M=V-D.y;null==M&&(M=0),null==F&&(F=0);var H=F,W=M;this.ui.isKeyPressed&&88==this.ui.key&&(r.x=this.transformInitPos.x,r.y=this.transformInitPos.y,this.grabX=!0,this.grabY=!this.grabY),this.ui.isKeyPressed&&89==this.ui.key&&(r.x=this.transformInitPos.x,r.y=this.transformInitPos.y,this.grabY=!0,this.grabX=!this.grabX),this.grabX&&(H=this.calculateTransformDelta(H,this.transformInitPos.x),r.x=0|this.transformInitPos.x+H),this.grabY&&(W=this.calculateTransformDelta(W,this.transformInitPos.y),r.y=0|this.transformInitPos.y+W),this.grabX?!this.grabY&&(W=0):H=0,this.currentOperation=" x: "+r.x+"  y: "+r.y+"  (dx: "+H+"  dy: "+W+")"}else if(this.rotate){var U=this.canvas.x+s+u/2,G=this.canvas.y+o+_/2;null==G&&(G=0),null==U&&(U=0);var z=U,X=G,Y=this.ui.inputX,j=this.ui.inputY;null==j&&(j=0),null==Y&&(Y=0);var Z=Y,K=j,q=Z-z,Q=K-X;null==Q&&(Q=0),null==q&&(q=0);var J=q,$=Q,ee=-Math.atan2(J,$)+Math.PI;(this.ui.isKeyDown&&this.ui.key==g.prefs.keyMap.gridInvert)!=this.useRotationSteps&&(ee=Math.round(ee/this.rotationSteps)*this.rotationSteps),r.rotation=ee,this.currentOperation=" Rot: "+this.roundPrecision(57.29578*ee,2)+"deg"}this.ui.isKeyPressed&&!this.ui.isTyping&&(!this.grab&&this.ui.key==g.prefs.keyMap.grabKey&&(this.startElementManipulation(),this.grab=!0,this.grabX=!0,this.grabY=!0),!this.drag&&this.ui.key==g.prefs.keyMap.sizeKey&&(this.startElementManipulation(),this.drag=!0,this.dragLeft=!1,this.dragTop=!1,this.dragRight=!0,this.dragBottom=!0),!this.rotate&&this.ui.key==g.prefs.keyMap.rotateKey&&(this.startElementManipulation(),this.rotate=!0),!this.isManipulating&&(37==this.ui.key&&(this.gridSnapPos?r.x-=this.gridSize:r.x--),39==this.ui.key&&(this.gridSnapPos?r.x+=this.gridSize:r.x++),38==this.ui.key&&(this.gridSnapPos?r.y-=this.gridSize:r.y--),40==this.ui.key&&(this.gridSnapPos?r.y+=this.gridSize:r.y++),this.ui.isBackspaceDown||this.ui.isDeleteDown?this.removeSelectedElem():68==this.ui.key&&(this.selectedElem=this.duplicateElem(r))))}else this.endElementManipulation();this.updateFiles()}},startElementManipulation:function(e){null==e&&(e=!1),this.isManipulating&&this.endElementManipulation(!0),this.transformInitInput=new cn(this.ui.inputX,this.ui.inputY),this.transformInitPos=new cn(this.selectedElem.x,this.selectedElem.y),this.transformInitSize=new cn(this.selectedElem.width,this.selectedElem.height),this.transformInitRot=this.selectedElem.rotation,this.transformStartedMouse=e,this.isManipulating=!0},endElementManipulation:function(e){null==e&&(e=!1),e&&(this.selectedElem.x=this.transformInitPos.x,this.selectedElem.y=this.transformInitPos.y,this.selectedElem.width=0|this.transformInitSize.x,this.selectedElem.height=0|this.transformInitSize.y,this.selectedElem.rotation=this.transformInitRot),this.isManipulating=!1,this.grab=!1,this.drag=!1,this.rotate=!1,this.transformStartedMouse=!1,this.currentOperation=""},updateCanvas:function(){if(!(this.showFiles||this.ui.inputX>pe.windowWidth()-l.get_uiw())){var e=g.prefs.keyMap.selectMouseButton;if("Left"==e&&this.ui.inputStarted&&this.ui.inputDown||"Right"==e&&this.ui.inputStartedR&&this.ui.inputDownR)for(var t=this.canvas.elements.length,n=0,i=this.canvas.elements,d;n<i.length;){d=i[n],++n;var a=0|this.absx(d)*this.cui.SCALE,r=0|this.absy(d)*this.cui.SCALE,s=0|d.width*this.cui.SCALE,o=0|d.height*this.cui.SCALE;if(this.hitbox(this.canvas.x+a,this.canvas.y+r,s,o,d.rotation)&&this.selectedElem!=d){this.selectedElem=d;break}}this.isManipulating||(this.ui.inputDownR&&(l.coffX+=0|this.ui.inputDX,l.coffY+=0|this.ui.inputDY),0!=this.ui.inputWheelDelta&&(this.zoom+=-this.ui.inputWheelDelta/10,.4>this.zoom?this.zoom=.4:1<this.zoom&&(this.zoom=1),this.zoom=Math.round(10*this.zoom)/10,this.cui.SCALE=this.cui.ops.scaleFactor*this.zoom)),this.ui.inputStarted&&this.hitbox(this.canvas.x+(0|this.canvas.width*this.cui.SCALE)-3,this.canvas.y+(0|this.canvas.height*this.cui.SCALE)-3,6,6)&&(this.resizeCanvas=!0),this.ui.inputReleased&&this.resizeCanvas&&(this.resizeCanvas=!1),this.resizeCanvas&&(this.canvas.width+=0|this.ui.inputDX,this.canvas.height+=0|this.ui.inputDY,1>this.canvas.width&&(this.canvas.width=1),1>this.canvas.height&&(this.canvas.height=1))}},updateFiles:function(){if(this.showFiles&&this.ui.inputReleased){var e=pe.windowWidth(),t=pe.windowHeight(),n=e/2-l.modalRectW/2,i=e/2+l.modalRectW/2,d=t/2-l.modalRectH/2,a=t/2+l.modalRectH/2;(this.ui.inputX<n||this.ui.inputX>i||this.ui.inputY<d+l.modalHeaderH||this.ui.inputY>a)&&(this.showFiles=!1)}},renderFiles:function(e){var t=pe.windowWidth(),n=pe.windowHeight(),i=t/2-l.modalW/2,d=n/2-l.modalH/2;e.begin(!1),e.set_color(-14671840),e.fillRect(i,d,l.modalW,l.modalH),e.end();var a=0|t/2-l.modalRectW/2,r=0|t/2+l.modalRectW/2,s=0|n/2-l.modalRectH/2,o=0|n/2+l.modalRectH/2;if(s+=l.modalHeaderH,this.uimodal.begin(e),this.uimodal.window(En.global.nest(68,null),a,s,l.modalRectW,l.modalRectH-100)){var u=En.global.nest(69,null);u.text=this.uimodal.textInput(u),l.path=In.fileBrowser(this.uimodal,u,this.foldersOnly)}this.uimodal.end(!1),e.begin(!1),this.uimodal.beginLayout(e,r-100,o-30,100),this.uimodal.button("OK")&&(this.showFiles=!1,this.filesDone(l.path)),this.uimodal.endLayout(!1),this.uimodal.beginLayout(e,r-200,o-30,100),this.uimodal.button("Cancel")&&(this.showFiles=!1),this.uimodal.endLayout(),e.end()},absx:function(t){return null==t?0:t.x+this.absx(this.elemById(t.parent))},absy:function(t){return null==t?0:t.y+this.absy(this.elemById(t.parent))},roundPrecision:function(e,t){return null==t&&(t=0),e*=Math.pow(10,t),e=1*(0|e),e/=Math.pow(10,t),e},rotatePoint:function(e,t,n,i,d){e-=n,t-=i;var a=e*Math.cos(d)-t*Math.sin(d),r=e*Math.sin(d)+t*Math.cos(d);return new cn(n+a,i+r)},calculateTransformDelta:function(e,t){null==t&&(t=0);var n=this.ui.isKeyDown&&this.ui.key==g.prefs.keyMap.slowMovement,i=this.gridSnapPos!=(this.ui.isKeyDown&&this.ui.key==g.prefs.keyMap.gridInvert),d=this.gridUseRelative!=(this.ui.isKeyDown&&this.ui.key==g.prefs.keyMap.gridInvertRelative);return i?(e=Math.round(e/this.gridSize)*this.gridSize,n&&(e/=2),d&&0!=t&&(t%=this.gridSize,t>this.gridSize/2&&(t=-(this.gridSize-t)),e-=t),e):n?e/2:e},scaled:function(e){return 0|e*this.cui.SCALE},__class__:l};var f=function(){};s.HxOverrides=f,f.__name__=!0,f.strDate=function(e){switch(e.length){case 8:var n=e.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(n[0]),i.setUTCMinutes(n[1]),i.setUTCSeconds(n[2]),i;case 10:var d=e.split("-");return new Date(d[0],d[1]-1,d[2],0,0,0);case 19:var a=e.split(" "),r=a[0].split("-"),s=a[1].split(":");return new Date(r[0],r[1]-1,r[2],s[0],s[1],s[2]);default:throw new W("Invalid date format : "+e);}},f.cca=function(e,t){var n=e.charCodeAt(t);return n==n?n:void 0},f.substr=function(e,t,n){if(null==n)n=e.length;else if(0>n)if(0==t)n=e.length+n;else return"";return e.substr(t,n)},f.remove=function(e,t){var n=e.indexOf(t);return-1!=n&&(e.splice(n,1),!0)},f.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var c=function(){};s.Lambda=c,c.__name__=!0,c.array=function(e){for(var t=[],n=d(e);n.hasNext();){var i=n.next();t.push(i)}return t};var g=function(){};s.Main=g,g.__name__=!0,g.main=function(){var e=1600,t=900;null!=J.get_primary()&&(e>J.get_primary().get_width()&&(e=J.get_primary().get_width()),t>J.get_primary().get_height()-30&&(t=J.get_primary().get_height()-30)),pe.start(new ge("Armory2D",e,t,null,new ne(null,null,null,null,null,2)),g.initialized)},g.initialized=function(){g.prefs={path:"",scaleFactor:1,keyMap:{selectMouseButton:"Left",grabKey:71,rotateKey:82,sizeKey:83,slowMovement:16,gridInvert:17,gridInvertRelative:18}};var e=Krom.getArgCount();if(4<e&&(g.prefs.path=Krom.getArg(3)),5<e){var t=parseFloat(Krom.getArg(4));g.prefs.scaleFactor=t}var n=g.prefs.path.split("/");n.pop(),g.cwd=n.join("/");var i="Windows"==pe.get_systemId()?m.replace(g.prefs.path,"/","\\"):g.prefs.path;K.loadBlobFromPath(i,function(e){var t=JSON.parse(e.toString());g.inst=new l(t)},null,{fileName:"Main.hx",lineNumber:51,className:"Main",methodName:"initialized"})},g.loadDefaultKeyMap=function(){g.prefs.keyMap.grabKey=71,g.prefs.keyMap.rotateKey=82,g.prefs.keyMap.sizeKey=83,g.prefs.keyMap.slowMovement=16,g.prefs.keyMap.gridInvert=17,g.prefs.keyMap.gridInvertRelative=18},Math.__name__=!0;var p=function(){};s.Reflect=p,p.__name__=!0,p.field=function(e,t){try{return e[t]}catch(t){t instanceof W?t.val:t;return null}},p.fields=function(e){var t=[];if(null!=e){var n=Object.prototype.hasOwnProperty;for(var i in e)"__id__"!=i&&"hx__closures__"!=i&&n.call(e,i)&&t.push(i)}return t},p.isFunction=function(e){return!("function"!=typeof e)&&!(e.__name__||e.__ename__)},p.copy=function(e){if(null==e)return null;for(var t={},n=0,i=p.fields(e);n<i.length;){var d=i[n];++n,t[d]=p.field(e,d)}return t};var h=function(){};s.Std=h,h.__name__=!0,h.string=function(e){return U.__string_rec(e,"")},h.parseInt=function(e){var t=parseInt(e,e&&"0"==e[0]&&("x"==e[1]||"X"==e[1])?16:10);return isNaN(t)?null:t};var m=function(){};s.StringTools=m,m.__name__=!0,m.endsWith=function(e,t){var n=t.length,i=e.length;return!!(i>=n)&&e.indexOf(t,i-n)==i-n},m.isSpace=function(e,t){var n=f.cca(e,t);return!!(8<n&&14>n)||32==n},m.rtrim=function(e){for(var t=e.length,n=0;n<t&&m.isSpace(e,t-n-1);)++n;return 0<n?f.substr(e,0,t-n):e},m.replace=function(e,t,n){return e.split(t).join(n)};var b=function(){};s.Type=b,b.__name__=!0,b.createEnum=function(t,e,n){var i=p.field(t,e);if(null==i)throw new W("No such constructor "+e);if(p.isFunction(i)){if(null==n)throw new W("Constructor "+e+" need parameters");return i.apply(t,n)}if(null!=n&&0!=n.length)throw new W("Constructor "+e+" does not need parameters");return i},b.getInstanceFields=function(e){var t=[];for(var n in e.prototype)t.push(n);return f.remove(t,"__class__"),f.remove(t,"__properties__"),t};var S={};s["_UInt.UInt_Impl_"]=S,S.__name__=!0,S.gt=function(e,t){var n=0>e;return n==0>t?e>t:n},S.gte=function(e,t){var n=0>e;return n==0>t?e>=t:n},S.toFloat=function(e){var t=e;return 0>t?4294967296+t:t+0};var y=function(){};s["haxe.IMap"]=y,y.__name__=!0,y.__isInterface__=!0;var w=function(){};s["haxe.Log"]=w,w.__name__=!0,w.formatOutput=function(e,t){var n=h.string(e);if(null==t)return n;var i=t.fileName+":"+t.lineNumber;if(null!=t.customParams)for(var d=0,a=t.customParams,r;d<a.length;)r=a[d],++d,n+=", "+h.string(r);return i+": "+n},w.trace=function(e,t){var n=w.formatOutput(e,t);"undefined"!=typeof console&&null!=console.log&&console.log(n)};var T=function(){};s["haxe._Unserializer.DefaultResolver"]=T,T.__name__=!0,T.prototype={resolveClass:function(e){return s[e]},resolveEnum:function(e){return u[e]},__class__:T};var E=function(e){this.buf=e,this.length=e.length,this.pos=0,this.scache=[],this.cache=[];var t=E.DEFAULT_RESOLVER;null==t&&(t=new T,E.DEFAULT_RESOLVER=t),this.resolver=t};s["haxe.Unserializer"]=E,E.__name__=!0,E.initCodes=function(){for(var e=[],t=0,n=E.BASE64.length;t<n;){var d=t++;e[E.BASE64.charCodeAt(d)]=d}return e},E.run=function(e){return new E(e).unserialize()},E.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var e=0,t=!1,n=this.pos,i;i=this.buf.charCodeAt(this.pos),i==i;){if(45==i){if(this.pos!=n)break;t=!0,this.pos++;continue}if(48>i||57<i)break;e=10*e+(i-48),this.pos++}return t&&(e*=-1),e},readFloat:function(){for(var e=this.pos;;){var t=this.buf.charCodeAt(this.pos);if(t!=t)break;if(43<=t&&58>t||101==t||69==t)this.pos++;else break}return parseFloat(f.substr(this.buf,e,this.pos-e))},unserializeObject:function(e){for(;;){if(this.pos>=this.length)throw new W("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var t=this.unserialize();if("string"!=typeof t)throw new W("Invalid object key");var n=this.unserialize();e[t]=n}this.pos++},unserializeEnum:function(e,t){if(58!=this.buf.charCodeAt(this.pos++))throw new W("Invalid enum format");var n=this.readDigits();if(0==n)return b.createEnum(e,t);for(var i=[];0<n--;)i.push(this.unserialize());return b.createEnum(e,t,i)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var t=this.unserialize(),r=this.resolver.resolveClass(t);if(null==r)throw new W("Class not found "+t);return r;case 66:var u=this.unserialize(),_=this.resolver.resolveEnum(u);if(null==_)throw new W("Enum not found "+u);return _;case 67:var e=this.unserialize(),g=this.resolver.resolveClass(e);if(null==g)throw new W("Class not found "+e);var p=Object.create(g.prototype);if(this.cache.push(p),p.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new W("Invalid custom data");return p;case 77:var o=new k;this.cache.push(o);for(var h=this.buf,m;104!=this.buf.charCodeAt(this.pos);)m=this.unserialize(),o.set(m,this.unserialize());return this.pos++,o;case 82:var b=this.readDigits();if(0>b||b>=this.scache.length)throw new W("Invalid string reference");return this.scache[b];case 97:var n=this.buf,x=[];for(this.cache.push(x);;){var a=this.buf.charCodeAt(this.pos);if(104==a){this.pos++;break}if(117==a){this.pos++;var c=this.readDigits();x[x.length+c-1]=null}else x.push(this.unserialize())}return x;case 98:var S=new L;this.cache.push(S);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var y=this.unserialize(),w=this.unserialize();null==Vn[y]?S.h[y]=w:S.setReserved(y,w)}return this.pos++,S;case 99:var T=this.unserialize(),v=this.resolver.resolveClass(T);if(null==v)throw new W("Class not found "+T);var O=Object.create(v.prototype);return this.cache.push(O),this.unserializeObject(O),O;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var N=this.unserialize(),A=this.resolver.resolveEnum(N);if(null==A)throw new W("Enum not found "+N);this.pos++;var P=this.readDigits(),R=A.__constructs__.slice()[P];if(null==R)throw new W("Unknown enum index "+N+"@"+P);var V=this.unserializeEnum(A,R);return this.cache.push(V),V;case 107:return NaN;case 108:var D=new I;this.cache.push(D);for(this.buf;104!=this.buf.charCodeAt(this.pos);)D.add(this.unserialize());return this.pos++,D;case 109:return-Infinity;case 110:return null;case 111:var l={};return this.cache.push(l),this.unserializeObject(l),l;case 112:return 1/0;case 113:var F=new C;this.cache.push(F);for(var M=this.buf,H=this.buf.charCodeAt(this.pos++);58==H;){var U=this.readDigits(),i=this.unserialize();F.h[U]=i,H=this.buf.charCodeAt(this.pos++)}if(104!=H)throw new W("Invalid IntMap format");return F;case 114:var G=this.readDigits();if(0>G||G>=this.cache.length)throw new W("Invalid reference");return this.cache[G];case 115:var z=this.readDigits(),X=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<z)throw new W("Invalid bytes length");var Y=E.CODES;null==Y&&(Y=E.initCodes(),E.CODES=Y);for(var j=this.pos,Z=3&z,K=3*(z>>2)+(2<=Z?Z-1:0),q=j+(z-Z),Q=new B(new ArrayBuffer(K)),J=0;j<q;){var $=Y[X.charCodeAt(j++)],ee=Y[X.charCodeAt(j++)];Q.b[J++]=$<<2|ee>>4;var te=Y[X.charCodeAt(j++)];Q.b[J++]=ee<<4|te>>2;var ne=Y[X.charCodeAt(j++)];Q.b[J++]=te<<6|ne}if(2<=Z){var ie=Y[X.charCodeAt(j++)],de=Y[X.charCodeAt(j++)];if(Q.b[J++]=ie<<2|de>>4,3==Z){var ae=Y[X.charCodeAt(j++)];Q.b[J++]=de<<4|ae>>2}}return this.pos+=z,this.cache.push(Q),Q;case 116:return!0;case 118:var re;return 48<=this.buf.charCodeAt(this.pos)&&57>=this.buf.charCodeAt(this.pos)&&48<=this.buf.charCodeAt(this.pos+1)&&57>=this.buf.charCodeAt(this.pos+1)&&48<=this.buf.charCodeAt(this.pos+2)&&57>=this.buf.charCodeAt(this.pos+2)&&48<=this.buf.charCodeAt(this.pos+3)&&57>=this.buf.charCodeAt(this.pos+3)&&45==this.buf.charCodeAt(this.pos+4)?(re=f.strDate(f.substr(this.buf,this.pos,19)),this.pos+=19):re=new Date(this.readFloat()),this.cache.push(re),re;case 119:var se=this.unserialize(),oe=this.resolver.resolveEnum(se);if(null==oe)throw new W("Enum not found "+se);var ue=this.unserializeEnum(oe,this.unserialize());return this.cache.push(ue),ue;case 120:throw W.wrap(this.unserialize());case 121:var le=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<le)throw new W("Invalid string length");var _e=f.substr(this.buf,this.pos,le);return this.pos+=le,_e=decodeURIComponent(_e.split("+").join(" ")),this.scache.push(_e),_e;case 122:return 0;default:}throw this.pos--,new W("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:E};var C=function(){this.h={}};s["haxe.ds.IntMap"]=C,C.__name__=!0,C.__interfaces__=[y],C.prototype={h:null,keys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)?e.push(0|t):null;return f.iter(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref[e]}}},__class__:C};var I=function(){this.length=0};s["haxe.ds.List"]=I,I.__name__=!0,I.prototype={h:null,q:null,length:null,add:function(e){var t=new v(e,null);null==this.h?this.h=t:this.q.next=t,this.q=t,this.length++},__class__:I};var v=function(e,t){this.item=e,this.next=t};s["haxe.ds._List.ListNode"]=v,v.__name__=!0,v.prototype={item:null,next:null,__class__:v};var k=function(){this.h={__keys__:{}}};s["haxe.ds.ObjectMap"]=k,k.__name__=!0,k.__interfaces__=[y],k.prototype={h:null,set:function(e,n){var i=e.__id__||(e.__id__=t.$haxeUID++);this.h[i]=n,this.h.__keys__[i]=e},__class__:k};var L=function(){this.h={}};s["haxe.ds.StringMap"]=L,L.__name__=!0,L.__interfaces__=[y],L.prototype={h:null,rh:null,setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},__class__:L};var B=function(e){this.length=e.byteLength,this.b=new Uint8Array(e),this.b.bufferValue=e,e.hxBytes=this,e.bytes=this.b};s["haxe.io.Bytes"]=B,B.__name__=!0,B.ofString=function(e,t){if(t==V.RawNative){for(var n=new Uint8Array(e.length<<1),d=0,r=e.length;d<r;){var s=d++,i=e.charCodeAt(s);n[s<<1]=255&i,n[1|s<<1]=i>>8}return new B(n.buffer)}for(var o=[],a=0;a<e.length;){var u=e.charCodeAt(a++);55296<=u&&56319>=u&&(u=u-55232<<10|1023&e.charCodeAt(a++)),127>=u?o.push(u):2047>=u?(o.push(192|u>>6),o.push(128|63&u)):65535>=u?(o.push(224|u>>12),o.push(128|63&u>>6),o.push(128|63&u)):(o.push(240|u>>18),o.push(128|63&u>>12),o.push(128|63&u>>6),o.push(128|63&u))}return new B(new Uint8Array(o).buffer)},B.ofData=function(e){var t=e.hxBytes;return null==t?new B(e):t},B.prototype={length:null,b:null,data:null,blit:function(e,t,n,i){if(0>e||0>n||0>i||e+i>this.length||n+i>t.length)throw new W(F.OutsideBounds);0==n&&i==t.b.byteLength?this.b.set(t.b,e):this.b.set(t.b.subarray(n,n+i),e)},sub:function(e,t){if(0>e||0>t||e+t>this.length)throw new W(F.OutsideBounds);return new B(this.b.buffer.slice(e+this.b.byteOffset,e+this.b.byteOffset+t))},getDouble:function(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat64(e,!0)},getFloat:function(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(e,!0)},setDouble:function(e,t){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat64(e,t,!0)},setFloat:function(e,t){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(e,t,!0)},getUInt16:function(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(e,!0)},getInt32:function(e){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(e,!0)},setInt32:function(e,t){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(e,t,!0)},getString:function(e,t,n){if(0>e||0>t||e+t>this.length)throw new W(F.OutsideBounds);null==n&&(n=V.UTF8);var d="",a=this.b,r=e,o=e+t;switch(n._hx_index){case 0:for(;r<o;){var l=a[r++];if(128>l){if(0==l)break;d+=String.fromCodePoint(l)}else if(224>l){var _=(63&l)<<6|127&a[r++];d+=String.fromCodePoint(_)}else if(240>l){var f=a[r++],c=(31&l)<<12|(127&f)<<6|127&a[r++];d+=String.fromCodePoint(c)}else{var g=a[r++],p=a[r++],h=(15&l)<<18|(127&g)<<12|(127&p)<<6|127&a[r++];d+=String.fromCodePoint(h)}}break;case 1:for(;r<o;){var u=a[r++]|a[r++]<<8;d+=String.fromCodePoint(u)}}return d},toString:function(){return this.getString(0,this.length)},__class__:B};var O=function(){this.pos=0,this.size=0};s["haxe.io.BytesBuffer"]=O,O.__name__=!0,O.prototype={buffer:null,view:null,u8:null,pos:null,size:null,addByte:function(e){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,e)},addBytes:function(e,t,n){if(0>t||0>n||t+n>e.length)throw new W(F.OutsideBounds);if(this.pos+n>this.size&&this.grow(n),0!=this.size){var i=new Uint8Array(e.b.buffer,e.b.byteOffset+t,n);this.u8.set(i,this.pos),this.pos+=n}},grow:function(e){for(var t=this.pos+e,n=0==this.size?16:this.size;n<t;)n=3*n>>1;var i=new ArrayBuffer(n),d=new Uint8Array(i);0<this.size&&d.set(this.u8),this.size=n,this.buffer=i,this.u8=d,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new B(new ArrayBuffer(0));var e=new B(this.buffer);return e.length=this.pos,e},__class__:O};var N=function(){};s["haxe.io.Input"]=N,N.__name__=!0,N.prototype={bigEndian:null,readByte:function(){throw new W("Not implemented")},readBytes:function(e,t,n){var i=n,d=e.b;if(0>t||0>n||t+n>e.length)throw new W(F.OutsideBounds);try{for(;0<i;)d[t]=this.readByte(),++t,--i}catch(e){var a=e instanceof W?e.val:e;if(a instanceof D);else throw e}return n-i},readFullBytes:function(e,t,n){for(;0<n;){var i=this.readBytes(e,t,n);if(0==i)throw new W(F.Blocked);t+=i,n-=i}},read:function(e){for(var t=new B(new ArrayBuffer(e)),n=0;0<e;){var i=this.readBytes(t,n,e);if(0==i)throw new W(F.Blocked);n+=i,e-=i}return t},readInt32:function(){var e=this.readByte(),t=this.readByte(),n=this.readByte(),i=this.readByte();return this.bigEndian?i|n<<8|t<<16|e<<24:e|t<<8|n<<16|i<<24},readString:function(e,t){var n=new B(new ArrayBuffer(e));return this.readFullBytes(n,0,e),n.getString(0,e,t)},__class__:N};var A=function(e,t,n){if(null==t&&(t=0),null==n&&(n=e.length-t),0>t||0>n||t+n>e.length)throw new W(F.OutsideBounds);this.b=e.b,this.pos=t,this.len=n,this.totlen=n};s["haxe.io.BytesInput"]=A,A.__name__=!0,A.__super__=N,A.prototype=n(N.prototype,{b:null,pos:null,len:null,totlen:null,set_position:function(e){return 0>e?e=0:e>this.totlen&&(e=this.totlen),this.len=this.totlen-e,this.pos=e},readByte:function(){if(0==this.len)throw new W(new D());return this.len--,this.b[this.pos++]},readBytes:function(e,t,n){if(0>t||0>n||t+n>e.length)throw new W(F.OutsideBounds);if(0==this.len&&0<n)throw new W(new D());this.len<n&&(n=this.len);for(var d=this.b,a=e.b,r=0,s=n,o;r<s;)o=r++,a[t+o]=d[this.pos+o];return this.pos+=n,this.len-=n,n},__class__:A});var P=function(){};s["haxe.io.Output"]=P,P.__name__=!0,P.prototype={bigEndian:null,writeByte:function(){throw new W("Not implemented")},writeBytes:function(e,t,n){if(0>t||0>n||t+n>e.length)throw new W(F.OutsideBounds);for(var i=e.b,d=n;0<d;)this.writeByte(i[t]),++t,--d;return n},write:function(e){for(var t=e.length,n=0;0<t;){var i=this.writeBytes(e,n,t);if(0==i)throw new W(F.Blocked);n+=i,t-=i}},writeFloat:function(e){this.writeInt32(M.floatToI32(e))},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(255&e>>16),this.writeByte(255&e>>8),this.writeByte(255&e)):(this.writeByte(255&e),this.writeByte(255&e>>8),this.writeByte(255&e>>16),this.writeByte(e>>>24))},__class__:P};var R=function(){this.b=new O};s["haxe.io.BytesOutput"]=R,R.__name__=!0,R.__super__=P,R.prototype=n(P.prototype,{b:null,writeByte:function(e){this.b.addByte(e)},writeBytes:function(e,t,n){return this.b.addBytes(e,t,n),n},getBytes:function(){return this.b.getBytes()},__class__:R});var V=u["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:o},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:o}},D=function(){};s["haxe.io.Eof"]=D,D.__name__=!0,D.prototype={toString:function(){return"Eof"},__class__:D};var F=u["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:o},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:o},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:o},Custom:(_=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:o}},_.__params__=["e"],_)},M=function(){};s["haxe.io.FPHelper"]=M,M.__name__=!0,M.floatToI32=function(e){return M.helper.setFloat32(0,e,!0),M.helper.getInt32(0,!0)};var H=function(){};s["haxe.io.Path"]=H,H.__name__=!0,H.normalize=function(e){if(e=e.split("\\").join("/"),"/"==e)return"/";for(var t=[],n=0,i=e.split("/"),d;n<i.length;)d=i[n],++n,".."==d&&0<t.length&&".."!=t[t.length-1]?t.pop():""==d?(0<t.length||47==f.cca(e,0))&&t.push(d):"."!=d&&t.push(d);for(var a=t.join("/"),r="",o=!1,u=!1,l=0,_=a;l<_.length;){var g=_,s=l++,p=g.charCodeAt(s);55296<=p&&56319>=p&&(p=p-55232<<10|1023&g.charCodeAt(s+1));var h=p;65536<=h&&++l;var m=h;switch(m){case 47:if(!o)u=!0;else{o=!1,u&&(r+="/",u=!1),r+=String.fromCodePoint(m)}break;case 58:r+=":",o=!0;break;default:o=!1,u&&(r+="/",u=!1),r+=String.fromCodePoint(m);}}return r};var W=function(e){Error.call(this),this.val=e,Error.captureStackTrace&&Error.captureStackTrace(this,W)};s["js._Boot.HaxeError"]=W,W.__name__=!0,W.wrap=function(e){return e instanceof Error?e:new W(e)},W.__super__=Error,W.prototype=n(Error.prototype,{val:null,__class__:W});var U=function(){};s["js.Boot"]=U,U.__name__=!0,U.getClass=function(e){if(null==e)return null;if(e instanceof Array)return Array;var t=e.__class__;if(null!=t)return t;var n=U.__nativeClassName(e);return null==n?null:U.__resolveNativeClass(n)},U.__string_rec=function(d,a){if(null==d)return"null";if(5<=a.length)return"<...>";var r=typeof d;switch("function"==r&&(d.__name__||d.__ename__)&&(r="object"),r){case"function":return"<function>";case"object":if(d.__enum__){var o=u[d.__enum__],e=o.__constructs__[d._hx_index],n=o[e];return n.__params__?(a+="\t",e+"("+function(){for(var e=[],t=0,i=n.__params__,r,s;!!(t<i.length);)s=i[t],++t,e.push(U.__string_rec(d[s],a));return r=e,r}(this).join(",")+")"):e}if(d instanceof Array){var l="[";a+="\t";for(var _=0,f=d.length,c;_<f;)c=_++,l+=(0<c?",":"")+U.__string_rec(d[c],a);return l+="]",l}var g;try{g=d.toString}catch(e){e instanceof W?e.val:e;return"???"}if(null!=g&&g!=Object.toString&&"function"==typeof g){var p=d.toString();if("[object Object]"!=p)return p}var h="{\n";a+="\t";var m=null!=d.hasOwnProperty,b=null;for(b in d)(!m||d.hasOwnProperty(b))&&"prototype"!=b&&"__class__"!=b&&"__super__"!=b&&"__interfaces__"!=b&&"__properties__"!=b&&(2!=h.length&&(h+=", \n"),h+=a+b+" : "+U.__string_rec(d[b],a));return a=a.substring(1),h+="\n"+a+"}",h;case"string":return d;default:return d+"";}},U.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;if(Object.prototype.hasOwnProperty.call(e,"__interfaces__"))for(var n=e.__interfaces__,d=0,a=n.length;d<a;){var r=d++,i=n[r];if(i==t||U.__interfLoop(i,t))return!0}return U.__interfLoop(e.__super__,t)},U.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array;case An:return"boolean"==typeof e;case On:return null!=e;case Nn:return"number"==typeof e;case Bn:return!("number"!=typeof e)&&(0|e)==e;break;case String:return"string"==typeof e;default:if(!(null!=e))return!1;else if("function"==typeof t){if(U.__downcastCheck(e,t))return!0;}else if("object"==typeof t&&U.__isNativeObj(t)&&e instanceof t)return!0;return t==Pn&&null!=e.__name__||t==Rn&&null!=e.__ename__||null!=e.__enum__&&u[e.__enum__]==t;}},U.__downcastCheck=function(e,t){return!!(e instanceof t)||!!t.__isInterface__&&U.__interfLoop(U.getClass(e),t)},U.__cast=function(e,n){if(null==e||U.__instanceof(e,n))return e;throw new W("Cannot cast "+h.string(e)+" to "+h.string(n))},U.__nativeClassName=function(e){var t=U.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},U.__isNativeObj=function(e){return null!=U.__nativeClassName(e)},U.__resolveNativeClass=function(e){return t[e]};var G=function(){};s["js.lib._ArrayBuffer.ArrayBufferCompat"]=G,G.__name__=!0,G.sliceImpl=function(e,t){var n=new Uint8Array(this,e,null==t?null:t-e),i=new Uint8Array(n.byteLength);return i.set(n),i.buffer};var z=function(){this.names=["color_wheel"],this.color_wheelDescription={name:"color_wheel",original_height:270,original_width:360,files:["color_wheel.png"],type:"image"},this.color_wheelName="color_wheel",this.color_wheel=null};s["kha._Assets.ImageList"]=z,z.__name__=!0,z.prototype={get:function(e){return p.field(this,e)},color_wheel:null,color_wheelName:null,color_wheelDescription:null,color_wheelLoad:function(e,t){K.loadImage("color_wheel",function(){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:126,className:"kha._Assets.ImageList",methodName:"color_wheelLoad"})},color_wheelUnload:function(){this.color_wheel.unload(),this.color_wheel=null},names:null,__class__:z};var X=function(){this.names=[]};s["kha._Assets.SoundList"]=X,X.__name__=!0,X.prototype={get:function(e){return p.field(this,e)},names:null,__class__:X};var Y=function(){this.names=[]};s["kha._Assets.BlobList"]=Y,Y.__name__=!0,Y.prototype={get:function(e){return p.field(this,e)},names:null,__class__:Y};var j=function(){this.names=["font_default"],this.font_defaultDescription={name:"font_default",files:["font_default.ttf"],type:"font"},this.font_defaultName="font_default",this.font_default=null};s["kha._Assets.FontList"]=j,j.__name__=!0,j.prototype={get:function(e){return p.field(this,e)},font_default:null,font_defaultName:null,font_defaultDescription:null,font_defaultLoad:function(e,t){K.loadFont("font_default",function(){e()},t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:138,className:"kha._Assets.FontList",methodName:"font_defaultLoad"})},font_defaultUnload:function(){this.font_default.unload(),this.font_default=null},names:null,__class__:j};var Z=function(){this.names=[]};s["kha._Assets.VideoList"]=Z,Z.__name__=!0,Z.prototype={get:function(e){return p.field(this,e)},names:null,__class__:Z};var K=function(){};s["kha.Assets"]=K,K.__name__=!0,K.loadEverything=function(e,t,n,d){for(var a=[z,X,Y,j,Z],r=[K.images,K.sounds,K.blobs,K.fonts,K.videos],s=0,o=0;o<a.length;){var u=a[o];++o;for(var l=0,_=b.getInstanceFields(u);l<_.length;){var f=_[l];++l,m.endsWith(f,"Description")&&(s+=1)}}if(0==s)return void e();for(var c=s,g=function(e,t,i){var d=e.name;switch(e.type){case"blob":K.loadBlob(d,function(){t()},i,{fileName:"kha/Assets.hx",lineNumber:122,className:"kha.Assets",methodName:"loadEverything"});break;case"font":K.loadFont(d,function(){t()},i,{fileName:"kha/Assets.hx",lineNumber:124,className:"kha.Assets",methodName:"loadEverything"});break;case"image":K.loadImage(d,function(){t()},i,{fileName:"kha/Assets.hx",lineNumber:113,className:"kha.Assets",methodName:"loadEverything"});break;case"sound":K.loadSound(d,function(i){null==n||n(e)?i.uncompress(t):t()},i,{fileName:"kha/Assets.hx",lineNumber:115,className:"kha.Assets",methodName:"loadEverything"});break;case"video":K.loadVideo(d,function(){t()},i,{fileName:"kha/Assets.hx",lineNumber:126,className:"kha.Assets",methodName:"loadEverything"});}},h=function(){c-=1,K.progress=1-c/s,0==c&&e()},x=function(e){K.reporter(d,{fileName:"kha/Assets.hx",lineNumber:137,className:"kha.Assets",methodName:"loadEverything"})(e),h()},S=0,y=a.length;S<y;)for(var w=S++,i=a[w],T=r[w],E=0,C=b.getInstanceFields(i),I;E<C.length;)if(I=C[E],++E,!!m.endsWith(I,"Description")){var v=p.field(T,I);null==t||t(v)?g(v,h,x):h()}},K.loadImage=function(e,t,n,i){var d=p.field(K.images,e+"Description");oe.loadImageFromDescription(d,function(n){K.images[e]=n,t(n)},K.reporter(n,i))},K.loadImageFromPath=function(e,t,n,i,d){oe.loadImageFromDescription({files:[e],readable:t},n,K.reporter(i,d))},K.get_imageFormats=function(){return oe.getImageFormats()},K.loadBlob=function(e,t,n,i){var d=p.field(K.blobs,e+"Description");oe.loadBlobFromDescription(d,function(n){K.blobs[e]=n,t(n)},K.reporter(n,i))},K.loadBlobFromPath=function(e,t,n,i){oe.loadBlobFromDescription({files:[e]},t,K.reporter(n,i))},K.loadSound=function(e,t,n,i){var d=p.field(K.sounds,e+"Description");oe.loadSoundFromDescription(d,function(n){K.sounds[e]=n,t(n)},K.reporter(n,i))},K.loadSoundFromPath=function(e,t,n,i){oe.loadSoundFromDescription({files:[e]},t,K.reporter(n,i))},K.get_soundFormats=function(){return oe.getSoundFormats()},K.loadFont=function(e,t,n,i){var d=p.field(K.fonts,e+"Description");oe.loadFontFromDescription(d,function(n){K.fonts[e]=n,t(n)},K.reporter(n,i))},K.loadFontFromPath=function(e,t,n,i){oe.loadFontFromDescription({files:[e]},t,K.reporter(n,i))},K.get_fontFormats=function(){return["ttf"]},K.loadVideo=function(e,t,n,i){var d=p.field(K.videos,e+"Description");oe.loadVideoFromDescription(d,function(n){K.videos[e]=n,t(n)},K.reporter(n,i))},K.loadVideoFromPath=function(e,t,n,i){oe.loadVideoFromDescription({files:[e]},t,K.reporter(n,i))},K.get_videoFormats=function(){return oe.getVideoFormats()},K.reporter=function(e,t){if(null!=e)return e;var n=w.trace;return function(e){n(e,t)}};var q=function(){};s["kha.Canvas"]=q,q.__name__=!0,q.__isInterface__=!0,q.prototype={get_width:null,get_height:null,get_g1:null,get_g2:null,get_g4:null,width:null,height:null,g1:null,g2:null,g4:null,__class__:q};var Q={};s["kha._Color.Color_Impl_"]=Q,Q.__name__=!0,Q.fromValue=function(e){return Q._new(e)},Q.fromBytes=function(e,t,n,i){return null==i&&(i=255),Q._new(i<<24|e<<16|t<<8|n)},Q.fromFloats=function(e,t,n,i){return null==i&&(i=1),Q._new((0|255*i)<<24|(0|255*e)<<16|(0|255*t)<<8|(0|255*n))},Q.fromString=function(e){if((7==e.length||9==e.length)&&35==e.charCodeAt(0)){var t=h.parseInt("0x"+f.substr(e,1,null));return 7==e.length&&(t+=-16777216),Q._new(t)}throw new W("Invalid Color string: '"+e+"'")},Q._new=function(e){return e},Q.get_value=function(e){return e},Q.set_value=function(e,t){return e=t,e},Q.get_Rb=function(e){return(16711680&e)>>>16},Q.get_Gb=function(e){return(65280&e)>>>8},Q.get_Bb=function(e){return 255&e},Q.get_Ab=function(e){return e>>>24},Q.set_Rb=function(e,t){return e=e>>>24<<24|t<<16|(65280&e)>>>8<<8|255&e,t},Q.set_Gb=function(e,t){return e=e>>>24<<24|(16711680&e)>>>16<<16|t<<8|255&e,t},Q.set_Bb=function(e,t){return e=e>>>24<<24|(16711680&e)>>>16<<16|(65280&e)>>>8<<8|t,t},Q.set_Ab=function(e,t){return e=t<<24|(16711680&e)>>>16<<16|(65280&e)>>>8<<8|255&e,t},Q.get_R=function(e){return .00392156862745098*((16711680&e)>>>16)},Q.get_G=function(e){return .00392156862745098*((65280&e)>>>8)},Q.get_B=function(e){return .00392156862745098*(255&e)},Q.get_A=function(e){return .00392156862745098*(e>>>24)},Q.set_R=function(e,t){return e=(0|255*(.00392156862745098*(e>>>24)))<<24|(0|255*t)<<16|(0|255*(.00392156862745098*((65280&e)>>>8)))<<8|(0|255*(.00392156862745098*(255&e))),t},Q.set_G=function(e,t){return e=(0|255*(.00392156862745098*(e>>>24)))<<24|(0|255*(.00392156862745098*((16711680&e)>>>16)))<<16|(0|255*t)<<8|(0|255*(.00392156862745098*(255&e))),t},Q.set_B=function(e,t){return e=(0|255*(.00392156862745098*(e>>>24)))<<24|(0|255*(.00392156862745098*((16711680&e)>>>16)))<<16|(0|255*(.00392156862745098*((65280&e)>>>8)))<<8|(0|255*t),t},Q.set_A=function(e,t){return e=(0|255*t)<<24|(0|255*(.00392156862745098*((16711680&e)>>>16)))<<16|(0|255*(.00392156862745098*((65280&e)>>>8)))<<8|(0|255*(.00392156862745098*(255&e))),t};var J=function(e,t){this.num=e,this.isPrimary=t};s["kha.Display"]=J,J.__name__=!0,J.init=function(){for(var e=0,t=Krom.displayCount();e<t;){var n=e++;J.displays.push(new J(n,Krom.displayIsPrimary(n)))}},J.get_primary=function(){J.init();for(var e=0,t=J.displays,n;e<t.length;)if(n=t[e],++e,n.isPrimary)return n;return null},J.get_all=function(){return J.init(),J.displays},J.prototype={num:null,isPrimary:null,get_available:function(){return!0},get_name:function(){return"Display"},get_x:function(){return Krom.displayX(this.num)},get_y:function(){return Krom.displayY(this.num)},get_width:function(){return Krom.displayWidth(this.num)},get_height:function(){return Krom.displayHeight(this.num)},get_frequency:function(){return 60},get_pixelsPerInch:function(){return Krom.screenDpi()},get_modes:function(){return[]},__class__:J};var $=function(e,t,n,i){this.width=e,this.height=t,this.frequency=n,this.bitsPerPixel=i};s["kha.DisplayMode"]=$,$.__name__=!0,$.prototype={width:null,height:null,frequency:null,bitsPerPixel:null,__class__:$};var ee=function(e,t,n){this.bold=e,this.italic=t,this.underlined=n};s["kha.FontStyle"]=ee,ee.__name__=!0,ee.prototype={bold:null,italic:null,underlined:null,getBold:function(){return this.bold},getItalic:function(){return this.italic},getUnderlined:function(){return this.underlined},__class__:ee};var te=function(e,t,n,i){this.window=e,this.graphics1=t,this.graphics2=n,this.graphics4=i};s["kha.Framebuffer"]=te,te.__name__=!0,te.__interfaces__=[q],te.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,init:function(e,t,n){this.graphics1=e,this.graphics2=t,this.graphics4=n},get_g1:function(){return this.graphics1},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},width:null,get_width:function(){return pe.windowWidth(this.window)},height:null,get_height:function(){return pe.windowHeight(this.window)},__class__:te};var ne=function(e,t,n,i,d,a){null==a&&(a=1),null==d&&(d=8),null==i&&(i=16),null==n&&(n=32),null==t&&(t=!0),null==e&&(e=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=e,this.verticalSync=t,this.colorBufferBits=n,this.depthBufferBits=i,this.stencilBufferBits=d,this.samplesPerPixel=a};s["kha.FramebufferOptions"]=ne,ne.__name__=!0,ne.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:ne};var ie=function(){};s["kha.Resource"]=ie,ie.__name__=!0,ie.__isInterface__=!0,ie.prototype={unload:null,__class__:ie};var de=function(e){this.pixels=null,this.texture_=e};s["kha.Image"]=de,de.__name__=!0,de.__interfaces__=[ie,q],de.getRenderTargetFormat=function(e){return 0===e?0:1===e?5:2===e?3:3===e?4:4===e?1:5===e?2:6===e?6:0},de.getDepthBufferBits=function(e){return 0===e?-1:1===e?24:2===e?24:3===e?24:4===e?32:5===e?16:void 0},de.getStencilBufferBits=function(e){return 0===e?-1:1===e?-1:2===e?8:3===e?8:4===e?8:5===e?0:void 0},de.getTextureFormat=function(e){return 0===e?0:2===e?3:4===e?4:5===e?5:6===e?7:1},de._fromTexture=function(e){return new de(e)},de.fromBytes=function(e,t,n,i){null==i&&(i=0);var d=new de(null);return d.format=i,d.texture_=Krom.createTextureFromBytes(e.b.bufferValue,t,n,de.getTextureFormat(i),!0),d},de.fromBytes3D=function(e,t,n,i,d){null==d&&(d=0);var a=new de(null);return a.format=d,a.texture_=Krom.createTextureFromBytes3D(e.b.bufferValue,t,n,i,de.getTextureFormat(d),!0),a},de.fromEncodedBytes=function(e,t,n,i,d){null==d&&(d=!1);var a=new de(null);a.texture_=Krom.createTextureFromEncodedBytes(e.b.bufferValue,t,d),n(a)},de.create=function(e,t,n){null==n&&(n=0);var i=new de(null);return i.format=n,i.texture_=Krom.createTexture(e,t,de.getTextureFormat(n)),i},de.create3D=function(e,t,n,i){null==i&&(i=0);var d=new de(null);return d.format=i,d.texture_=Krom.createTexture3D(e,t,n,de.getTextureFormat(i)),d},de.createRenderTarget=function(e,t,n,i,d,a){null==a&&(a=0),null==d&&(d=1),null==i&&(i=0),null==n&&(n=0);var r=new de(null);return r.format=n,r.renderTarget_=Krom.createRenderTarget(e,t,de.getDepthBufferBits(i),de.getRenderTargetFormat(n),de.getStencilBufferBits(i),a),r},de.get_maxSize=function(){return 4096},de.get_nonPow2Supported=function(){return!0},de.renderTargetsInvertedY=function(){return Krom.renderTargetsInvertedY()},de.formatByteSize=function(e){return 0===e?4:1===e?1:2===e?16:3===e?2:4===e?8:5===e?4:6===e?2:4},de.prototype={texture_:null,renderTarget_:null,format:null,readable:null,graphics1:null,graphics2:null,graphics4:null,isOpaque:function(){return!1},at:function(){return-16777216},unload:function(){Krom.unloadImage(this),this.texture_=null,this.renderTarget_=null},lock:function(e){return null==e&&(e=0),B.ofData(Krom.lockTexture(this.texture_,e))},unlock:function(){Krom.unlockTexture(this.texture_)},pixels:null,getPixels:function(){return null==this.renderTarget_?B.ofData(Krom.getTexturePixels(this.texture_)):(null==this.pixels&&(this.pixels=new B(new ArrayBuffer(de.formatByteSize(this.format)*this.get_width()*this.get_height()))),Krom.getRenderTargetPixels(this.renderTarget_,this.pixels.b.bufferValue),this.pixels)},generateMipmaps:function(e){null==this.texture_?Krom.generateRenderTargetMipmaps(this.renderTarget_,e):Krom.generateTextureMipmaps(this.texture_,e)},setMipmaps:function(e){Krom.setMipmaps(this.texture_,e)},setDepthStencilFrom:function(e){Krom.setDepthStencilFrom(this.renderTarget_,e.renderTarget_)},clear:function(e,t,n,i,d,a,r){Krom.clearTexture(this.texture_,e,t,n,i,d,a,r)},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},depth:null,get_depth:function(){return null==this.texture_?1:this.texture_.depth},realWidth:null,get_realWidth:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.realWidth},realHeight:null,get_realHeight:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.realHeight},g1:null,get_g1:function(){return null==this.graphics1&&(this.graphics1=new ot(this)),this.graphics1},g2:null,get_g2:function(){return null==this.graphics2&&(this.graphics2=new Vt(this)),this.graphics2},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new dn(this)),this.graphics4},__class__:de};var ae=function(){};s["kha.AlignedQuad"]=ae,ae.__name__=!0,ae.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:ae};var re=function(e,t,n,i,d,a,r,s){this.mySize=e,this.width=d,this.height=a,this.chars=r,this.baseline=t;for(var o=0;o<r.length;){var u=r[o];++o,u.yoff+=this.baseline}this.texture=de.fromBytes(s.toBytes(),d,a,1)};s["kha.KravurImage"]=re,re.__name__=!0,re.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(e,t,n,i){if(t>=this.chars.length)return null;var d=1/this.width,a=1/this.height,r=this.chars[t];if(null==r)return null;var s=Math.round(n+r.xoff),o=Math.round(i+r.yoff);return e.x0=s,e.y0=o,e.x1=s+r.x1-r.x0,e.y1=o+r.y1-r.y0,e.s0=r.x0*d,e.t0=r.y0*a,e.s1=r.x1*d,e.t1=r.y1*a,e.xadvance=r.xadvance,e},getCharWidth:function(e){if(0==this.chars.length)return 0;var t=re.charBlocks[0];if(e<t)return this.chars[0].xadvance;for(var n=1,d=0|re.charBlocks.length/2;n<d;){var a=n++,i=re.charBlocks[2*a-1],r=re.charBlocks[2*a];e>r-1&&(t+=r-1-i)}return e-t>=this.chars.length?this.chars[0].xadvance:this.chars[e-t].xadvance},getHeight:function(){return this.mySize},stringWidth:function(e){for(var t=0,n=0,i=e.length;n<i;){var d=n++;t+=this.getCharWidth(f.cca(e,d))}return t},charactersWidth:function(e,t,n){for(var d=0,a=t;a<t+n;){var r=a++;d+=this.getCharWidth(e[r])}return d},getBaselinePosition:function(){return this.baseline},__class__:re};var se=function(e){this.images=new C,this.blob=e};s["kha.Kravur"]=se,se.__name__=!0,se.__interfaces__=[ie],se.fromBytes=function(e){return new se(nn.fromBytes(e))},se.prototype={oldGlyphs:null,blob:null,images:null,_get:function(e){var t=st.fontGlyphs;if(t!=this.oldGlyphs){this.oldGlyphs=t,re.charBlocks=[t[0]];for(var n=re.charBlocks[0]+1,d=1,a=t.length;d<a;){var r=d++;t[r]==n?++n:(re.charBlocks.push(t[r-1]),re.charBlocks.push(t[r]),n=t[r]+1)}re.charBlocks.push(t[t.length-1])}var i=1e4*e+t.length;if(!this.images.h.hasOwnProperty(i)){for(var s=64,o=32,u=Array(t.length),l=u,_=0,f=l.length,c;_<f;)c=_++,l[c]=new pt;for(var g=null,p=-1;0>=p;)o<s?o*=2:s*=2,g=nn.alloc(s*o),p=It.stbtt_BakeFontBitmap(this.blob,0,e,g,s,o,t,l);var h=new St;It.stbtt_InitFont(h,this.blob,0);var m=It.stbtt_GetFontVMetrics(h),b=It.stbtt_ScaleForPixelHeight(h,e),x=Math.round(m.ascent*b),S=Math.round(m.descent*b),y=Math.round(m.lineGap*b),w=new re(0|e,x,S,y,s,o,l,g);return this.images.h[i]=w,w}return this.images.h[i]},height:function(e){return this._get(e).getHeight()},width:function(e,t){return this._get(e).stringWidth(t)},widthOfCharacters:function(e,t,n,i){return this._get(e).charactersWidth(t,n,i)},baseline:function(e){return this._get(e).getBaselinePosition()},unload:function(){this.blob=null,this.images=null},__class__:se};var oe=function(){};s["kha.LoaderImpl"]=oe,oe.__name__=!0,oe.getImageFormats=function(){return["png","jpg"]},oe.loadImageFromDescription=function(e,t){var n=Object.prototype.hasOwnProperty.call(e,"readable")&&e.readable;t(de._fromTexture(Krom.loadImage(e.files[0],n)))},oe.getSoundFormats=function(){return["wav","ogg"]},oe.loadSoundFromDescription=function(e,t){t(new an(B.ofData(Krom.loadSound(e.files[0]))))},oe.getVideoFormats=function(){return["webm"]},oe.loadVideoFromDescription=function(){},oe.loadBlobFromDescription=function(e,t){t(new nn(B.ofData(Krom.loadBlob(e.files[0]))))},oe.loadFontFromDescription=function(e,t,n){oe.loadBlobFromDescription(e,function(e){t(new se(e))},n)};var ue=function(){};s["kha.TimeTask"]=ue,ue.__name__=!0,ue.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:ue};var le=function(e,t,n){this.task=e,this.priority=t,this.id=n,this.active=!0,this.paused=!1};s["kha.FrameTask"]=le,le.__name__=!0,le.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:le};var _e=function(){};s["kha.Scheduler"]=_e,_e.__name__=!0,_e.init=function(){_e.deltas=[];for(var e=0,t=_e.DIF_COUNT;e<t;){var n=e++;_e.deltas[n]=0}_e.stopped=!0,_e.frame_tasks_sorted=!0,_e.current=_e.lastTime=_e.realTime(),_e.currentFrameTaskId=0,_e.currentTimeTaskId=0,_e.currentGroupId=0,_e.timeTasks=[],_e.pausedTimeTasks=[],_e.outdatedTimeTasks=[],_e.timeTasksScratchpad=[],_e.frameTasks=[],_e.toDeleteFrame=[]},_e.start=function(e){null==e&&(e=!1),_e.vsync=be.get(0).get_vSynced();var t=J.get_primary().get_frequency();57<=t&&63>=t&&(t=60),_e.onedifhz=1/t,_e.stopped=!1,_e.resetTime(),_e.lastTime=_e.realTime()-_e.startTime;for(var n=0,d=_e.DIF_COUNT;n<d;){var a=n++;_e.deltas[a]=0}if(e){for(var i=0,r=_e.timeTasks;i<r.length;){var s=r[i];++i,s.paused=!1}for(var o=0,u=_e.frameTasks;o<u.length;){var l=u[o];++o,l.paused=!1}}},_e.stop=function(){_e.stopped=!0},_e.isStopped=function(){return _e.stopped},_e.warpTimeTasksBack=function(e,t){for(var n=0,i;n<t.length;)if(i=t[n],++n,i.start>=e)i.next=i.start;else if(0<i.period){var d=e-i.start,a=Math.ceil(d/i.period);i.next=i.start+a*i.period}},_e.warp=function(e){if(e<_e.lastTime){_e.current=e,_e.lastTime=e,_e.warpTimeTasksBack(e,_e.outdatedTimeTasks),_e.warpTimeTasksBack(e,_e.timeTasks);for(var t=0,n=_e.outdatedTimeTasks;t<n.length;){var i=n[t];++t,i.next>=e&&_e.timeTasksScratchpad.push(i)}for(var d=0,a=_e.timeTasksScratchpad;d<a.length;){var r=a[d];++d,f.remove(_e.outdatedTimeTasks,r)}for(var s=0,o=_e.timeTasksScratchpad;s<o.length;){var u=o[s];++s,_e.insertSorted(_e.timeTasks,u)}for(;0<_e.timeTasksScratchpad.length;)f.remove(_e.timeTasksScratchpad,_e.timeTasksScratchpad[0])}else e>_e.lastTime&&(_e.startTime-=e-_e.lastTime,_e.current=e,_e.lastTime=e,_e.executeTimeTasks(e))},_e.executeFrame=function(){var e=_e.realTime()-_e.startTime,t=e-_e.lastTime,n=_e.current;if(0<=t){if(!(null==yn.the()))n+=t;else if(t>_e.maxframetime)_e.startTime+=t-_e.maxframetime,t=_e.maxframetime,n+=t;else if(_e.vsync){for(var d=_e.onedifhz;d<t-_e.onedifhz;)d+=_e.onedifhz;t=d;for(var a=0,r=_e.DIF_COUNT-2,s;a<r;)s=a++,t+=_e.deltas[s],_e.deltas[s]=_e.deltas[s+1];t+=_e.deltas[_e.DIF_COUNT-2],t/=_e.DIF_COUNT,_e.deltas[_e.DIF_COUNT-2]=d,n+=t}else{for(var o=0,u=_e.DIF_COUNT-1,l;o<u;)l=o++,_e.deltas[l]=_e.deltas[l+1];_e.deltas[_e.DIF_COUNT-1]=t;for(var _=0,c=0,g=_e.DIF_COUNT,p;c<g;)p=c++,_+=_e.deltas[p];_/=_e.DIF_COUNT,n+=_}_e.lastTime=n,_e.stopped||(_e.current=n);for(var h=0,m=_e.pausedTimeTasks;h<m.length;){var b=m[h];++h,b.next+=t}if(_e.stopped)for(var x=0,S=_e.timeTasks,y;x<S.length;)y=S[x],++x,y.next+=t;_e.executeTimeTasks(n);for(var w=0,T=_e.outdatedTimeTasks;w<T.length;){var E=T[w];++w,E.next<n-10&&_e.timeTasksScratchpad.push(E)}for(var C=0,I=_e.timeTasksScratchpad;C<I.length;){var v=I[C];++C,f.remove(_e.outdatedTimeTasks,v)}for(;0<_e.timeTasksScratchpad.length;)f.remove(_e.timeTasksScratchpad,_e.timeTasksScratchpad[0])}_e.sortFrameTasks();for(var k=0,L=_e.frameTasks;k<L.length;){var B=L[k];++k,_e.stopped||B.paused||!B.active||B.task()||(B.active=!1)}for(var O=0,N=_e.frameTasks;O<N.length;){var A=N[O];++O,A.active||_e.toDeleteFrame.push(A)}for(;0<_e.toDeleteFrame.length;)f.remove(_e.frameTasks,_e.toDeleteFrame.pop())},_e.executeTimeTasks=function(e){for(;0<_e.timeTasks.length&&(_e.activeTimeTask=_e.timeTasks[0],_e.activeTimeTask.next<=e);)_e.activeTimeTask.next+=_e.activeTimeTask.period,f.remove(_e.timeTasks,_e.activeTimeTask),_e.activeTimeTask.active&&_e.activeTimeTask.task()?0<_e.activeTimeTask.period&&(0==_e.activeTimeTask.duration||_e.activeTimeTask.duration>=_e.activeTimeTask.start+_e.activeTimeTask.next)?_e.insertSorted(_e.timeTasks,_e.activeTimeTask):_e.archiveTimeTask(_e.activeTimeTask,e):(_e.activeTimeTask.active=!1,_e.archiveTimeTask(_e.activeTimeTask,e));_e.activeTimeTask=null},_e.archiveTimeTask=function(){},_e.time=function(){return _e.current},_e.realTime=function(){return pe.get_time()},_e.resetTime=function(){var e=pe.get_time(),t=e-_e.startTime;_e.startTime=e;for(var n=0,d=_e.timeTasks;n<d.length;){var a=d[n];++n,a.start-=t,a.next-=t}for(var r=0,s=_e.DIF_COUNT;r<s;){var o=r++;_e.deltas[o]=0}_e.current=0,_e.lastTime=0},_e.addBreakableFrameTask=function(e,t){return _e.frameTasks.push(new le(e,t,++_e.currentFrameTaskId)),_e.frame_tasks_sorted=!1,_e.currentFrameTaskId},_e.addFrameTask=function(e,t){return _e.addBreakableFrameTask(function(){return e(),!0},t)},_e.pauseFrameTask=function(e,t){for(var n=0,i=_e.frameTasks,d;n<i.length;)if(d=i[n],++n,d.id==e){d.paused=t;break}},_e.removeFrameTask=function(e){for(var t=0,n=_e.frameTasks,i;t<n.length;)if(i=n[t],++t,i.id==e){i.active=!1;break}},_e.generateGroupId=function(){return++_e.currentGroupId},_e.addBreakableTimeTaskToGroup=function(e,n,i,d,a){null==a&&(a=0),null==d&&(d=0);var r=new ue;return r.active=!0,r.task=n,r.id=++_e.currentTimeTaskId,r.groupId=e,r.start=_e.current+i,r.period=0,0!=d&&(r.period=d),r.duration=0,0!=a&&(r.duration=r.start+a),r.next=r.start,_e.insertSorted(_e.timeTasks,r),r.id},_e.addTimeTaskToGroup=function(e,t,n,i,d){return null==d&&(d=0),null==i&&(i=0),_e.addBreakableTimeTaskToGroup(e,function(){return t(),!0},n,i,d)},_e.addBreakableTimeTask=function(e,t,n,i){return null==i&&(i=0),null==n&&(n=0),_e.addBreakableTimeTaskToGroup(0,e,t,n,i)},_e.addTimeTask=function(e,t,n,i){return null==i&&(i=0),null==n&&(n=0),_e.addTimeTaskToGroup(0,e,t,n,i)},_e.getTimeTask=function(e){if(null!=_e.activeTimeTask&&_e.activeTimeTask.id==e)return _e.activeTimeTask;for(var t=0,n=_e.timeTasks,i;t<n.length;)if(i=n[t],++t,i.id==e)return i;for(var d=0,a=_e.pausedTimeTasks,r;d<a.length;)if(r=a[d],++d,r.id==e)return r;return null},_e.pauseTimeTask=function(e,t){var n=_e.getTimeTask(e);null!=n&&_e.pauseRunningTimeTask(n,t),null!=_e.activeTimeTask&&_e.activeTimeTask.id==e&&(_e.activeTimeTask.paused=t)},_e.pauseRunningTimeTask=function(e,t){e.paused=t,t?(f.remove(_e.timeTasks,e),_e.pausedTimeTasks.push(e)):(_e.insertSorted(_e.timeTasks,e),f.remove(_e.pausedTimeTasks,e))},_e.pauseTimeTasks=function(e,t){for(var n=0,i=_e.timeTasks;n<i.length;){var d=i[n];++n,d.groupId==e&&_e.pauseRunningTimeTask(d,t)}null!=_e.activeTimeTask&&_e.activeTimeTask.groupId==e&&(_e.activeTimeTask.paused=t)},_e.removeTimeTask=function(e){var t=_e.getTimeTask(e);null!=t&&(t.active=!1,f.remove(_e.timeTasks,t))},_e.removeTimeTasks=function(e){for(var t=0,n=_e.timeTasks;t<n.length;){var i=n[t];++t,i.groupId==e&&(i.active=!1,_e.timeTasksScratchpad.push(i))}for(var d=0,a=_e.timeTasksScratchpad;d<a.length;){var r=a[d];++d,f.remove(_e.timeTasks,r)}for(;0<_e.timeTasksScratchpad.length;)f.remove(_e.timeTasksScratchpad,_e.timeTasksScratchpad[0]);null!=_e.activeTimeTask&&_e.activeTimeTask.groupId==e&&(_e.activeTimeTask.active=!1)},_e.numTasksInSchedule=function(){return _e.timeTasks.length+_e.frameTasks.length},_e.insertSorted=function(e,t){for(var n=0,d=e.length;n<d;){var a=n++;if(e[a].next>t.next)return void e.splice(a,0,t)}e.push(t)},_e.sortFrameTasks=function(){_e.frame_tasks_sorted||(_e.frameTasks.sort(function(e,t){return e.priority>t.priority?1:e.priority<t.priority?-1:0}),_e.frame_tasks_sorted=!0)};var fe=function(){};s["kha.Shaders"]=fe,fe.__name__=!0,fe.init=function(){var e=[],t=p.field(fe,"painter_colored_fragData0"),n=E.run(t);e.push(nn.fromBytes(n)),fe.painter_colored_frag=new Lt(e,["painter-colored.frag.glsl"]);var i=[],d=p.field(fe,"painter_colored_vertData0"),a=E.run(d);i.push(nn.fromBytes(a)),fe.painter_colored_vert=new Yt(i,["painter-colored.vert.glsl"]);var r=[],s=p.field(fe,"painter_image_fragData0"),o=E.run(s);r.push(nn.fromBytes(o)),fe.painter_image_frag=new Lt(r,["painter-image.frag.glsl"]);var u=[],l=p.field(fe,"painter_image_vertData0"),_=E.run(l);u.push(nn.fromBytes(_)),fe.painter_image_vert=new Yt(u,["painter-image.vert.glsl"]);var f=[],c=p.field(fe,"painter_text_fragData0"),g=E.run(c);f.push(nn.fromBytes(g)),fe.painter_text_frag=new Lt(f,["painter-text.frag.glsl"]);var h=[],m=p.field(fe,"painter_text_vertData0"),b=E.run(m);h.push(nn.fromBytes(b)),fe.painter_text_vert=new Yt(h,["painter-text.vert.glsl"]);var x=[],S=p.field(fe,"painter_video_fragData0"),y=E.run(S);x.push(nn.fromBytes(y)),fe.painter_video_frag=new Lt(x,["painter-video.frag.glsl"]);var w=[],T=p.field(fe,"painter_video_vertData0"),C=E.run(T);w.push(nn.fromBytes(C)),fe.painter_video_vert=new Yt(w,["painter-video.vert.glsl"])};var ce=function(){this.sampleRate=0,this.channels=0,this.length=0};s["kha.Sound"]=ce,ce.__name__=!0,ce.__interfaces__=[ie],ce.prototype={compressedData:null,uncompressedData:null,length:null,channels:null,sampleRate:null,uncompress:function(e){if(null!=this.uncompressedData)return void e();var t=new R,n=Ve.readAll(this.compressedData,t,!0),d=t.getBytes(),a=0|d.length/4;if(1==n.channel){this.length=a/ve.samplesPerSecond;var r=new Float32Array(2*a);this.uncompressedData=r;for(var s=0;s<a;){var o=s++;this.uncompressedData[2*o]=d.getFloat(4*o),this.uncompressedData[2*o+1]=d.getFloat(4*o)}}else{this.length=a/2/ve.samplesPerSecond;var i=new Float32Array(a);this.uncompressedData=i;for(var u=0;u<a;){var l=u++;this.uncompressedData[l]=d.getFloat(4*l)}}this.channels=n.channel,this.sampleRate=n.sampleRate,this.compressedData=null,e()},unload:function(){this.compressedData=null,this.uncompressedData=null},__class__:ce};var ge=function(e,t,n,i,d){null==n&&(n=-1),null==t&&(t=-1),null==e&&(e="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=e,this.window=null==i?new Se(null,null,null,null,null,null,null,null,null):i,0<t?(this.window.width=t,this.width=t):this.width=this.window.width,0<n?(this.window.height=n,this.height=n):this.height=this.window.height,null==this.window.title&&(this.window.title=e),this.framebuffer=null==d?new ne(null,null,null,null,null,null):d};s["kha.SystemOptions"]=ge,ge.__name__=!0,ge.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:ge};var pe=function(){};s["kha.System"]=pe,pe.__name__=!0,pe.init=function(e,t){var n=0;e.resizable&&(n|=1),e.maximizable&&(n|=4),e.minimizable&&(n|=2);var i=new ge(e.title,e.width,e.height,new Se(null,null,null,null,null,null,null,n,e.windowMode),new ne(null,e.vSync,null,null,null,e.samplesPerPixel));pe.start(i,function(){t()})},pe.start=function(e,t){pe.theTitle=e.title,he.init(e,t)},pe.get_title=function(){return pe.theTitle},pe.notifyOnRender=function(e,t){null==t&&(t=0),pe.renderListeners.push(function(n){t<n.length&&e(n[t])})},pe.notifyOnFrames=function(e){pe.renderListeners.push(e)},pe.removeFramesListener=function(e){f.remove(pe.renderListeners,e)},pe.notifyOnApplicationState=function(e,t,n,i,d){null!=e&&pe.foregroundListeners.push(e),null!=t&&pe.resumeListeners.push(t),null!=n&&pe.pauseListeners.push(n),null!=i&&pe.backgroundListeners.push(i),null!=d&&pe.shutdownListeners.push(d)},pe.notifyOnDropFiles=function(e){pe.dropFilesListeners.push(e)},pe.removeDropListerer=function(e){f.remove(pe.dropFilesListeners,e)},pe.notifyOnCutCopyPaste=function(e,t,n){pe.cutListener=e,pe.copyListener=t,pe.pasteListener=n},pe.notifyOnLoginLogout=function(e,t){pe.loginListener=e,pe.logoutListener=t},pe.login=function(){he.login()},pe.render=function(e){for(var t=0,n=pe.renderListeners;t<n.length;){var i=n[t];++t,i(e)}},pe.foreground=function(){for(var e=0,t=pe.foregroundListeners;e<t.length;){var n=t[e];++e,n()}},pe.resume=function(){for(var e=0,t=pe.resumeListeners;e<t.length;){var n=t[e];++e,n()}},pe.pause=function(){for(var e=0,t=pe.pauseListeners;e<t.length;){var n=t[e];++e,n()}},pe.background=function(){for(var e=0,t=pe.backgroundListeners;e<t.length;){var n=t[e];++e,n()}},pe.shutdown=function(){for(var e=0,t=pe.shutdownListeners;e<t.length;){var n=t[e];++e,n()}},pe.dropFiles=function(e){for(var t=0,n=pe.dropFilesListeners;t<n.length;){var i=n[t];++t,i(e)}},pe.get_time=function(){return he.getTime()},pe.windowWidth=function(e){return null==e&&(e=0),be.get(e).get_width()},pe.windowHeight=function(e){return null==e&&(e=0),be.get_all()[e].get_height()},pe.get_screenRotation=function(){return 0},pe.get_systemId=function(){return he.getSystemId()},pe.vibrate=function(e){he.vibrate(e)},pe.get_language=function(){return he.getLanguage()},pe.stop=function(){return he.requestShutdown()},pe.loadUrl=function(e){he.loadUrl(e)},pe.canSwitchFullscreen=function(){return!0},pe.isFullscreen=function(){return!(1!=be.get(0).get_mode())||2==be.get(0).get_mode()},pe.requestFullscreen=function(){be.get(0).set_mode(1)},pe.exitFullscreen=function(){be.get(0).set_mode(0)},pe.notifyOnFullscreenChange=function(){},pe.removeFullscreenListener=function(){},pe.changeResolution=function(){},pe.requestShutdown=function(){pe.stop()},pe.get_vsync=function(){return be.get(0).get_vSynced()},pe.get_refreshRate=function(){return J.get_primary().get_frequency()},pe.screenDpi=function(){return J.get_primary().get_pixelsPerInch()},pe.safeZone=function(){return he.safeZone()},pe.automaticSafeZone=function(){return he.automaticSafeZone()},pe.setSafeZone=function(e){he.setSafeZone(e)},pe.unlockAchievement=function(e){he.unlockAchievement(e)};var he=function(){};s["kha.SystemImpl"]=he,he.__name__=!0,he.renderCallback=function(){_e.executeFrame(),pe.render([he.framebuffer])},he.dropFilesCallback=function(e){pe.dropFiles(e)},he.copyCallback=function(){return null==pe.copyListener?null:pe.copyListener()},he.cutCallback=function(){return null==pe.cutListener?null:pe.cutListener()},he.pasteCallback=function(e){null!=pe.pasteListener&&pe.pasteListener(e)},he.foregroundCallback=function(){pe.foreground()},he.resumeCallback=function(){pe.resume()},he.pauseCallback=function(){pe.pause()},he.backgroundCallback=function(){pe.background()},he.shutdownCallback=function(){pe.shutdown()},he.keyboardDownCallback=function(e){he.keyboard.sendDownEvent(e)},he.keyboardUpCallback=function(e){he.keyboard.sendUpEvent(e)},he.keyboardPressCallback=function(e){he.keyboard.sendPressEvent(String.fromCodePoint(e))},he.mouseDownCallback=function(e,t,n){he.mouse.sendDownEvent(0,e,t,n)},he.mouseUpCallback=function(e,t,n){he.mouse.sendUpEvent(0,e,t,n)},he.mouseMoveCallback=function(e,t,n,i){he.mouse.sendMoveEvent(0,e,t,n,i)},he.mouseWheelCallback=function(e){he.mouse.sendWheelEvent(0,e)},he.penDownCallback=function(e,t,n){he.pen.sendDownEvent(0,e,t,n)},he.penUpCallback=function(e,t,n){he.pen.sendUpEvent(0,e,t,n)},he.penMoveCallback=function(e,t,n){he.pen.sendMoveEvent(0,e,t,n)},he.gamepadAxisCallback=function(e,t,n){he.gamepads[e].sendAxisEvent(t,n)},he.gamepadButtonCallback=function(e,t,n){he.gamepads[e].sendButtonEvent(t,n)},he.audioCallback=function(e){ve._callCallback(e);var t=ve.buffer;Krom.writeAudioBuffer(t.data.buffer,e)},he.init=function(e,t){Krom.init(e.title,e.width,e.height,e.framebuffer.samplesPerPixel,e.framebuffer.verticalSync,e.window.mode,e.window.windowFeatures,3),he.start=Krom.getTime(),w.trace=function(e,t){var n=null==t?h.string(e):t.className+":"+t.lineNumber+": "+h.string(e);Krom.log(f.substr(n,0,511))},new be(0),_e.init(),fe.init();var n=new dn;he.framebuffer=new te(0,null,null,n),he.framebuffer.init(new ot(he.framebuffer),new Vt(he.framebuffer),n),Krom.setCallback(he.renderCallback),Krom.setDropFilesCallback(he.dropFilesCallback),Krom.setCutCopyPasteCallback(he.cutCallback,he.copyCallback,he.pasteCallback),Krom.setApplicationStateCallback(he.foregroundCallback,he.resumeCallback,he.pauseCallback,he.backgroundCallback,he.shutdownCallback),he.keyboard=new Qt,he.mouse=new $t,he.pen=new en,he.gamepads=[];for(var d=0,a=he.maxGamepads;d<a;){var r=d++;he.gamepads[r]=new Zt(r)}Krom.setKeyboardDownCallback(he.keyboardDownCallback),Krom.setKeyboardUpCallback(he.keyboardUpCallback),Krom.setKeyboardPressCallback(he.keyboardPressCallback),Krom.setMouseDownCallback(he.mouseDownCallback),Krom.setMouseUpCallback(he.mouseUpCallback),Krom.setMouseMoveCallback(he.mouseMoveCallback),Krom.setMouseWheelCallback(he.mouseWheelCallback),Krom.setPenDownCallback(he.penDownCallback),Krom.setPenUpCallback(he.penUpCallback),Krom.setPenMoveCallback(he.penMoveCallback),Krom.setGamepadAxisCallback(he.gamepadAxisCallback),Krom.setGamepadButtonCallback(he.gamepadButtonCallback),ve._init(),ke._init(),Krom.setAudioCallback(he.audioCallback),_e.start(),t(be.get(0))},he.initEx=function(){},he.translateWindowMode=function(e){if(null==e)return 0;return 0===e?0:1===e?1:2===e?2:void 0},he.getScreenRotation=function(){return 0},he.getTime=function(){return Krom.getTime()-he.start},he.getVsync=function(){return!0},he.getRefreshRate=function(){return 60},he.getSystemId=function(){return Krom.systemId()},he.vibrate=function(){},he.getLanguage=function(){return"en"},he.requestShutdown=function(){return Krom.requestShutdown(),!0},he.getMouse=function(){return he.mouse},he.getPen=function(){return he.pen},he.getKeyboard=function(){return he.keyboard},he.lockMouse=function(){if(!he.isMouseLocked()){Krom.lockMouse();for(var e=0,t=he.mouseLockListeners;e<t.length;){var n=t[e];++e,n()}}},he.unlockMouse=function(){if(he.isMouseLocked()){Krom.unlockMouse();for(var e=0,t=he.mouseLockListeners;e<t.length;){var n=t[e];++e,n()}}},he.canLockMouse=function(){return Krom.canLockMouse()},he.isMouseLocked=function(){return Krom.isMouseLocked()},he.notifyOfMouseLockChange=function(e){he.canLockMouse()&&null!=e&&he.mouseLockListeners.push(e)},he.removeFromMouseLockChange=function(e){he.canLockMouse()&&null!=e&&f.remove(he.mouseLockListeners,e)},he.hideSystemCursor=function(){Krom.showMouse(!1)},he.showSystemCursor=function(){Krom.showMouse(!0)},he.unload=function(){},he.canSwitchFullscreen=function(){return!1},he.isFullscreen=function(){return!1},he.requestFullscreen=function(){},he.exitFullscreen=function(){},he.notifyOfFullscreenChange=function(){},he.removeFromFullscreenChange=function(){},he.changeResolution=function(){},he.setKeepScreenOn=function(){},he.loadUrl=function(){},he.getGamepadId=function(){return"unkown"},he.safeZone=function(){return 1},he.login=function(){},he.automaticSafeZone=function(){return!0},he.setSafeZone=function(){},he.unlockAchievement=function(){};var me=function(){};s["kha.Video"]=me,me.__name__=!0,me.__interfaces__=[ie],me.prototype={width:function(){return 100},height:function(){return 100},play:function(e){null==e&&(e=!1)},pause:function(){},stop:function(){},getLength:function(){return 0},getCurrentPos:function(){return 0},get_position:function(){return 0},set_position:function(){return 0},getVolume:function(){return 1},setVolume:function(){},isFinished:function(){return this.getCurrentPos()>=this.getLength()},unload:function(){},__class__:me};var be=function(e){this.num=e,be.windows.push(this)};s["kha.Window"]=be,be.__name__=!0,be.create=function(){return null},be.destroy=function(){},be.get=function(e){return be.windows[e]},be.get_all=function(){return be.windows},be.prototype={num:null,windowTitle:null,resize:function(){},move:function(){},changeWindowFeatures:function(){},changeFramebuffer:function(){},get_x:function(){return 0},set_x:function(){return 0},get_y:function(){return 0},set_y:function(){return 0},get_width:function(){return Krom.windowWidth(this.num)},set_width:function(){return 800},get_height:function(){return Krom.windowHeight(this.num)},set_height:function(){return 600},get_mode:function(){return 0},set_mode:function(){return 0},get_visible:function(){return!0},set_visible:function(){return!0},get_title:function(){return this.windowTitle},set_title:function(e){return Krom.setWindowTitle(this.num,e),this.windowTitle=e,this.windowTitle},notifyOnResize:function(){},get_vSynced:function(){return!0},__class__:be};var xe={};s["kha._WindowOptions.WindowFeatures_Impl_"]=xe,xe.__name__=!0,xe._new=function(e){return e};var Se=function(e,t,n,i,d,a,r,s,o){null==o&&(o=0),null==r&&(r=!0),null==a&&(a=-1),null==d&&(d=600),null==i&&(i=800),null==n&&(n=-1),null==t&&(t=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=-1,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=e,this.x=t,this.y=n,this.width=i,this.height=d,this.display=a,this.visible=r,this.windowFeatures=null==s?7:s,this.mode=o};s["kha.WindowOptions"]=Se,Se.__name__=!0,Se.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:Se};var ye={};s["kha.arrays._Float32Array.Float32Array_Impl_"]=ye,ye.__name__=!0,ye._new=function(e){var t=new Float32Array(e);return t},ye.get_buffer=function(e){return e.buffer},ye.get_length=function(e){return e.length},ye.set=function(e,t,n){return e[t]=n},ye.get=function(e,t){return e[t]},ye.data=function(e){return e},ye.subarray=function(e,t,n){return e.subarray(t,n)};var we={};s["kha.arrays._Int16Array.Int16Array_Impl_"]=we,we.__name__=!0,we._new=function(e){var t=new Int16Array(e);return t},we.get_length=function(e){return e.length},we.set=function(e,t,n){return e[t]=n},we.get=function(e,t){return e[t]},we.data=function(e){return e},we.arrayRead=function(e,t){return e[t]},we.arrayWrite=function(e,t,n){return e[t]=n},we.subarray=function(e,t,n){return e.subarray(t,n)};var Te={};s["kha.arrays._Int32Array.Int32Array_Impl_"]=Te,Te.__name__=!0,Te._new=function(e){var t=new Int32Array(e);return t},Te.get_length=function(e){return e.length},Te.set=function(e,t,n){return e[t]=n},Te.get=function(e,t){return e[t]},Te.data=function(e){return e},Te.arrayRead=function(e,t){return e[t]},Te.arrayWrite=function(e,t,n){return e[t]=n},Te.subarray=function(e,t,n){return e.subarray(t,n)};var Ee={};s["kha.arrays._Uint32Array.Uint32Array_Impl_"]=Ee,Ee.__name__=!0,Ee._new=function(e){var t=new Uint32Array(e);return t},Ee.get_length=function(e){return e.length},Ee.set=function(e,t,n){return e[t]=n},Ee.get=function(e,t){return e[t]},Ee.data=function(e){return e},Ee.arrayRead=function(e,t){return e[t]},Ee.arrayWrite=function(e,t,n){return e[t]=n},Ee.subarray=function(e,t,n){return e.subarray(t,n)};var Ce=function(){};s["kha.audio1.AudioChannel"]=Ce,Ce.__name__=!0,Ce.__isInterface__=!0,Ce.prototype={play:null,pause:null,stop:null,length:null,get_length:null,get_position:null,set_position:null,get_volume:null,set_volume:null,finished:null,get_finished:null,__class__:Ce};var Ie=function(e){this.value=e};s["kha.internal.IntBox"]=Ie,Ie.__name__=!0,Ie.prototype={value:null,__class__:Ie};var ve=function(){};s["kha.audio2.Audio"]=ve,ve.__name__=!0,ve._init=function(){ve.buffer=new Be(8192,2,44100),ve.samplesPerSecond=44100},ve._callCallback=function(e){if(null!=ve.buffer)if(null!=ve.audioCallback)ve.intBox.value=e,ve.audioCallback(ve.intBox,ve.buffer);else for(var t=0,n;t<e;)n=t++,ve.buffer.data[ve.buffer.writeLocation]=0,ve.buffer.writeLocation+=1,ve.buffer.writeLocation>=ve.buffer.size&&(ve.buffer.writeLocation=0)},ve._readSample=function(){if(null==ve.buffer)return 0;var e=ve.buffer.data[ve.buffer.readLocation];return ve.buffer.readLocation+=1,ve.buffer.readLocation>=ve.buffer.size&&(ve.buffer.readLocation=0),e},ve.play=function(e,t){return null==t&&(t=!1),null},ve.stream=function(e,t){return null==t&&(t=!1),null};var ke=function(){};s["kha.audio2.Audio1"]=ke,ke.__name__=!0,ke._init=function(){var e=Array(32);ke.soundChannels=e;var t=Array(32);ke.streamChannels=t;var n=Array(32);ke.internalSoundChannels=n;var i=Array(32);ke.internalStreamChannels=i;var d=new Float32Array(512);ke.sampleCache1=d;var a=new Float32Array(512);ke.sampleCache2=a,ke.lastAllocationCount=0,ve.audioCallback=ke.mix},ke.max=function(e,t){return e>t?e:t},ke.min=function(e,t){return e<t?e:t},ke.mix=function(e,t){var n=e.value;if(ke.sampleCache1.length<n){if(ve.disableGcInteractions){w.trace("Unexpected allocation request in audio thread.",{fileName:"kha/audio2/Audio1.hx",lineNumber:45,className:"kha.audio2.Audio1",methodName:"mix"});for(var d=0,r;d<n;)r=d++,t.data[t.writeLocation]=0,t.writeLocation+=1,t.writeLocation>=t.size&&(t.writeLocation=0);return ke.lastAllocationCount=0,void(ve.disableGcInteractions=!1)}var s=new Float32Array(2*n);ke.sampleCache1=s;var o=new Float32Array(2*n);ke.sampleCache2=o,ke.lastAllocationCount=0}else 100<ke.lastAllocationCount?ve.disableGcInteractions=!0:ke.lastAllocationCount+=1;for(var u=0;u<n;){var l=u++;ke.sampleCache2[l]=0}for(var _=0;32>_;){var f=_++;ke.internalSoundChannels[f]=ke.soundChannels[f]}for(var c=0;32>c;){var g=c++;ke.internalStreamChannels[g]=ke.streamChannels[g]}for(var p=0,h=ke.internalSoundChannels,m;p<h.length;)if(m=h[p],++p,!(null==m||m.get_finished())){m.nextSamples(ke.sampleCache1,n,t.samplesPerSecond);for(var b=0,x;b<n;)x=b++,ke.sampleCache2[x]+=ke.sampleCache1[x]*m.get_volume()}for(var S=0,y=ke.internalStreamChannels,T;S<y.length;)if(T=y[S],++S,!(null==T||T.get_finished())){T.nextSamples(ke.sampleCache1,n,t.samplesPerSecond);for(var E=0,C;E<n;)C=E++,ke.sampleCache2[C]+=ke.sampleCache1[C]*T.get_volume()}for(var I=0;I<n;){var v=I++,k=ke.sampleCache2[v],a=1>k?k:1;t.data[t.writeLocation]=-1<a?a:-1,t.writeLocation+=1,t.writeLocation>=t.size&&(t.writeLocation=0)}},ke.play=function(e,t){null==t&&(t=!1);var n=null;n=ve.samplesPerSecond==e.sampleRate?new Le(t):new Oe(t,e.sampleRate),n.data=e.uncompressedData;for(var d=!1,a=0;32>a;){var r=a++;if(null==ke.soundChannels[r]||ke.soundChannels[r].get_finished()){ke.soundChannels[r]=n,d=!0;break}}return d?n:null},ke._playAgain=function(e){for(var t=0;32>t;){var n=t++;ke.soundChannels[n]==e&&(ke.soundChannels[n]=null)}for(var i=0;32>i;){var d=i++;if(null==ke.soundChannels[d]||ke.soundChannels[d].get_finished()||ke.soundChannels[d]==e){ke.soundChannels[d]=e;break}}},ke.stream=function(e,t){null==t&&(t=!1);var n=ve.stream(e,t);if(null!=n)return n;for(var d=new Ne(e.compressedData,t),a=!1,r=0;32>r;){var s=r++;if(null==ke.streamChannels[s]||ke.streamChannels[s].get_finished()){ke.streamChannels[s]=d,a=!0;break}}return a?d:null};var Le=function(e){this.looping=!1,this.stopped=!1,this.paused=!1,this.myPosition=0,this.myVolume=1,this.data=null,this.looping=e};s["kha.audio2.AudioChannel"]=Le,Le.__name__=!0,Le.__interfaces__=[Ce],Le.max=function(e,t){return e>t?e:t},Le.min=function(e,t){return e<t?e:t},Le.prototype={data:null,myVolume:null,myPosition:null,paused:null,stopped:null,looping:null,nextSamples:function(e,t){if(this.paused||this.stopped){for(var n=0;n<t;){var d=n++;e[d]=0}return}for(var i=0;i<t;){for(var r=0,s=this.data.length-this.myPosition,a=t-i,o=s<a?s:a;r<o;){r++;e[i++]=this.data[this.myPosition++]}if(this.myPosition>=this.data.length&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;i<t;)e[i++]=0},play:function(){this.paused=!1,this.stopped=!1,ke._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},length:null,get_length:function(){return this.data.length/ve.samplesPerSecond/2},get_position:function(){return this.myPosition/ve.samplesPerSecond/2},set_position:function(e){this.myPosition=Math.round(2*(e*ve.samplesPerSecond));var t=this.myPosition,n=this.data.length,i=t<n?t:n;return this.myPosition=0<i?i:0,e},get_volume:function(){return this.myVolume},set_volume:function(e){return this.myVolume=e},finished:null,get_finished:function(){return this.stopped},__class__:Le};var Be=function(e,t,n){this.size=e;var i=new Float32Array(e);this.data=i,this.channels=t,this.samplesPerSecond=n,this.readLocation=0,this.writeLocation=0};s["kha.audio2.Buffer"]=Be,Be.__name__=!0,Be.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:Be};var Oe=function(e,t){Le.call(this,e),this.sampleRate=t};s["kha.audio2.ResamplingAudioChannel"]=Oe,Oe.__name__=!0,Oe.max=function(e,t){return e>t?e:t},Oe.min=function(e,t){return e<t?e:t},Oe.__super__=Le,Oe.prototype=n(Le.prototype,{sampleRate:null,nextSamples:function(e,n,d){if(this.paused||this.stopped){for(var r=0;r<n;){var s=r++;e[s]=0}return}for(var i=0;i<n;){for(var o=0,u=Math.ceil(this.data.length*(d/this.sampleRate)),l=(0==u%2?u:u+1)-this.myPosition,a=n-i,_=l<a?l:a;o<_;){var f=o++,c=i++,g=this.myPosition++,p=0==g%2,h=this.sampleRate/d,m;if(p){g=0|g/2;var b=h*g,x=Math.floor(b),S=Math.floor(b+1);x*=2,S*=2;var y=this.data.length-1;0==y%2?y=y:--y;var w=x<0||x>y?0:this.data[x],T=S<0||S>y?0:this.data[S],E=b-Math.floor(b);m=(1-E)*w+E*T}else{g=0|g/2;var t=h*g,C=Math.floor(t),I=Math.floor(t+1);C=2*C+1,I=2*I+1;var v=this.data.length-1;0==v%2?--v:v=v;var k=C<1||C>v?0:this.data[C],L=I<1||I>v?0:this.data[I],B=t-Math.floor(t);m=(1-B)*k+B*L}e[c]=m}var O=Math.ceil(this.data.length*(d/this.sampleRate));if(this.myPosition>=(0==O%2?O:O+1)&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;i<n;)e[i++]=0},sample:function(e,n){var i=0==e%2,d=this.sampleRate/n;if(i){e=0|e/2;var r=d*e,s=Math.floor(r),o=Math.floor(r+1);s*=2,o*=2;var u=this.data.length-1;0==u%2?u=u:--u;var l=s<0||s>u?0:this.data[s],a=o<0||o>u?0:this.data[o],_=r-Math.floor(r);return(1-_)*l+_*a}e=0|e/2;var t=d*e,f=Math.floor(t),c=Math.floor(t+1);f=2*f+1,c=2*c+1;var g=this.data.length-1;0==g%2?--g:g=g;var p=1>f||f>g?0:this.data[f],h=1>c||c>g?0:this.data[c],m=t-Math.floor(t);return(1-m)*p+m*h},lerp:function(e,n,i){return(1-i)*e+i*n},sampleLength:function(e){var t=Math.ceil(this.data.length*(e/this.sampleRate));return 0==t%2?t:t+1},play:function(){this.paused=!1,this.stopped=!1,ke._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},get_length:function(){return this.data.length/this.sampleRate/2},get_position:function(){return this.myPosition/this.sampleRate/2},set_position:function(e){this.myPosition=Math.round(2*(e*this.sampleRate));var t=this.myPosition,n=Math.ceil(this.data.length*(ve.samplesPerSecond/this.sampleRate)),i=0==n%2?n:n+1,d=t<i?t:i;return this.myPosition=0<d?d:0,e},get_volume:function(){return this.myVolume},set_volume:function(e){return this.myVolume=e},get_finished:function(){return this.stopped},__class__:Oe});var Ne=function(e,t){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=t,this.reader=Ve.openFromBytes(e)};s["kha.audio2.StreamChannel"]=Ne,Ne.__name__=!0,Ne.__interfaces__=[Ce],Ne.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(e,t,n){if(this.paused){for(var d=0;d<t;){var a=d++;e[a]=0}return}var i=2*this.reader.read(e,0|t/2,2,n,!0);if(i<t){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var r=i;r<t;){var s=r++;e[s]=0}}},play:function(){this.paused=!1},pause:function(){this.paused=!0},stop:function(){this.atend=!0},length:null,get_length:function(){return this.reader.get_totalMillisecond()/1e3},get_position:function(){return this.reader.get_currentMillisecond()/1e3},set_position:function(e){return e},get_volume:function(){return this.myVolume},set_volume:function(e){return this.myVolume=e},finished:null,get_finished:function(){return this.atend},__class__:Ne};var Ae=function(){};s["kha.audio2.ogg.tools.Crc32"]=Ae,Ae.__name__=!0,Ae.init=function(){if(null==Ae.table){var e=Array(256);Ae.table=e;for(var t=0;256>t;){var n=t++,i=n<<24;i=i<<1^(S.gte(i,-2147483648)?79764919:0),i=i<<1^(S.gte(i,-2147483648)?79764919:0),i=i<<1^(S.gte(i,-2147483648)?79764919:0),i=i<<1^(S.gte(i,-2147483648)?79764919:0),i=i<<1^(S.gte(i,-2147483648)?79764919:0),i=i<<1^(S.gte(i,-2147483648)?79764919:0),i=i<<1^(S.gte(i,-2147483648)?79764919:0),i=i<<1^(S.gte(i,-2147483648)?79764919:0),Ae.table[n]=i}}},Ae.update=function(e,t){return e<<8^Ae.table[t^e>>>24]};var Pe=function(){};s["kha.audio2.ogg.tools.MathTools"]=Pe,Pe.__name__=!0,Pe.ilog=function(e){var t=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];return 16384>e?16>e?t[e]:512>e?5+t[e>>5]:10+t[e>>10]:16777216>e?524288>e?15+t[e>>15]:20+t[e>>20]:536870912>e?25+t[e>>25]:-2147483648>e?30+t[e>>30]:0};var Re=function(){};s["kha.audio2.ogg.tools.Mdct"]=Re,Re.__name__=!0,Re.inverseTransform=function(e,t,n,d,a,s){for(var o=t>>1,_=t>>2,f=t>>3,c=Array(o),g=c,p=o-2,h=0,m=0;m!=o;)g[p+1]=e[m]*n[h]-e[m+2]*n[h+1],g[p]=e[m]*n[h+1]+e[m+2]*n[h],p-=2,h+=2,m+=4;for(m=o-3;0<=p;)g[p+1]=-e[m+2]*n[h]- -e[m]*n[h+1],g[p]=-e[m+2]*n[h+1]+-e[m]*n[h],p-=2,h+=2,m-=4;for(var b=e,u=g,x=o-8,S=_,y=0,w=_,T=0;0<=x;){var E=u[S+1]-u[y+1],C=u[S]-u[y];b[w+1]=u[S+1]+u[y+1],b[w]=u[S]+u[y],b[T+1]=E*n[x+4]-C*n[x+5],b[T]=C*n[x+4]+E*n[x+5],E=u[S+3]-u[y+3],C=u[S+2]-u[y+2],b[w+3]=u[S+3]+u[y+3],b[w+2]=u[S+2]+u[y+2],b[T+3]=E*n[x]-C*n[x+1],b[T+2]=C*n[x]+E*n[x+1],x-=8,w+=4,T+=4,S+=4,y+=4}for(var I=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],v=(16384>t?16>t?I[t]:512>t?5+I[t>>5]:10+I[t>>10]:16777216>t?524288>t?15+I[t>>15]:20+I[t>>20]:536870912>t?25+I[t>>25]:-2147483648>t?30+I[t>>30]:0)-1,k=o-1-0*_,L=k,B=k+-(t>>3),O=0,N=(t>>4>>2)+1;0<--N;){var A=b[L]-b[B],P=b[L+-1]-b[B+-1],R=L;b[R]+=b[B];var V=L+-1;b[V]+=b[B+-1],b[B]=A*n[O]-P*n[O+1],b[B+-1]=P*n[O]+A*n[O+1],O+=8,A=b[L+-2]-b[B+-2],P=b[L+-3]-b[B+-3];var D=L+-2;b[D]+=b[B+-2];var F=L+-3;b[F]+=b[B+-3],b[B+-2]=A*n[O]-P*n[O+1],b[B+-3]=P*n[O]+A*n[O+1],O+=8,A=b[L+-4]-b[B+-4],P=b[L+-5]-b[B+-5];var M=L+-4;b[M]+=b[B+-4];var H=L+-5;b[H]+=b[B+-5],b[B+-4]=A*n[O]-P*n[O+1],b[B+-5]=P*n[O]+A*n[O+1],O+=8,A=b[L+-6]-b[B+-6],P=b[L+-7]-b[B+-7];var W=L+-6;b[W]+=b[B+-6];var U=L+-7;b[U]+=b[B+-7],b[B+-6]=A*n[O]-P*n[O+1],b[B+-7]=P*n[O]+A*n[O+1],O+=8,L-=8,B-=8}for(var G=o-1-_,z=G,X=G+-(t>>3),Y=0,j=(t>>4>>2)+1;0<--j;){var Z=b[z]-b[X],K=b[z+-1]-b[X+-1],q=z;b[q]+=b[X];var Q=z+-1;b[Q]+=b[X+-1],b[X]=Z*n[Y]-K*n[Y+1],b[X+-1]=K*n[Y]+Z*n[Y+1],Y+=8,Z=b[z+-2]-b[X+-2],K=b[z+-3]-b[X+-3];var J=z+-2;b[J]+=b[X+-2];var $=z+-3;b[$]+=b[X+-3],b[X+-2]=Z*n[Y]-K*n[Y+1],b[X+-3]=K*n[Y]+Z*n[Y+1],Y+=8,Z=b[z+-4]-b[X+-4],K=b[z+-5]-b[X+-5];var ee=z+-4;b[ee]+=b[X+-4];var te=z+-5;b[te]+=b[X+-5],b[X+-4]=Z*n[Y]-K*n[Y+1],b[X+-5]=K*n[Y]+Z*n[Y+1],Y+=8,Z=b[z+-6]-b[X+-6],K=b[z+-7]-b[X+-7];var ne=z+-6;b[ne]+=b[X+-6];var ie=z+-7;b[ie]+=b[X+-7],b[X+-6]=Z*n[Y]-K*n[Y+1],b[X+-7]=K*n[Y]+Z*n[Y+1],Y+=8,z-=8,X-=8}for(var de=o-1-0*f,ae=0,re=de,se=de+-(t>>4),oe=(t>>5>>2)+1;0<--oe;){var ue=b[re]-b[se],le=b[re+-1]-b[se+-1],_e=re;b[_e]+=b[se];var fe=re+-1;b[fe]+=b[se+-1],b[se]=ue*n[ae]-le*n[ae+1],b[se+-1]=le*n[ae]+ue*n[ae+1],ae+=16,ue=b[re+-2]-b[se+-2],le=b[re+-3]-b[se+-3];var ce=re+-2;b[ce]+=b[se+-2];var ge=re+-3;b[ge]+=b[se+-3],b[se+-2]=ue*n[ae]-le*n[ae+1],b[se+-3]=le*n[ae]+ue*n[ae+1],ae+=16,ue=b[re+-4]-b[se+-4],le=b[re+-5]-b[se+-5];var pe=re+-4;b[pe]+=b[se+-4];var he=re+-5;b[he]+=b[se+-5],b[se+-4]=ue*n[ae]-le*n[ae+1],b[se+-5]=le*n[ae]+ue*n[ae+1],ae+=16,ue=b[re+-6]-b[se+-6],le=b[re+-7]-b[se+-7];var me=re+-6;b[me]+=b[se+-6];var be=re+-7;b[be]+=b[se+-7],b[se+-6]=ue*n[ae]-le*n[ae+1],b[se+-7]=le*n[ae]+ue*n[ae+1],re-=8,se-=8,ae+=16}for(var xe=o-1-f,Se=0,ye=xe,we=xe+-(t>>4),Te=(t>>5>>2)+1;0<--Te;){var Ee=b[ye]-b[we],Ce=b[ye+-1]-b[we+-1],Ie=ye;b[Ie]+=b[we];var ve=ye+-1;b[ve]+=b[we+-1],b[we]=Ee*n[Se]-Ce*n[Se+1],b[we+-1]=Ce*n[Se]+Ee*n[Se+1],Se+=16,Ee=b[ye+-2]-b[we+-2],Ce=b[ye+-3]-b[we+-3];var ke=ye+-2;b[ke]+=b[we+-2];var Le=ye+-3;b[Le]+=b[we+-3],b[we+-2]=Ee*n[Se]-Ce*n[Se+1],b[we+-3]=Ce*n[Se]+Ee*n[Se+1],Se+=16,Ee=b[ye+-4]-b[we+-4],Ce=b[ye+-5]-b[we+-5];var Be=ye+-4;b[Be]+=b[we+-4];var Oe=ye+-5;b[Oe]+=b[we+-5],b[we+-4]=Ee*n[Se]-Ce*n[Se+1],b[we+-5]=Ce*n[Se]+Ee*n[Se+1],Se+=16,Ee=b[ye+-6]-b[we+-6],Ce=b[ye+-7]-b[we+-7];var Ne=ye+-6;b[Ne]+=b[we+-6];var Ae=ye+-7;b[Ae]+=b[we+-7],b[we+-6]=Ee*n[Se]-Ce*n[Se+1],b[we+-7]=Ce*n[Se]+Ee*n[Se+1],ye-=8,we-=8,Se+=16}for(var Pe=o-1-2*f,Re=0,Ve=Pe,De=Pe+-(t>>4),Fe=(t>>5>>2)+1;0<--Fe;){var Me=b[Ve]-b[De],He=b[Ve+-1]-b[De+-1],We=Ve;b[We]+=b[De];var Ue=Ve+-1;b[Ue]+=b[De+-1],b[De]=Me*n[Re]-He*n[Re+1],b[De+-1]=He*n[Re]+Me*n[Re+1],Re+=16,Me=b[Ve+-2]-b[De+-2],He=b[Ve+-3]-b[De+-3];var Ge=Ve+-2;b[Ge]+=b[De+-2];var ze=Ve+-3;b[ze]+=b[De+-3],b[De+-2]=Me*n[Re]-He*n[Re+1],b[De+-3]=He*n[Re]+Me*n[Re+1],Re+=16,Me=b[Ve+-4]-b[De+-4],He=b[Ve+-5]-b[De+-5];var Xe=Ve+-4;b[Xe]+=b[De+-4];var Ye=Ve+-5;b[Ye]+=b[De+-5],b[De+-4]=Me*n[Re]-He*n[Re+1],b[De+-5]=He*n[Re]+Me*n[Re+1],Re+=16,Me=b[Ve+-6]-b[De+-6],He=b[Ve+-7]-b[De+-7];var je=Ve+-6;b[je]+=b[De+-6];var Ze=Ve+-7;b[Ze]+=b[De+-7],b[De+-6]=Me*n[Re]-He*n[Re+1],b[De+-7]=He*n[Re]+Me*n[Re+1],Ve-=8,De-=8,Re+=16}for(var Ke=o-1-3*f,qe=0,Qe=Ke,Je=Ke+-(t>>4),$e=(t>>5>>2)+1;0<--$e;){var et=b[Qe]-b[Je],tt=b[Qe+-1]-b[Je+-1],nt=Qe;b[nt]+=b[Je];var it=Qe+-1;b[it]+=b[Je+-1],b[Je]=et*n[qe]-tt*n[qe+1],b[Je+-1]=tt*n[qe]+et*n[qe+1],qe+=16,et=b[Qe+-2]-b[Je+-2],tt=b[Qe+-3]-b[Je+-3];var dt=Qe+-2;b[dt]+=b[Je+-2];var at=Qe+-3;b[at]+=b[Je+-3],b[Je+-2]=et*n[qe]-tt*n[qe+1],b[Je+-3]=tt*n[qe]+et*n[qe+1],qe+=16,et=b[Qe+-4]-b[Je+-4],tt=b[Qe+-5]-b[Je+-5];var rt=Qe+-4;b[rt]+=b[Je+-4];var st=Qe+-5;b[st]+=b[Je+-5],b[Je+-4]=et*n[qe]-tt*n[qe+1],b[Je+-5]=tt*n[qe]+et*n[qe+1],qe+=16,et=b[Qe+-6]-b[Je+-6],tt=b[Qe+-7]-b[Je+-7];var ot=Qe+-6;b[ot]+=b[Je+-6];var ut=Qe+-7;b[ut]+=b[Je+-7],b[Je+-6]=et*n[qe]-tt*n[qe+1],b[Je+-7]=tt*n[qe]+et*n[qe+1],Qe-=8,Je-=8,qe+=16}for(var lt=2;lt<v-3>>1;)for(var _t=lt++,l=t>>_t+2,ft=0;ft<1<<_t+1;)for(var ct=ft++,gt=o-1-l*ct,pt=1<<_t+3,ht=0,mt=gt,bt=gt+-(l>>1),xt=(t>>_t+4>>2)+1;0<--xt;){var St=b[mt]-b[bt],yt=b[mt+-1]-b[bt+-1],wt=mt;b[wt]+=b[bt];var Tt=mt+-1;b[Tt]+=b[bt+-1],b[bt]=St*n[ht]-yt*n[ht+1],b[bt+-1]=yt*n[ht]+St*n[ht+1],ht+=pt,St=b[mt+-2]-b[bt+-2],yt=b[mt+-3]-b[bt+-3];var Et=mt+-2;b[Et]+=b[bt+-2];var Ct=mt+-3;b[Ct]+=b[bt+-3],b[bt+-2]=St*n[ht]-yt*n[ht+1],b[bt+-3]=yt*n[ht]+St*n[ht+1],ht+=pt,St=b[mt+-4]-b[bt+-4],yt=b[mt+-5]-b[bt+-5];var It=mt+-4;b[It]+=b[bt+-4];var vt=mt+-5;b[vt]+=b[bt+-5],b[bt+-4]=St*n[ht]-yt*n[ht+1],b[bt+-5]=yt*n[ht]+St*n[ht+1],ht+=pt,St=b[mt+-6]-b[bt+-6],yt=b[mt+-7]-b[bt+-7];var kt=mt+-6;b[kt]+=b[bt+-6];var Lt=mt+-7;b[Lt]+=b[bt+-7],b[bt+-6]=St*n[ht]-yt*n[ht+1],b[bt+-7]=yt*n[ht]+St*n[ht+1],mt-=8,bt-=8,ht+=pt}for(var Bt=v-3>>1;Bt<v-6;)for(var Ot=Bt++,Nt=t>>Ot+2,At=1<<Ot+3,Pt=0,Rt=o-1,Vt=(t>>Ot+6)+1;0<--Vt;){for(var Dt=n[Pt],Ft=n[Pt+1],Mt=n[Pt+At],Ht=n[Pt+At+1],Wt=n[Pt+2*At],Ut=n[Pt+2*At+1],Gt=n[Pt+3*At],zt=n[Pt+3*At+1],Xt=Rt,Yt=Rt+-(Nt>>1),jt=(1<<Ot+1)+1;0<--jt;){var Zt=b[Xt]-b[Yt],Kt=b[Xt+-1]-b[Yt+-1];b[Xt]+=b[Yt],b[Xt+-1]=b[Xt+-1]+b[Yt+-1],b[Yt]=Zt*Dt-Kt*Ft,b[Yt+-1]=Kt*Dt+Zt*Ft,Zt=b[Xt+-2]-b[Yt+-2],Kt=b[Xt+-3]-b[Yt+-3],b[Xt+-2]=b[Xt+-2]+b[Yt+-2],b[Xt+-3]=b[Xt+-3]+b[Yt+-3],b[Yt+-2]=Zt*Mt-Kt*Ht,b[Yt+-3]=Kt*Mt+Zt*Ht,Zt=b[Xt+-4]-b[Yt+-4],Kt=b[Xt+-5]-b[Yt+-5],b[Xt+-4]=b[Xt+-4]+b[Yt+-4],b[Xt+-5]=b[Xt+-5]+b[Yt+-5],b[Yt+-4]=Zt*Wt-Kt*Ut,b[Yt+-5]=Kt*Wt+Zt*Ut,Zt=b[Xt+-6]-b[Yt+-6],Kt=b[Xt+-7]-b[Yt+-7],b[Xt+-6]=b[Xt+-6]+b[Yt+-6],b[Xt+-7]=b[Xt+-7]+b[Yt+-7],b[Yt+-6]=Zt*Gt-Kt*zt,b[Yt+-7]=Kt*Gt+Zt*zt,Xt-=Nt,Yt-=Nt}Pt+=4*At,Rt-=8}for(var qt=o-1,Qt=n[t>>3],Jt=qt;Jt>qt-16*(t>>5);){var $t=b[Jt],en=b[Jt+-8];b[Jt+-8]=$t-en,b[Jt]=$t+en,$t=b[Jt+-1],en=b[Jt+-9],b[Jt+-9]=$t-en,b[Jt+-1]=$t+en,$t=b[Jt+-2],en=b[Jt+-10];var tn=$t-en;b[Jt+-2]=$t+en,$t=b[Jt+-3],en=b[Jt+-11];var nn=$t-en;b[Jt+-3]=$t+en,b[Jt+-10]=(tn+nn)*Qt,b[Jt+-11]=(nn-tn)*Qt,$t=b[Jt+-4],en=b[Jt+-12],tn=en-$t,b[Jt+-4]=$t+en,$t=b[Jt+-5],en=b[Jt+-13],nn=$t-en,b[Jt+-5]=$t+en,b[Jt+-12]=nn,b[Jt+-13]=tn,$t=b[Jt+-6],en=b[Jt+-14],tn=en-$t,b[Jt+-6]=$t+en,$t=b[Jt+-7],en=b[Jt+-15],nn=$t-en,b[Jt+-7]=$t+en,b[Jt+-14]=(tn+nn)*Qt,b[Jt+-15]=(tn-nn)*Qt;var dn=b[Jt],an=b[Jt+-4],rn=dn-an,sn=dn+an;dn=b[Jt+-2],an=b[Jt+-6];var on=dn+an,un=dn-an;b[Jt]=sn+on,b[Jt+-2]=sn-on;var ln=b[Jt+-3]-b[Jt+-7];b[Jt+-4]=rn+ln,b[Jt+-6]=rn-ln,dn=b[Jt+-1],an=b[Jt+-5];var _n=dn-an,fn=dn+an,cn=b[Jt+-3]+b[Jt+-7];b[Jt+-1]=fn+cn,b[Jt+-3]=fn-cn,b[Jt+-5]=_n-un,b[Jt+-7]=_n+un;var gn=Jt-8,pn=b[gn],hn=b[gn+-4],mn=pn-hn,bn=pn+hn;pn=b[gn+-2],hn=b[gn+-6];var xn=pn+hn,Sn=pn-hn;b[gn]=bn+xn,b[gn+-2]=bn-xn;var yn=b[gn+-3]-b[gn+-7];b[gn+-4]=mn+yn,b[gn+-6]=mn-yn,pn=b[gn+-1],hn=b[gn+-5];var wn=pn-hn,Tn=pn+hn,En=b[gn+-3]+b[gn+-7];b[gn+-1]=Tn+En,b[gn+-3]=Tn-En,b[gn+-5]=wn-Sn,b[gn+-7]=wn+Sn,Jt-=16}for(var Cn=0,In=_-4,vn=o-4;0<=In;){var kn=s[Cn];u[vn+3]=b[kn],u[vn+2]=b[kn+1],u[In+3]=b[kn+2],u[In+2]=b[kn+3],kn=s[Cn+1],u[vn+1]=b[kn],u[vn]=b[kn+1],u[In+1]=b[kn+2],u[In]=b[kn+3],In-=4,vn-=4,Cn+=2}for(var Ln=0,Bn=0,On=o-4;Bn<On;){var Nn=u[Bn]-u[On+2],An=u[Bn+1]+u[On+3],Pn=a[Ln+1]*Nn+a[Ln]*An,Rn=a[Ln+1]*An-a[Ln]*Nn,Vn=u[Bn]+u[On+2],Dn=u[Bn+1]-u[On+3];u[Bn]=Vn+Pn,u[Bn+1]=Dn+Rn,u[On+2]=Vn-Pn,u[On+3]=Rn-Dn,Nn=u[Bn+2]-u[On],An=u[Bn+3]+u[On+1],Pn=a[Ln+3]*Nn+a[Ln+2]*An,Rn=a[Ln+3]*An-a[Ln+2]*Nn,Vn=u[Bn+2]+u[On],Dn=u[Bn+3]-u[On+1],u[Bn+2]=Vn+Pn,u[Bn+3]=Dn+Rn,u[On]=Vn-Pn,u[On+1]=Rn-Dn,Ln+=4,Bn+=4,On-=4}for(var Fn=o-8,Mn=o-8,Hn=0,Wn=o-4,Un=o,Gn=t-4;0<=Mn;){var zn=g[Mn+6]*d[Fn+7]-g[Mn+7]*d[Fn+6],Xn=-g[Mn+6]*d[Fn+6]-g[Mn+7]*d[Fn+7];e[Hn]=zn,e[Wn+3]=-zn,e[Un]=Xn,e[Gn+3]=Xn;var Yn=g[Mn+4]*d[Fn+5]-g[Mn+5]*d[Fn+4],jn=-g[Mn+4]*d[Fn+4]-g[Mn+5]*d[Fn+5];e[Hn+1]=Yn,e[Wn+2]=-Yn,e[Un+1]=jn,e[Gn+2]=jn,zn=g[Mn+2]*d[Fn+3]-g[Mn+3]*d[Fn+2],Xn=-g[Mn+2]*d[Fn+2]-g[Mn+3]*d[Fn+3],e[Hn+2]=zn,e[Wn+1]=-zn,e[Un+2]=Xn,e[Gn+1]=Xn,Yn=g[Mn]*d[Fn+1]-g[Mn+1]*d[Fn],jn=-g[Mn]*d[Fn]-g[Mn+1]*d[Fn+1],e[Hn+3]=Yn,e[Wn]=-Yn,e[Un+3]=jn,e[Gn]=jn,Fn-=8,Mn-=8,Hn+=4,Un+=4,Wn-=4,Gn-=4}},Re.step3Iter0Loop=function(t,n,e,d,r){for(var a=e,s=e+d,o=0,u=(t>>2)+1;0<--u;){var l=n[a]-n[s],_=n[a+-1]-n[s+-1],f=a;n[f]+=n[s];var c=a+-1;n[c]+=n[s+-1],n[s]=l*r[o]-_*r[o+1],n[s+-1]=_*r[o]+l*r[o+1],o+=8,l=n[a+-2]-n[s+-2],_=n[a+-3]-n[s+-3];var g=a+-2;n[g]+=n[s+-2];var p=a+-3;n[p]+=n[s+-3],n[s+-2]=l*r[o]-_*r[o+1],n[s+-3]=_*r[o]+l*r[o+1],o+=8,l=n[a+-4]-n[s+-4],_=n[a+-5]-n[s+-5];var h=a+-4;n[h]+=n[s+-4];var m=a+-5;n[m]+=n[s+-5],n[s+-4]=l*r[o]-_*r[o+1],n[s+-5]=_*r[o]+l*r[o+1],o+=8,l=n[a+-6]-n[s+-6],_=n[a+-7]-n[s+-7];var b=a+-6;n[b]+=n[s+-6];var x=a+-7;n[x]+=n[s+-7],n[s+-6]=l*r[o]-_*r[o+1],n[s+-7]=_*r[o]+l*r[o+1],o+=8,a-=8,s-=8}},Re.step3InnerRLoop=function(t,n,e,d,r,a){for(var s=0,o=e,u=e+d,l=(t>>2)+1;0<--l;){var _=n[o]-n[u],f=n[o+-1]-n[u+-1],c=o;n[c]+=n[u];var g=o+-1;n[g]+=n[u+-1],n[u]=_*r[s]-f*r[s+1],n[u+-1]=f*r[s]+_*r[s+1],s+=a,_=n[o+-2]-n[u+-2],f=n[o+-3]-n[u+-3];var p=o+-2;n[p]+=n[u+-2];var h=o+-3;n[h]+=n[u+-3],n[u+-2]=_*r[s]-f*r[s+1],n[u+-3]=f*r[s]+_*r[s+1],s+=a,_=n[o+-4]-n[u+-4],f=n[o+-5]-n[u+-5];var m=o+-4;n[m]+=n[u+-4];var b=o+-5;n[b]+=n[u+-5],n[u+-4]=_*r[s]-f*r[s+1],n[u+-5]=f*r[s]+_*r[s+1],s+=a,_=n[o+-6]-n[u+-6],f=n[o+-7]-n[u+-7];var x=o+-6;n[x]+=n[u+-6];var S=o+-7;n[S]+=n[u+-7],n[u+-6]=_*r[s]-f*r[s+1],n[u+-7]=f*r[s]+_*r[s+1],o-=8,u-=8,s+=a}},Re.step3InnerSLoop=function(t,n,e,d,r,a,s,o){for(var u=r[a],l=r[a+1],_=r[a+s],f=r[a+s+1],c=r[a+2*s],g=r[a+2*s+1],p=r[a+3*s],h=r[a+3*s+1],m=e,b=e+d,x=t+1;0<--x;){var S=n[m]-n[b],y=n[m+-1]-n[b+-1];n[m]+=n[b],n[m+-1]=n[m+-1]+n[b+-1],n[b]=S*u-y*l,n[b+-1]=y*u+S*l,S=n[m+-2]-n[b+-2],y=n[m+-3]-n[b+-3],n[m+-2]=n[m+-2]+n[b+-2],n[m+-3]=n[m+-3]+n[b+-3],n[b+-2]=S*_-y*f,n[b+-3]=y*_+S*f,S=n[m+-4]-n[b+-4],y=n[m+-5]-n[b+-5],n[m+-4]=n[m+-4]+n[b+-4],n[m+-5]=n[m+-5]+n[b+-5],n[b+-4]=S*c-y*g,n[b+-5]=y*c+S*g,S=n[m+-6]-n[b+-6],y=n[m+-7]-n[b+-7],n[m+-6]=n[m+-6]+n[b+-6],n[m+-7]=n[m+-7]+n[b+-7],n[b+-6]=S*p-y*h,n[b+-7]=y*p+S*h,m-=o,b-=o}},Re.iter54=function(t,e){var n=t[e],i=t[e+-4],d=n-i,a=n+i;n=t[e+-2],i=t[e+-6];var r=n+i,s=n-i;t[e]=a+r,t[e+-2]=a-r;var o=t[e+-3]-t[e+-7];t[e+-4]=d+o,t[e+-6]=d-o,n=t[e+-1],i=t[e+-5];var u=n-i,l=n+i,_=t[e+-3]+t[e+-7];t[e+-1]=l+_,t[e+-3]=l-_,t[e+-5]=u-s,t[e+-7]=u+s},Re.step3InnerSLoopLd654=function(t,n,e,i,d){for(var a=i[d>>3],r=e;r>e-16*t;){var s=n[r],o=n[r+-8];n[r+-8]=s-o,n[r]=s+o,s=n[r+-1],o=n[r+-9],n[r+-9]=s-o,n[r+-1]=s+o,s=n[r+-2],o=n[r+-10];var u=s-o;n[r+-2]=s+o,s=n[r+-3],o=n[r+-11];var l=s-o;n[r+-3]=s+o,n[r+-10]=(u+l)*a,n[r+-11]=(l-u)*a,s=n[r+-4],o=n[r+-12],u=o-s,n[r+-4]=s+o,s=n[r+-5],o=n[r+-13],l=s-o,n[r+-5]=s+o,n[r+-12]=l,n[r+-13]=u,s=n[r+-6],o=n[r+-14],u=o-s,n[r+-6]=s+o,s=n[r+-7],o=n[r+-15],l=s-o,n[r+-7]=s+o,n[r+-14]=(u+l)*a,n[r+-15]=(u-l)*a;var _=n[r],f=n[r+-4],c=_-f,g=_+f;_=n[r+-2],f=n[r+-6];var p=_+f,h=_-f;n[r]=g+p,n[r+-2]=g-p;var m=n[r+-3]-n[r+-7];n[r+-4]=c+m,n[r+-6]=c-m,_=n[r+-1],f=n[r+-5];var b=_-f,x=_+f,S=n[r+-3]+n[r+-7];n[r+-1]=x+S,n[r+-3]=x-S,n[r+-5]=b-h,n[r+-7]=b+h;var y=r-8,w=n[y],T=n[y+-4],E=w-T,C=w+T;w=n[y+-2],T=n[y+-6];var I=w+T,v=w-T;n[y]=C+I,n[y+-2]=C-I;var k=n[y+-3]-n[y+-7];n[y+-4]=E+k,n[y+-6]=E-k,w=n[y+-1],T=n[y+-5];var L=w-T,B=w+T,O=n[y+-3]+n[y+-7];n[y+-1]=B+O,n[y+-3]=B-O,n[y+-5]=L-v,n[y+-7]=L+v,r-=16}};var Ve=function(e,t,n){this.seekFunc=t,this.inputLength=n,this.decoder=Me.start(e),this.decoder.setupSampleNumber(t,n),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};s["kha.audio2.ogg.vorbis.Reader"]=Ve,Ve.__name__=!0,Ve.openFromBytes=function(e){var t=new A(e);return new Ve(t,function(e){Ve.seekBytes(t,e)},e.length)},Ve.seekBytes=function(e,t){e.set_position(t)},Ve.readAll=function(e,t,d){null==d&&(d=!1);var a=new A(e),r=Me.start(a);r.setupSampleNumber(function(e){Ve.seekBytes(a,e)},e.length);for(var s=r.header,o=4096,u=new Float32Array(o*s.channel),l=u;;){for(var _=r.read(l,o,s.channel,s.sampleRate,d),n=0,f=_*s.channel;n<f;){var c=n++;t.writeFloat(l[c])}if(0==_)break}return r.header},Ve.prototype={decoder:null,get_header:function(){return this.decoder.header},get_totalSample:function(){return this.decoder.totalSample},get_totalMillisecond:function(){var e=this.decoder.totalSample,t=this.get_header().sampleRate;return 1e3*(S.toFloat(e)/S.toFloat(t))},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(e){return this.decoder.seek(this.seekFunc,this.inputLength,e),this.decoder.currentSample},get_currentMillisecond:function(){var e=this.get_currentSample(),t=this.get_header().sampleRate;return 1e3*(S.toFloat(e)/S.toFloat(t))},set_currentMillisecond:function(e){return this.set_currentSample(Math.floor(S.toFloat(this.get_header().sampleRate)*(e/1e3))),this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(e,t,n,i,d){return null==d&&(d=!1),this.decoder.ensurePosition(this.seekFunc),null==t&&(t=this.decoder.totalSample),null==n&&(n=this.get_header().channel),null==i&&(i=this.get_header().sampleRate),this.decoder.read(e,t,n,i,d)},clone:function(){var e=Object.create(Ve.prototype);return e.seekFunc=this.seekFunc,e.inputLength=this.inputLength,e.decoder=this.decoder.clone(this.seekFunc),e.loopStart=this.loopStart,e.loopLength=this.loopLength,e},sampleToMillisecond:function(e){var t=this.get_header().sampleRate;return 1e3*(S.toFloat(e)/S.toFloat(t))},millisecondToSample:function(e){return Math.floor(S.toFloat(this.get_header().sampleRate)*(e/1e3))},__class__:Ve};var De=function(e){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=e,this.inputPosition=0,this.page=new Qe,Ae.init()};s["kha.audio2.ogg.vorbis.VorbisDecodeState"]=De,De.__name__=!0,De.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,currentSample:null,previousWindow:null,previousLength:null,finalY:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(e,t){this.inputPosition+=1;var n=this.input.readByte();this.inputPosition+=n;for(var d=Array(n),a=d,r=0,s;r<n;)s=r++,a[s]=this.input.readByte();if(this.segments=a,this.endSegWithKnownLoc=-2,-1!=e||-1!=t)for(var o=n-1;0<=o&&!(255>this.segments[o]);)0<=o&&(this.endSegWithKnownLoc=o,this.knownLocForPacket=e),--o;if(this.firstDecode){for(var u=0,l=new $e,_=0,f;_<n;)f=_++,u+=this.segments[f];u+=27+n,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+u,l.firstDecodedSample=0,l.lastDecodedSample=e,this.pFirst=l}this.nextSeg=0},clone:function(e){var t=Object.create(De.prototype);return e(this.inputPosition),t.input=this.input,t.eof=this.eof,t.validBits=this.validBits,t.discardSamplesDeferred=this.discardSamplesDeferred,t.firstDecode=this.firstDecode,t.nextSeg=this.nextSeg,t.bytesInSeg=this.bytesInSeg,t.acc=t.acc,t.lastSeg=this.lastSeg,t.lastSegWhich=this.lastSegWhich,t.currentLoc=this.currentLoc,t.currentLocValid=this.currentLocValid,t.inputPosition=this.inputPosition,t.firstAudioPageOffset=this.firstAudioPageOffset,t.error=this.error,t.segments=this.segments,t.pFirst=this.pFirst,t.pLast=this.pLast,t.page=this.page.clone(),t},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(n){var t=n instanceof W?n.val:n;if(t instanceof et)return this.lastSeg=!0,this.error=t,0;throw n}if(0==(1&this.page.flag))throw new W(new et(tt.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var e=this.segments[this.nextSeg++];return 255>e&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1),this.bytesInSeg=e,e},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new W(new et(tt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var e=!1,t;try{this.inputPosition+=1,t=this.input.readByte()}catch(i){var n=i instanceof W?i.val:i;if(n instanceof D){e=!0,t=0}else throw i}if(e)return!1;var i,d,a;if(79==t?(this.inputPosition+=1,a=103!=this.input.readByte()):a=!0,a?d=!0:(this.inputPosition+=1,d=103!=this.input.readByte()),d?i=!0:(this.inputPosition+=1,i=83!=this.input.readByte()),i)throw new W(new et(tt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(e){if(0>this.validBits)return 0;if(this.validBits<e){if(24<e)return this.readBits(24)+(this.readBits(e-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}else this.bytesInSeg--,this.inputPosition+=1,this.acc+=this.input.readByte()<<this.validBits,this.validBits+=8;if(!(this.validBits<e))break}if(0>this.validBits)return 0;var t=this.acc&(1<<e)-1;return this.acc>>>=e,this.validBits-=e,t}var n=this.acc&(1<<e)-1;return this.acc>>>=e,this.validBits-=e,n},readPacketRaw:function(){return 0==this.bytesInSeg&&(this.lastSeg||0==this.next())?-1:(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte())},readPacket:function(){var e;return 0==this.bytesInSeg&&(this.lastSeg||0==this.next())?e=-1:(this.bytesInSeg--,this.inputPosition+=1,e=this.input.readByte()),this.validBits=0,e},flushPacket:function(){for(;0!=this.bytesInSeg||!this.lastSeg&&0!=this.next();)this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()},vorbisValidate:function(){var e=new B(new ArrayBuffer(6)),t;0==this.bytesInSeg&&(this.lastSeg||0==this.next())?t=-1:(this.bytesInSeg--,this.inputPosition+=1,t=this.input.readByte()),this.validBits=0,e.b[0]=t;var n;0==this.bytesInSeg&&(this.lastSeg||0==this.next())?n=-1:(this.bytesInSeg--,this.inputPosition+=1,n=this.input.readByte()),this.validBits=0,e.b[1]=n;var i;0==this.bytesInSeg&&(this.lastSeg||0==this.next())?i=-1:(this.bytesInSeg--,this.inputPosition+=1,i=this.input.readByte()),this.validBits=0,e.b[2]=i;var d;0==this.bytesInSeg&&(this.lastSeg||0==this.next())?d=-1:(this.bytesInSeg--,this.inputPosition+=1,d=this.input.readByte()),this.validBits=0,e.b[3]=d;var a;0==this.bytesInSeg&&(this.lastSeg||0==this.next())?a=-1:(this.bytesInSeg--,this.inputPosition+=1,a=this.input.readByte()),this.validBits=0,e.b[4]=a;var r;if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())?r=-1:(this.bytesInSeg--,this.inputPosition+=1,r=this.input.readByte()),this.validBits=0,e.b[5]=r,"vorbis"!=e.toString())throw new W(new et(tt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}))},firstPageValidate:function(){if(1!=this.segments.length)throw new W(new et(tt.INVALID_FIRST_PAGE,"segmentCount",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:308,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new W(new et(tt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:311,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},capturePattern:function(){var e,t,n;if(this.inputPosition+=1,79==this.input.readByte()?(this.inputPosition+=1,n=103!=this.input.readByte()):n=!0,n?t=!0:(this.inputPosition+=1,t=103!=this.input.readByte()),t?e=!0:(this.inputPosition+=1,e=83!=this.input.readByte()),e)throw new W(new et(tt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}))},skip:function(e){this.inputPosition+=e;for(var t=Array(e),n=0;n<e;){var d=n++;t[d]=this.input.readByte()}},prepHuffman:function(){if(24>=this.validBits)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc+=this.input.readByte()<<this.validBits,this.validBits+=8,!(24>=this.validBits))break}},decode:function(e){10>this.validBits&&this.prepHuffman();var t=e.fastHuffman[1023&this.acc],n;if(0<=t){var i=e.codewordLengths[t];this.acc>>>=i,this.validBits-=i,0>this.validBits?(this.validBits=0,n=-1):n=t}else n=this.decodeScalarRaw(e);return e.sparse&&(n=e.sortedValues[n]),n},decodeRaw:function(e){10>this.validBits&&this.prepHuffman();var t=e.fastHuffman[1023&this.acc];if(0<=t){var n=e.codewordLengths[t];return this.acc>>>=n,this.validBits-=n,0>this.validBits?(this.validBits=0,-1):t}return this.decodeScalarRaw(e)},isLastByte:function(){return!(0!=this.bytesInSeg)&&this.lastSeg},finishDecodePacket:function(e,t,n){var i=n.left.start,d=!1,a=t>>1;if(this.firstDecode)this.currentLoc=-a,this.discardSamplesDeferred=t-n.right.end,d=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)n.left.start+=this.discardSamplesDeferred,i=n.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(d&&0!=(4&this.page.flag)){var r=this.knownLocForPacket-(t-n.right.end);if(r<this.currentLoc+n.right.end){var s=r<this.currentLoc?0:r-this.currentLoc;return s+=n.left.start,this.currentLoc+=s,{len:s,left:i,right:n.right.start}}}this.currentLoc=this.knownLocForPacket-(a-n.left.start),d=!0}return d&&(this.currentLoc+=n.right.start-n.left.start),{len:n.right.end,left:i,right:n.right.start}},readInt32:function(){return this.inputPosition+=4,this.input.readInt32()},readByte:function(){return this.inputPosition+=1,this.input.readByte()},read:function(e){this.inputPosition+=e;for(var t=Array(e),n=t,d=0;d<e;){var a=d++;n[a]=this.input.readByte()}return n},readBytes:function(e){return this.inputPosition+=e,this.input.read(e)},readString:function(e){return this.inputPosition+=e,this.input.readString(e)},getSampleNumber:function(t,n){var d=this.inputPosition,a=S.gte(n,65536)&&S.gte(n-65536,this.firstAudioPageOffset)?n-65536:this.firstAudioPageOffset;t(this.inputPosition=a);var r=0,s=!1,o=this.findPage(t,n);switch(o._hx_index){case 0:var u=o.last,l=o.end;r=l,s=u;break;case 1:throw new W(new et(tt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));}var e=this.inputPosition;_hx_loop1:for(;!s;){t(this.inputPosition=r);var _=this.findPage(t,n);switch(_._hx_index){case 0:var f=_.last,c=_.end;r=c,s=f;break;case 1:break _hx_loop1;}a=e+1,e=this.inputPosition}t(this.inputPosition=e),this.inputPosition+=6;for(var g=[,,,,,,],p=g,h=0,m;h<6;)m=h++,p[m]=this.input.readByte();this.inputPosition+=4;var b=this.input.readInt32();this.inputPosition+=4;var x=this.input.readInt32();if(-1==b&&-1==x||0<x)throw new W(new et(tt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:553,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new $e,this.pLast.pageStart=e,this.pLast.pageEnd=r,this.pLast.lastDecodedSample=b,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=a,t(this.inputPosition=d),b},forcePageResync:function(){this.nextSeg=-1},setInputOffset:function(e,t){e(this.inputPosition=t)},findPage:function(e,t){try{for(;;){this.inputPosition+=1;var d=this.input.readByte();if(79==d){var n=this.inputPosition;if(n-25>t)return Fe.NotFound;var a,r;if(this.inputPosition+=1,103==this.input.readByte()?(this.inputPosition+=1,r=103!=this.input.readByte()):r=!0,r?a=!0:(this.inputPosition+=1,a=83!=this.input.readByte()),a)continue;var o=Array(27),u=o;if(u[0]=79,u[1]=103,u[2]=103,u[3]=83,this.inputPosition+=1,u[4]=this.input.readByte(),this.inputPosition+=1,u[5]=this.input.readByte(),this.inputPosition+=1,u[6]=this.input.readByte(),this.inputPosition+=1,u[7]=this.input.readByte(),this.inputPosition+=1,u[8]=this.input.readByte(),this.inputPosition+=1,u[9]=this.input.readByte(),this.inputPosition+=1,u[10]=this.input.readByte(),this.inputPosition+=1,u[11]=this.input.readByte(),this.inputPosition+=1,u[12]=this.input.readByte(),this.inputPosition+=1,u[13]=this.input.readByte(),this.inputPosition+=1,u[14]=this.input.readByte(),this.inputPosition+=1,u[15]=this.input.readByte(),this.inputPosition+=1,u[16]=this.input.readByte(),this.inputPosition+=1,u[17]=this.input.readByte(),this.inputPosition+=1,u[18]=this.input.readByte(),this.inputPosition+=1,u[19]=this.input.readByte(),this.inputPosition+=1,u[20]=this.input.readByte(),this.inputPosition+=1,u[21]=this.input.readByte(),this.inputPosition+=1,u[22]=this.input.readByte(),this.inputPosition+=1,u[23]=this.input.readByte(),this.inputPosition+=1,u[24]=this.input.readByte(),this.inputPosition+=1,u[25]=this.input.readByte(),this.inputPosition+=1,u[26]=this.input.readByte(),0!=u[4]){e(this.inputPosition=n);continue}var l=u[22]+(u[23]<<8)+(u[24]<<16)+(u[25]<<24);u[22]=0,u[23]=0,u[24]=0,u[25]=0;for(var _=0,f=0,c;27>f;)c=f++,_=_<<8^Ae.table[u[c]^_>>>24];var g=0;try{for(var p=0,h=u[26],m;p<h;){m=p++,this.inputPosition+=1;var b=this.input.readByte();_=_<<8^Ae.table[b^_>>>24],g+=b}for(var s=0,x=g,S;s<x;){S=s++,this.inputPosition+=1;var y=this.input.readByte();_=_<<8^Ae.table[y^_>>>24]}}catch(t){var w=t instanceof W?t.val:t;if(w instanceof D){return Fe.NotFound}throw t}if(_==l){var T=this.inputPosition;return e(this.inputPosition=n-1),Fe.Found(T,0!=(4&u[5]))}}}}catch(e){var E=e instanceof W?e.val:e;if(E instanceof D){return Fe.NotFound}throw e}},analyzePage:function(e,t){var d=new $e,a=Array(255),r=a;d.pageStart=this.inputPosition,this.inputPosition+=27;for(var s=Array(27),o=s,u=0,l;u<27;)l=u++,o[l]=this.input.readByte();var _=o,f=_[26];this.inputPosition+=f;for(var n=Array(f),c=n,g=0,p;g<f;)p=g++,c[p]=this.input.readByte();for(var h=c,m=0,x=0,S=_[26],y;x<S;)y=x++,m+=h[y];if(d.pageEnd=d.pageStart+27+_[26]+m,d.lastDecodedSample=_[6]+(_[7]<<8)+(_[8]<<16)+(_[9]<<16),0!=(4&_[5]))return d.firstDecodedSample=null,e(this.inputPosition=d.pageStart),d;for(var w=0,T=0==(1&_[5]),E=t.modes.length,C=0,I=_[26],v;C<I;){if(v=C++,T){if(0==h[v])return e(this.inputPosition=d.pageStart),null;this.inputPosition+=1;var k=this.input.readByte();if(0!=(1&k))return e(this.inputPosition=d.pageStart),null;k>>=1;var L=E-1,B=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],O=16384>L?16>L?B[L]:512>L?5+B[L>>5]:10+B[L>>10]:16777216>L?524288>L?15+B[L>>15]:20+B[L>>20]:536870912>L?25+B[L>>25]:-2147483648>L?30+B[L>>30]:0;if(k&=(1<<O)-1,k>=E)return e(this.inputPosition=d.pageStart),null;r[w++]=t.modes[k].blockflag;var b=h[v]-1;this.inputPosition+=b;for(var N=Array(b),A=0,P;A<b;)P=A++,N[P]=this.input.readByte()}else{var R=h[v];this.inputPosition+=R;for(var V=Array(R),D=0,F;D<R;)F=D++,V[F]=this.input.readByte()}T=255>h[v]}var M=0;1<w&&(M+=r[w-1]?t.blocksize1:t.blocksize0);for(var H=w-2;1<=H;)--H,M+=r[H]?r[H+1]?t.blocksize1>>1:(t.blocksize1-t.blocksize0>>2)+(t.blocksize0>>1):t.blocksize0>>1,--H;return d.firstDecodedSample=d.lastDecodedSample-M,e(this.inputPosition=d.pageStart),d},decodeScalarRaw:function(e){this.prepHuffman();var t=e.codewordLengths,d=e.codewords,a=e.sortedCodewords;if(8<e.entries?null!=a:null!=d){var r=this.acc;r=(-1431655766&r)>>>1|(1431655765&r)<<1,r=(-858993460&r)>>>2|(858993459&r)<<2,r=(-252645136&r)>>>4|(252645135&r)<<4,r=(-16711936&r)>>>8|(16711935&r)<<8;for(var s=r>>>16|r<<16,o=0,u=e.sortedEntries,l;1<u;)l=o+(u>>1),S.gte(s,a[l])?(o=l,u-=u>>1):u>>=1;e.sparse||(o=e.sortedValues[o]);var _=t[o];return this.validBits>=_?(this.acc>>>=_,this.validBits-=_,o):(this.validBits=0,-1)}for(var f=0,c=e.entries;f<c;){var g=f++,i=t[g];if(255!=i&&d[g]==(this.acc&(1<<i)-1))return this.validBits>=i?(this.acc>>>=i,this.validBits-=i,g):(this.validBits=0,-1)}return this.error=new et(tt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:847,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:De};var Fe=u["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"],Found:(_=function(e,t){return{_hx_index:0,end:e,last:t,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:o}},_.__params__=["end","last"],_),NotFound:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:o}},Me=function(e,t){this.header=e,this.decodeState=t,this.totalSample=null,this.currentSample=0,this.previousLength=0;var n=Array(e.channel);this.channelBuffers=n;var d=Array(e.channel);this.previousWindow=d;var a=Array(e.channel);this.finalY=a;for(var r=0,s=e.channel;r<s;){var o=r++,i=this.channelBuffers,u=Array(e.blocksize1);i[o]=u;var l=this.previousWindow,_=Array(0|e.blocksize1/2);l[o]=_,this.finalY[o]=[]}var f=[,,];this.a=f;var c=[,,];this.b=c;var g=[,,];this.c=g;var p=[,,];this.window=p;var h=[,,];this.bitReverseData=h,this.initBlocksize(0,e.blocksize0),this.initBlocksize(1,e.blocksize1)};s["kha.audio2.ogg.vorbis.VorbisDecoder"]=Me,Me.__name__=!0,Me.start=function(e){var t=new De(e),n=Ye.read(t),i=new Me(n,t);return t.startFirstDecode(),i.pumpFirstFrame(),i},Me.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,totalSample:null,decodeState:null,read:function(e,t,d,a,r){var s=this.header.sampleRate;if(0!=(0|S.toFloat(a)%S.toFloat(s))){var o=this.header.sampleRate;throw new W("Unsupported sampleRate : can't convert "+h.string(null==o?null:S.toFloat(o))+" to "+a)}if(0!=d%this.header.channel)throw new W("Unsupported channels : can't convert "+this.header.channel+" to "+d);var u=this.header.sampleRate,l=0|S.toFloat(a)/S.toFloat(u),_=0|d/this.header.channel,f=0,c=Math.floor(t/l);null!=this.totalSample&&c>this.totalSample-this.currentSample&&(c=this.totalSample-this.currentSample);for(var g=0,p;f<c;){p=this.channelBufferEnd-this.channelBufferStart,p>=c-f&&(p=c-f);for(var m=this.channelBufferStart,b=this.channelBufferStart+p;m<b;)for(var x=m++,y=0;y<l;)for(var w=y++,T=0,E=this.header.channel;T<E;)for(var C=T++,i=0;i<_;){var I=i++,v=this.channelBuffers[C][x];1<v?v=1:-1>v&&(v=-1),r&&(e[g]=v,++g)}if(f+=p,this.channelBufferStart+=p,f==c||0==this.getFrameFloat())break}for(var L=f,B=c;L<B;)for(var O=L++,N=0;N<l;)for(var A=N++,P=0,R=this.header.channel;P<R;)for(var V=P++,D=0,F;D<_;)F=D++,r&&(e[g]=0,++g);return this.currentSample+=c,c*l},skipSamples:function(e){var t=0;for(null!=this.totalSample&&e>this.totalSample-this.currentSample&&(e=this.totalSample-this.currentSample);t<e;){var i=this.channelBufferEnd-this.channelBufferStart;if(i>=e-t&&(i=e-t),t+=i,this.channelBufferStart+=i,t==e||0==this.getFrameFloat())break}return this.currentSample+=e,e},setupSampleNumber:function(e,t){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(e,t))},seek:function(e,t,n){if(this.currentSample!=n){if(null==this.totalSample&&(this.setupSampleNumber(e,t),0==this.totalSample))throw new W(new et(tt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));0>n&&(n=0);var i=this.decodeState.pFirst,d=this.decodeState.pLast;if(n>=d.lastDecodedSample&&(n=d.lastDecodedSample-1),n<i.lastDecodedSample)this.seekFrameFromPage(e,i.pageStart,0,n);else{for(var a=0;i.pageEnd<d.pageStart;){var r=i.pageEnd,s=d.afterPreviousPageStart,o=i.lastDecodedSample,u=d.lastDecodedSample;if(null==o||null==u)throw new W(new et(tt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));S.gt(s,r+4e3)&&(s-=4e3);var l=r+Math.floor(S.toFloat(s-r)/S.toFloat(u-o)*(n-o));if(4<=a){var _=r+(s-r>>>1);l=8<=a?_:S.gt(_,l)?l+(_-l>>>1):_+(l-_>>>1)}++a,e(this.decodeState.inputPosition=l);var f=this.decodeState.findPage(e,t);switch(f._hx_index){case 0:var c=f.last,g=f.end;break;case 1:throw new W(new et(tt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));}var p=this.decodeState.analyzePage(e,this.header);if(null==p)throw new W(new et(tt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));if(p.afterPreviousPageStart=l,p.pageStart==d.pageStart){d=p;continue}n<p.lastDecodedSample?d=p:i=p}if(i.lastDecodedSample<=n&&n<d.lastDecodedSample)this.seekFrameFromPage(e,d.pageStart,i.lastDecodedSample,n);else throw new W(new et(tt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}}},seekFrameFromPage:function(e,t,n,i){var d=0,a=n;e(this.decodeState.inputPosition=t),this.decodeState.nextSeg=-1;for(var r=0,s=0,o=null,u=null;;){o=u,u=this.decodeState.clone(e);var l=this.decodeInitial();if(null==l){u=o;break}s=l.left.start,r=l.left.end;var _=0==d?r:s;if(i<a+l.right.start-_)break;for(var f=this.decodeState;0!=f.bytesInSeg||!f.lastSeg&&0!=f.next();)f.bytesInSeg--,f.inputPosition+=1,f.input.readByte();a+=l.right.start-_,++d}this.decodeState=u,e(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=a,this.skipSamples(i-a)},clone:function(e){var t=Object.create(Me.prototype);t.currentSample=this.currentSample,t.totalSample=this.totalSample,t.previousLength=this.previousLength,t.channelBufferStart=this.channelBufferStart,t.channelBufferEnd=this.channelBufferEnd,t.a=this.a,t.b=this.b,t.c=this.c,t.window=this.window,t.bitReverseData=this.bitReverseData,t.header=this.header,t.decodeState=this.decodeState.clone(e);var n=Array(this.header.channel);t.channelBuffers=n;var d=Array(this.header.channel);t.previousWindow=d;var a=Array(this.header.channel);t.finalY=a;for(var r=0,s=this.header.channel;r<s;){var o=r++;t.channelBuffers[o]=He.copyVector(this.channelBuffers[o]),t.previousWindow[o]=He.copyVector(this.previousWindow[o]),t.finalY[o]=c.array(this.finalY[o])}return t},ensurePosition:function(e){e(this.decodeState.inputPosition)},getFrameFloat:function(){var e=this.decodePacket();if(null==e)return this.channelBufferStart=this.channelBufferEnd=0,0;var t=this.finishFrame(e);return this.channelBufferStart=e.left,this.channelBufferEnd=e.left+t,t},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(e){var t=e.len,d=e.right,a=e.left;if(0!=this.previousLength)for(var r=this.previousLength,n=this.getWindow(r),s=0,o=this.header.channel;s<o;)for(var u=s++,i=this.channelBuffers[u],l=this.previousWindow[u],_=0,f;_<r;)f=_++,i[a+f]=i[a+f]*n[f]+l[f]*n[r-1-f];var c=this.previousLength;this.previousLength=t-d;for(var g=0,p=this.header.channel;g<p;)for(var h=g++,m=this.previousWindow[h],b=this.channelBuffers[h],x=0,S=t-d,y;x<S;)y=x++,m[y]=b[d+y];return 0==c?0:(t<d&&(d=t),d-a)},getWindow:function(e){return e<<=1,e==this.header.blocksize0?this.window[0]:e==this.header.blocksize1?this.window[1]:null},initBlocksize:function(e,t){var n=t>>1,i=this.a,d=Array(n);i[e]=d;var a=this.b,r=Array(n);a[e]=r;var s=this.c,o=Array(t>>2);s[e]=o;var u=this.window,l=Array(n);u[e]=l;var _=this.bitReverseData,f=Array(t>>3);_[e]=f,He.computeTwiddleFactors(t,this.a[e],this.b[e],this.c[e]),He.computeWindow(t,this.window[e]),He.computeBitReverse(t,this.bitReverseData[e])},inverseMdct:function(e,t,n){for(var d=n?1:0,s=this.a[d],a=this.b[d],o=this.c[d],_=this.bitReverseData[d],f=t>>1,c=t>>2,g=t>>3,p=Array(f),h=p,m=f-2,b=0,x=0;x!=f;)h[m+1]=e[x]*s[b]-e[x+2]*s[b+1],h[m]=e[x]*s[b+1]+e[x+2]*s[b],m-=2,b+=2,x+=4;for(x=f-3;0<=m;)h[m+1]=-e[x+2]*s[b]- -e[x]*s[b+1],h[m]=-e[x+2]*s[b+1]+-e[x]*s[b],m-=2,b+=2,x-=4;for(var S=e,u=h,y=f-8,w=c,T=0,E=c,C=0;0<=y;){var I=u[w+1]-u[T+1],v=u[w]-u[T];S[E+1]=u[w+1]+u[T+1],S[E]=u[w]+u[T],S[C+1]=I*s[y+4]-v*s[y+5],S[C]=v*s[y+4]+I*s[y+5],I=u[w+3]-u[T+3],v=u[w+2]-u[T+2],S[E+3]=u[w+3]+u[T+3],S[E+2]=u[w+2]+u[T+2],S[C+3]=I*s[y]-v*s[y+1],S[C+2]=v*s[y]+I*s[y+1],y-=8,E+=4,C+=4,w+=4,T+=4}for(var k=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],L=(16384>t?16>t?k[t]:512>t?5+k[t>>5]:10+k[t>>10]:16777216>t?524288>t?15+k[t>>15]:20+k[t>>20]:536870912>t?25+k[t>>25]:-2147483648>t?30+k[t>>30]:0)-1,B=f-1-0*c,O=B,N=B+-(t>>3),A=0,P=(t>>4>>2)+1;0<--P;){var R=S[O]-S[N],V=S[O+-1]-S[N+-1],D=O;S[D]+=S[N];var F=O+-1;S[F]+=S[N+-1],S[N]=R*s[A]-V*s[A+1],S[N+-1]=V*s[A]+R*s[A+1],A+=8,R=S[O+-2]-S[N+-2],V=S[O+-3]-S[N+-3];var M=O+-2;S[M]+=S[N+-2];var H=O+-3;S[H]+=S[N+-3],S[N+-2]=R*s[A]-V*s[A+1],S[N+-3]=V*s[A]+R*s[A+1],A+=8,R=S[O+-4]-S[N+-4],V=S[O+-5]-S[N+-5];var W=O+-4;S[W]+=S[N+-4];var U=O+-5;S[U]+=S[N+-5],S[N+-4]=R*s[A]-V*s[A+1],S[N+-5]=V*s[A]+R*s[A+1],A+=8,R=S[O+-6]-S[N+-6],V=S[O+-7]-S[N+-7];var G=O+-6;S[G]+=S[N+-6];var z=O+-7;S[z]+=S[N+-7],S[N+-6]=R*s[A]-V*s[A+1],S[N+-7]=V*s[A]+R*s[A+1],A+=8,O-=8,N-=8}for(var X=f-1-c,Y=X,j=X+-(t>>3),Z=0,K=(t>>4>>2)+1;0<--K;){var q=S[Y]-S[j],Q=S[Y+-1]-S[j+-1],J=Y;S[J]+=S[j];var $=Y+-1;S[$]+=S[j+-1],S[j]=q*s[Z]-Q*s[Z+1],S[j+-1]=Q*s[Z]+q*s[Z+1],Z+=8,q=S[Y+-2]-S[j+-2],Q=S[Y+-3]-S[j+-3];var ee=Y+-2;S[ee]+=S[j+-2];var te=Y+-3;S[te]+=S[j+-3],S[j+-2]=q*s[Z]-Q*s[Z+1],S[j+-3]=Q*s[Z]+q*s[Z+1],Z+=8,q=S[Y+-4]-S[j+-4],Q=S[Y+-5]-S[j+-5];var ne=Y+-4;S[ne]+=S[j+-4];var ie=Y+-5;S[ie]+=S[j+-5],S[j+-4]=q*s[Z]-Q*s[Z+1],S[j+-5]=Q*s[Z]+q*s[Z+1],Z+=8,q=S[Y+-6]-S[j+-6],Q=S[Y+-7]-S[j+-7];var de=Y+-6;S[de]+=S[j+-6];var ae=Y+-7;S[ae]+=S[j+-7],S[j+-6]=q*s[Z]-Q*s[Z+1],S[j+-7]=Q*s[Z]+q*s[Z+1],Z+=8,Y-=8,j-=8}for(var re=f-1-0*g,se=0,oe=re,ue=re+-(t>>4),le=(t>>5>>2)+1;0<--le;){var _e=S[oe]-S[ue],fe=S[oe+-1]-S[ue+-1],ce=oe;S[ce]+=S[ue];var ge=oe+-1;S[ge]+=S[ue+-1],S[ue]=_e*s[se]-fe*s[se+1],S[ue+-1]=fe*s[se]+_e*s[se+1],se+=16,_e=S[oe+-2]-S[ue+-2],fe=S[oe+-3]-S[ue+-3];var pe=oe+-2;S[pe]+=S[ue+-2];var he=oe+-3;S[he]+=S[ue+-3],S[ue+-2]=_e*s[se]-fe*s[se+1],S[ue+-3]=fe*s[se]+_e*s[se+1],se+=16,_e=S[oe+-4]-S[ue+-4],fe=S[oe+-5]-S[ue+-5];var me=oe+-4;S[me]+=S[ue+-4];var be=oe+-5;S[be]+=S[ue+-5],S[ue+-4]=_e*s[se]-fe*s[se+1],S[ue+-5]=fe*s[se]+_e*s[se+1],se+=16,_e=S[oe+-6]-S[ue+-6],fe=S[oe+-7]-S[ue+-7];var xe=oe+-6;S[xe]+=S[ue+-6];var Se=oe+-7;S[Se]+=S[ue+-7],S[ue+-6]=_e*s[se]-fe*s[se+1],S[ue+-7]=fe*s[se]+_e*s[se+1],oe-=8,ue-=8,se+=16}for(var ye=f-1-g,we=0,Te=ye,Ee=ye+-(t>>4),Ce=(t>>5>>2)+1;0<--Ce;){var Ie=S[Te]-S[Ee],ve=S[Te+-1]-S[Ee+-1],ke=Te;S[ke]+=S[Ee];var Le=Te+-1;S[Le]+=S[Ee+-1],S[Ee]=Ie*s[we]-ve*s[we+1],S[Ee+-1]=ve*s[we]+Ie*s[we+1],we+=16,Ie=S[Te+-2]-S[Ee+-2],ve=S[Te+-3]-S[Ee+-3];var Be=Te+-2;S[Be]+=S[Ee+-2];var Oe=Te+-3;S[Oe]+=S[Ee+-3],S[Ee+-2]=Ie*s[we]-ve*s[we+1],S[Ee+-3]=ve*s[we]+Ie*s[we+1],we+=16,Ie=S[Te+-4]-S[Ee+-4],ve=S[Te+-5]-S[Ee+-5];var Ne=Te+-4;S[Ne]+=S[Ee+-4];var Ae=Te+-5;S[Ae]+=S[Ee+-5],S[Ee+-4]=Ie*s[we]-ve*s[we+1],S[Ee+-5]=ve*s[we]+Ie*s[we+1],we+=16,Ie=S[Te+-6]-S[Ee+-6],ve=S[Te+-7]-S[Ee+-7];var Pe=Te+-6;S[Pe]+=S[Ee+-6];var Re=Te+-7;S[Re]+=S[Ee+-7],S[Ee+-6]=Ie*s[we]-ve*s[we+1],S[Ee+-7]=ve*s[we]+Ie*s[we+1],Te-=8,Ee-=8,we+=16}for(var Ve=f-1-2*g,De=0,Fe=Ve,Me=Ve+-(t>>4),He=(t>>5>>2)+1;0<--He;){var We=S[Fe]-S[Me],Ue=S[Fe+-1]-S[Me+-1],Ge=Fe;S[Ge]+=S[Me];var ze=Fe+-1;S[ze]+=S[Me+-1],S[Me]=We*s[De]-Ue*s[De+1],S[Me+-1]=Ue*s[De]+We*s[De+1],De+=16,We=S[Fe+-2]-S[Me+-2],Ue=S[Fe+-3]-S[Me+-3];var Xe=Fe+-2;S[Xe]+=S[Me+-2];var Ye=Fe+-3;S[Ye]+=S[Me+-3],S[Me+-2]=We*s[De]-Ue*s[De+1],S[Me+-3]=Ue*s[De]+We*s[De+1],De+=16,We=S[Fe+-4]-S[Me+-4],Ue=S[Fe+-5]-S[Me+-5];var je=Fe+-4;S[je]+=S[Me+-4];var Ze=Fe+-5;S[Ze]+=S[Me+-5],S[Me+-4]=We*s[De]-Ue*s[De+1],S[Me+-5]=Ue*s[De]+We*s[De+1],De+=16,We=S[Fe+-6]-S[Me+-6],Ue=S[Fe+-7]-S[Me+-7];var Ke=Fe+-6;S[Ke]+=S[Me+-6];var qe=Fe+-7;S[qe]+=S[Me+-7],S[Me+-6]=We*s[De]-Ue*s[De+1],S[Me+-7]=Ue*s[De]+We*s[De+1],Fe-=8,Me-=8,De+=16}for(var Qe=f-1-3*g,Je=0,$e=Qe,et=Qe+-(t>>4),tt=(t>>5>>2)+1;0<--tt;){var nt=S[$e]-S[et],it=S[$e+-1]-S[et+-1],dt=$e;S[dt]+=S[et];var at=$e+-1;S[at]+=S[et+-1],S[et]=nt*s[Je]-it*s[Je+1],S[et+-1]=it*s[Je]+nt*s[Je+1],Je+=16,nt=S[$e+-2]-S[et+-2],it=S[$e+-3]-S[et+-3];var rt=$e+-2;S[rt]+=S[et+-2];var st=$e+-3;S[st]+=S[et+-3],S[et+-2]=nt*s[Je]-it*s[Je+1],S[et+-3]=it*s[Je]+nt*s[Je+1],Je+=16,nt=S[$e+-4]-S[et+-4],it=S[$e+-5]-S[et+-5];var ot=$e+-4;S[ot]+=S[et+-4];var ut=$e+-5;S[ut]+=S[et+-5],S[et+-4]=nt*s[Je]-it*s[Je+1],S[et+-5]=it*s[Je]+nt*s[Je+1],Je+=16,nt=S[$e+-6]-S[et+-6],it=S[$e+-7]-S[et+-7];var lt=$e+-6;S[lt]+=S[et+-6];var _t=$e+-7;S[_t]+=S[et+-7],S[et+-6]=nt*s[Je]-it*s[Je+1],S[et+-7]=it*s[Je]+nt*s[Je+1],$e-=8,et-=8,Je+=16}for(var ft=2;ft<L-3>>1;)for(var ct=ft++,l=t>>ct+2,gt=0;gt<1<<ct+1;)for(var pt=gt++,ht=f-1-l*pt,mt=1<<ct+3,bt=0,xt=ht,St=ht+-(l>>1),yt=(t>>ct+4>>2)+1;0<--yt;){var wt=S[xt]-S[St],Tt=S[xt+-1]-S[St+-1],Et=xt;S[Et]+=S[St];var Ct=xt+-1;S[Ct]+=S[St+-1],S[St]=wt*s[bt]-Tt*s[bt+1],S[St+-1]=Tt*s[bt]+wt*s[bt+1],bt+=mt,wt=S[xt+-2]-S[St+-2],Tt=S[xt+-3]-S[St+-3];var It=xt+-2;S[It]+=S[St+-2];var vt=xt+-3;S[vt]+=S[St+-3],S[St+-2]=wt*s[bt]-Tt*s[bt+1],S[St+-3]=Tt*s[bt]+wt*s[bt+1],bt+=mt,wt=S[xt+-4]-S[St+-4],Tt=S[xt+-5]-S[St+-5];var kt=xt+-4;S[kt]+=S[St+-4];var Lt=xt+-5;S[Lt]+=S[St+-5],S[St+-4]=wt*s[bt]-Tt*s[bt+1],S[St+-5]=Tt*s[bt]+wt*s[bt+1],bt+=mt,wt=S[xt+-6]-S[St+-6],Tt=S[xt+-7]-S[St+-7];var Bt=xt+-6;S[Bt]+=S[St+-6];var Ot=xt+-7;S[Ot]+=S[St+-7],S[St+-6]=wt*s[bt]-Tt*s[bt+1],S[St+-7]=Tt*s[bt]+wt*s[bt+1],xt-=8,St-=8,bt+=mt}for(var Nt=L-3>>1;Nt<L-6;)for(var At=Nt++,Pt=t>>At+2,Rt=1<<At+3,Vt=0,Dt=f-1,Ft=(t>>At+6)+1;0<--Ft;){for(var Mt=s[Vt],Ht=s[Vt+1],Wt=s[Vt+Rt],Ut=s[Vt+Rt+1],Gt=s[Vt+2*Rt],zt=s[Vt+2*Rt+1],Xt=s[Vt+3*Rt],Yt=s[Vt+3*Rt+1],jt=Dt,Zt=Dt+-(Pt>>1),Kt=(1<<At+1)+1;0<--Kt;){var qt=S[jt]-S[Zt],Qt=S[jt+-1]-S[Zt+-1];S[jt]+=S[Zt],S[jt+-1]=S[jt+-1]+S[Zt+-1],S[Zt]=qt*Mt-Qt*Ht,S[Zt+-1]=Qt*Mt+qt*Ht,qt=S[jt+-2]-S[Zt+-2],Qt=S[jt+-3]-S[Zt+-3],S[jt+-2]=S[jt+-2]+S[Zt+-2],S[jt+-3]=S[jt+-3]+S[Zt+-3],S[Zt+-2]=qt*Wt-Qt*Ut,S[Zt+-3]=Qt*Wt+qt*Ut,qt=S[jt+-4]-S[Zt+-4],Qt=S[jt+-5]-S[Zt+-5],S[jt+-4]=S[jt+-4]+S[Zt+-4],S[jt+-5]=S[jt+-5]+S[Zt+-5],S[Zt+-4]=qt*Gt-Qt*zt,S[Zt+-5]=Qt*Gt+qt*zt,qt=S[jt+-6]-S[Zt+-6],Qt=S[jt+-7]-S[Zt+-7],S[jt+-6]=S[jt+-6]+S[Zt+-6],S[jt+-7]=S[jt+-7]+S[Zt+-7],S[Zt+-6]=qt*Xt-Qt*Yt,S[Zt+-7]=Qt*Xt+qt*Yt,jt-=Pt,Zt-=Pt}Vt+=4*Rt,Dt-=8}for(var Jt=f-1,$t=s[t>>3],en=Jt;en>Jt-16*(t>>5);){var tn=S[en],nn=S[en+-8];S[en+-8]=tn-nn,S[en]=tn+nn,tn=S[en+-1],nn=S[en+-9],S[en+-9]=tn-nn,S[en+-1]=tn+nn,tn=S[en+-2],nn=S[en+-10];var dn=tn-nn;S[en+-2]=tn+nn,tn=S[en+-3],nn=S[en+-11];var an=tn-nn;S[en+-3]=tn+nn,S[en+-10]=(dn+an)*$t,S[en+-11]=(an-dn)*$t,tn=S[en+-4],nn=S[en+-12],dn=nn-tn,S[en+-4]=tn+nn,tn=S[en+-5],nn=S[en+-13],an=tn-nn,S[en+-5]=tn+nn,S[en+-12]=an,S[en+-13]=dn,tn=S[en+-6],nn=S[en+-14],dn=nn-tn,S[en+-6]=tn+nn,tn=S[en+-7],nn=S[en+-15],an=tn-nn,S[en+-7]=tn+nn,S[en+-14]=(dn+an)*$t,S[en+-15]=(dn-an)*$t;var rn=S[en],sn=S[en+-4],on=rn-sn,un=rn+sn;rn=S[en+-2],sn=S[en+-6];var ln=rn+sn,_n=rn-sn;S[en]=un+ln,S[en+-2]=un-ln;var fn=S[en+-3]-S[en+-7];S[en+-4]=on+fn,S[en+-6]=on-fn,rn=S[en+-1],sn=S[en+-5];var cn=rn-sn,gn=rn+sn,pn=S[en+-3]+S[en+-7];S[en+-1]=gn+pn,S[en+-3]=gn-pn,S[en+-5]=cn-_n,S[en+-7]=cn+_n;var hn=en-8,mn=S[hn],bn=S[hn+-4],xn=mn-bn,Sn=mn+bn;mn=S[hn+-2],bn=S[hn+-6];var yn=mn+bn,wn=mn-bn;S[hn]=Sn+yn,S[hn+-2]=Sn-yn;var Tn=S[hn+-3]-S[hn+-7];S[hn+-4]=xn+Tn,S[hn+-6]=xn-Tn,mn=S[hn+-1],bn=S[hn+-5];var En=mn-bn,Cn=mn+bn,In=S[hn+-3]+S[hn+-7];S[hn+-1]=Cn+In,S[hn+-3]=Cn-In,S[hn+-5]=En-wn,S[hn+-7]=En+wn,en-=16}for(var vn=0,kn=c-4,Ln=f-4;0<=kn;){var Bn=_[vn];u[Ln+3]=S[Bn],u[Ln+2]=S[Bn+1],u[kn+3]=S[Bn+2],u[kn+2]=S[Bn+3],Bn=_[vn+1],u[Ln+1]=S[Bn],u[Ln]=S[Bn+1],u[kn+1]=S[Bn+2],u[kn]=S[Bn+3],kn-=4,Ln-=4,vn+=2}for(var On=0,Nn=0,An=f-4;Nn<An;){var Pn=u[Nn]-u[An+2],Rn=u[Nn+1]+u[An+3],Vn=o[On+1]*Pn+o[On]*Rn,Dn=o[On+1]*Rn-o[On]*Pn,Fn=u[Nn]+u[An+2],Mn=u[Nn+1]-u[An+3];u[Nn]=Fn+Vn,u[Nn+1]=Mn+Dn,u[An+2]=Fn-Vn,u[An+3]=Dn-Mn,Pn=u[Nn+2]-u[An],Rn=u[Nn+3]+u[An+1],Vn=o[On+3]*Pn+o[On+2]*Rn,Dn=o[On+3]*Rn-o[On+2]*Pn,Fn=u[Nn+2]+u[An],Mn=u[Nn+3]-u[An+1],u[Nn+2]=Fn+Vn,u[Nn+3]=Mn+Dn,u[An]=Fn-Vn,u[An+1]=Dn-Mn,On+=4,Nn+=4,An-=4}for(var Hn=f-8,Wn=f-8,Un=0,Gn=f-4,zn=f,Xn=t-4;0<=Wn;){var Yn=h[Wn+6]*a[Hn+7]-h[Wn+7]*a[Hn+6],jn=-h[Wn+6]*a[Hn+6]-h[Wn+7]*a[Hn+7];e[Un]=Yn,e[Gn+3]=-Yn,e[zn]=jn,e[Xn+3]=jn;var Zn=h[Wn+4]*a[Hn+5]-h[Wn+5]*a[Hn+4],Kn=-h[Wn+4]*a[Hn+4]-h[Wn+5]*a[Hn+5];e[Un+1]=Zn,e[Gn+2]=-Zn,e[zn+1]=Kn,e[Xn+2]=Kn,Yn=h[Wn+2]*a[Hn+3]-h[Wn+3]*a[Hn+2],jn=-h[Wn+2]*a[Hn+2]-h[Wn+3]*a[Hn+3],e[Un+2]=Yn,e[Gn+1]=-Yn,e[zn+2]=jn,e[Xn+1]=jn,Zn=h[Wn]*a[Hn+1]-h[Wn+1]*a[Hn],Kn=-h[Wn]*a[Hn]-h[Wn+1]*a[Hn+1],e[Un+3]=Zn,e[Gn]=-Zn,e[zn+3]=Kn,e[Xn]=Kn,Hn-=8,Wn-=8,Un+=4,zn+=4,Gn-=4,Xn-=4}},decodePacket:function(){var e=this.decodeInitial();if(null==e)return null;var t=this.decodePacketRest(e);return t},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;if(0!=this.decodeState.readBits(1)){for(;;){var e=this.decodeState,t;if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())?t=-1:(e.bytesInSeg--,e.inputPosition+=1,t=e.input.readByte()),e.validBits=0,-1==t)break}continue}break}var d=this.header.modes.length-1,n=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],a=this.decodeState.readBits(16384>d?16>d?n[d]:512>d?5+n[d>>5]:10+n[d>>10]:16777216>d?524288>d?15+n[d>>15]:20+n[d>>20]:536870912>d?25+n[d>>25]:-2147483648>d?30+n[d>>30]:0);if(-1==a||a>=this.header.modes.length)throw new W(new et(tt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var i=this.header.modes[a],r,s,o;i.blockflag?(r=this.header.blocksize1,s=this.decodeState.readBits(1),o=this.decodeState.readBits(1)):(o=0,s=o,r=this.header.blocksize0);var u=r>>1;return{mode:a,left:i.blockflag&&0==s?{start:r-this.header.blocksize0>>2,end:r+this.header.blocksize0>>2}:{start:0,end:u},right:i.blockflag&&0==o?{start:3*r-this.header.blocksize0>>2,end:3*r+this.header.blocksize0>>2}:{start:u,end:r}}},decodePacketRest:function(e){for(var t=this.header.modes[e.mode],d=Array(256),r=d,o=Array(256),u=o,_=t.blockflag?this.header.blocksize1:this.header.blocksize0,n=this.header.mapping[t.mapping],f=_>>1,p=[256,128,86,64],h=this.header.codebooks,m=0,b=this.header.channel;m<b;){var x=m++,i=n.chan[x].mux;r[x]=!1;var s=this.header.floorConfig[n.submapFloor[i]];if(0==s.type)throw new W(new et(tt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));else{var S=s.floor1;if(0!=this.decodeState.readBits(1)){var g=[],y=Array(256),w=y,T=p[S.floor1Multiplier-1],E=2;g=this.finalY[x];var C=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];g[0]=this.decodeState.readBits((16384>T?16>T?C[T]:512>T?5+C[T>>5]:10+C[T>>10]:16777216>T?524288>T?15+C[T>>15]:20+C[T>>20]:536870912>T?25+C[T>>25]:-2147483648>T?30+C[T>>30]:0)-1);var I=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];g[1]=this.decodeState.readBits((16384>T?16>T?I[T]:512>T?5+I[T>>5]:10+I[T>>10]:16777216>T?524288>T?15+I[T>>15]:20+I[T>>20]:536870912>T?25+I[T>>25]:-2147483648>T?30+I[T>>30]:0)-1);for(var v=0,L=S.partitions;v<L;){var B=v++,O=S.partitionClassList[B],N=S.classDimensions[O],A=S.classSubclasses[O],P=0;if(0!=A){var R=h[S.classMasterbooks[O]],c=this.decodeState;10>c.validBits&&c.prepHuffman();var V=R.fastHuffman[1023&c.acc],D;if(0<=V){var F=R.codewordLengths[V];c.acc>>>=F,c.validBits-=F,0>c.validBits?(c.validBits=0,D=-1):D=V}else D=c.decodeScalarRaw(R);R.sparse&&(D=R.sortedValues[D]),P=D}for(var l=S.subclassBooks[O],M=0;M<N;){var H=M++,k=l[P&(1<<A)-1];P>>=A;var U=E++,G;if(0<=k){var z=this.decodeState,X=h[k];10>z.validBits&&z.prepHuffman();var Y=X.fastHuffman[1023&z.acc],j;if(0<=Y){var Z=X.codewordLengths[Y];z.acc>>>=Z,z.validBits-=Z,0>z.validBits?(z.validBits=0,j=-1):j=Y}else j=z.decodeScalarRaw(X);X.sparse&&(j=X.sortedValues[j]),G=j}else G=0;g[U]=G}}if(-1==this.decodeState.validBits){r[x]=!0;continue}w[0]=w[1]=!0;for(var K=S.neighbors,q=S.xlist,Q=2,J=S.values;Q<J;){var $=Q++,ee=K[$][0],te=K[$][1],ne=q[ee],ie=g[ee],de=g[te]-ie,ae=q[te]-ne,re=Math.abs(de)*(q[$]-ne),se=0|re/ae,oe=0>de?ie-se:ie+se,ue=g[$],le=T-oe,_e=le<oe?2*le:2*oe;0==ue?(w[$]=!1,g[$]=oe):(w[ee]=w[te]=!0,w[$]=!0,g[$]=ue>=_e?le>oe?ue-oe+oe:oe-ue+le-1:0==(1&ue)?oe+(ue>>1):oe-(ue+1>>1))}for(var fe=0,ce=S.values;fe<ce;){var ge=fe++;w[ge]||(g[ge]=-1)}}else r[x]=!0}}for(var pe=0,he=this.header.channel;pe<he;){var me=pe++;u[me]=r[me]}for(var be=0,xe=n.couplingSteps;be<xe;){var Se=be++;r[n.chan[Se].magnitude]&&r[n.chan[Se].angle]||(r[n.chan[Se].magnitude]=r[n.chan[Se].angle]=!1)}for(var ye=0,we=n.submaps;ye<we;){for(var Te=ye++,Ee=Array(this.header.channel),Ce=Ee,Ie=Array(256),ve=Ie,ke=0,Le=0,Be=this.header.channel;Le<Be;){var Oe=Le++;n.chan[Oe].mux==Te&&(r[Oe]?(ve[ke]=!0,Ce[ke]=null):(ve[ke]=!1,Ce[ke]=this.channelBuffers[Oe]),++ke)}var Ne=n.submapResidue[Te],Ae=this.header.residueConfig[Ne];Ae.decode(this.decodeState,this.header,Ce,ke,f,ve,this.channelBuffers)}for(var Pe=n.couplingSteps,Re=_>>1;0<=--Pe;)for(var Ve=this.channelBuffers[n.chan[Pe].magnitude],De=this.channelBuffers[n.chan[Pe].angle],a=0;a<Re;){var Fe=a++,Me,He;0<Ve[Fe]?0<De[Fe]?(He=Ve[Fe],Me=Ve[Fe]-De[Fe]):(Me=Ve[Fe],He=Ve[Fe]+De[Fe]):0<De[Fe]?(He=Ve[Fe],Me=Ve[Fe]+De[Fe]):(Me=Ve[Fe],He=Ve[Fe]-De[Fe]),Ve[Fe]=He,De[Fe]=Me}for(var We=0,Ue=this.header.channel;We<Ue;){var Ge=We++;if(u[Ge])for(var ze=0,Xe;ze<Re;)Xe=ze++,this.channelBuffers[Ge][Xe]=0;else n.doFloor(this.header.floorConfig,Ge,_,this.channelBuffers[Ge],this.finalY[Ge],null)}for(var Ye=0,je=this.header.channel;Ye<je;){var Ze=Ye++;this.inverseMdct(this.channelBuffers[Ze],_,t.blockflag)}for(var Ke=this.decodeState;0!=Ke.bytesInSeg||!Ke.lastSeg&&0!=Ke.next();)Ke.bytesInSeg--,Ke.inputPosition+=1,Ke.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,_,e)},__class__:Me};var He=function(){};s["kha.audio2.ogg.vorbis.VorbisTools"]=He,He.__name__=!0,He.assert=function(){},He.neighbors=function(e,t){for(var n=-1,d=65536,a=0,r=0,s=0;s<t;){var o=s++;e[o]>n&&e[o]<e[t]&&(a=o,n=e[o]),e[o]<d&&e[o]>e[t]&&(r=o,d=e[o])}return{low:a,high:r}},He.floatUnpack=function(e){var t=S.toFloat(2097151&e),n=0==(-2147483648&e)?t:-t;return n*Math.pow(2,((2145386496&e)>>>21)-788)},He.bitReverse=function(e){return e=(-1431655766&e)>>>1|(1431655765&e)<<1,e=(-858993460&e)>>>2|(858993459&e)<<2,e=(-252645136&e)>>>4|(252645135&e)<<4,e=(-16711936&e)>>>8|(16711935&e)<<8,e>>>16|e<<16},He.pointCompare=function(e,t){return e.x<t.x?-1:e.x>t.x?1:0},He.uintAsc=function(e,t){return S.gt(t,e)?-1:e==t?0:1},He.lookup1Values=function(e,t){var n=0|Math.exp(Math.log(e)/t);return(0|Math.pow(n+1,t))<=e&&++n,n},He.computeWindow=function(e,t){for(var n=e>>1,d=0;d<n;){var a=d++;t[a]=Math.sin(1.5707963267948966*He.square(Math.sin(3.141592653589793*(.5*((a+.5)/n)))))}},He.square=function(e){return e*e},He.computeBitReverse=function(e,t){for(var n=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],d=(16384>e?16>e?n[e]:512>e?5+n[e>>5]:10+n[e>>10]:16777216>e?524288>e?15+n[e>>15]:20+n[e>>20]:536870912>e?25+n[e>>25]:-2147483648>e?30+n[e>>30]:0)-1,a=0;a<e>>3;){var r=a++,i=r;i=(-1431655766&i)>>>1|(1431655765&i)<<1,i=(-858993460&i)>>>2|(858993459&i)<<2,i=(-252645136&i)>>>4|(252645135&i)<<4,i=(-16711936&i)>>>8|(16711935&i)<<8,t[r]=(i>>>16|i<<16)>>>32-d+3<<2}},He.computeTwiddleFactors=function(e,t,n,i){for(var d=e>>3,a=0,r=0;r<e>>2;){var s=r++;t[a]=Math.cos(3.141592653589793*(4*s)/e),t[a+1]=-Math.sin(3.141592653589793*(4*s)/e),n[a]=.5*Math.cos(3.141592653589793*(a+1)/e/2),n[a+1]=.5*Math.sin(3.141592653589793*(a+1)/e/2),a+=2}for(var o=0,u=0;u<d;){u++;i[o]=Math.cos(3.141592653589793*(2*(o+1))/e),i[o+1]=-Math.sin(3.141592653589793*(2*(o+1))/e),o+=2}},He.drawLine=function(e,t,d,a,r,s){if(null==He.integerDivideTable){var n=Array(32);He.integerDivideTable=n;for(var o=0;32>o;){var u=o++,i=He.integerDivideTable,l=Array(64);i[u]=l;for(var _=1;64>_;){var f=_++;He.integerDivideTable[u][f]=0|u/f}}}var c=r-d,g=a-t,p=0>c?-c:c,h=t,m=d,b=0,x,S;64>g&&32>p?0>c?(x=-He.integerDivideTable[p][g],S=x-1):(x=He.integerDivideTable[p][g],S=x+1):(x=0|c/g,S=0>c?x-1:x+1),p-=(0>x?-x:x)*g,a>s&&(a=s);e[h]*=He.INVERSE_DB_TABLE[m];for(var w=h+1,T=a;w<T;){var E=w++;b+=p,b>=g?(b-=g,m+=S):m+=x;e[E]*=He.INVERSE_DB_TABLE[m]}},He.predictPoint=function(e,t,n,i,d){var a=d-i,r=Math.abs(a)*(e-t),s=0|r/(n-t);return 0>a?i-s:i+s},He.emptyFloatVector=function(e){var t=Array(e);return t},He.copyVector=function(e){for(var t=Array(e.length),n=t,d=0,a=e.length;d<a;){var r=d++;n[r]=e[r]}return n};var We=function(){};s["kha.audio2.ogg.vorbis.data.Codebook"]=We,We.__name__=!0,We.read=function(e){var t=new We;if(66!=e.readBits(8)||67!=e.readBits(8)||86!=e.readBits(8))throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));var d=e.readBits(8);t.dimensions=(e.readBits(8)<<8)+d;var a=e.readBits(8),r=e.readBits(8);t.entries=(e.readBits(8)<<16)+(r<<8)+a;var s=e.readBits(1);t.sparse=0==s&&0!=e.readBits(1);var o=Array(t.entries),u=o;t.sparse||(t.codewordLengths=u);var _=0;if(0!=s)for(var f=0,c=e.readBits(5)+1;f<t.entries;){var g=t.entries-f,p=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],h=e.readBits(16384>g?16>g?p[g]:512>g?5+p[g>>5]:10+p[g>>10]:16777216>g?524288>g?15+p[g>>15]:20+p[g>>20]:536870912>g?25+p[g>>25]:-2147483648>g?30+p[g>>30]:0);if(f+h>t.entries)throw new W(new et(tt.INVALID_SETUP,"codebook entrys",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var n=0,m;n<h;)m=n++,u[f+m]=c;f+=h,++c}else for(var b=0,x=t.entries;b<x;){var y=b++,w=t.sparse?e.readBits(1):1;0==w?u[y]=255:(u[y]=e.readBits(5)+1,++_)}t.sparse&&_>=t.entries>>2&&(t.codewordLengths=u,t.sparse=!1);var T;if(t.sparse)T=_;else{for(var E=0,C=0,I=t.entries;C<I;){var v=C++,k=u[v];10<k&&255!=k&&++E}T=E}t.sortedEntries=T;var l=null;if(!t.sparse){var L=Array(t.entries);t.codewords=L}else{if(0!=t.sortedEntries){var B=Array(t.sortedEntries);t.codewordLengths=B;var O=Array(t.entries);t.codewords=O;var N=Array(t.entries);l=N}t.entries+64*t.sortedEntries}if(!t.computeCodewords(u,t.entries,l))throw new W(new et(tt.INVALID_SETUP,"compute codewords",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=t.sortedEntries){t.sortedCodewords=[];var A=Array(t.sortedEntries);t.sortedValues=A,t.computeSortedHuffman(u,l)}if(t.sparse&&(l=null,t.codewords=null,u=null),t.computeAcceleratedHuffman(),t.lookupType=e.readBits(4),2<t.lookupType)throw new W(new et(tt.INVALID_SETUP,"codebook lookup type",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0<t.lookupType){var P=e.readBits(32),R=S.toFloat(2097151&P),V=0==(-2147483648&P)?R:-R;t.minimumValue=V*Math.pow(2,((2145386496&P)>>>21)-788);var D=e.readBits(32),F=S.toFloat(2097151&D),M=0==(-2147483648&D)?F:-F;t.deltaValue=M*Math.pow(2,((2145386496&D)>>>21)-788),t.valueBits=e.readBits(4)+1,t.sequenceP=0!=e.readBits(1),t.lookupValues=1==t.lookupType?He.lookup1Values(t.entries,t.dimensions):t.entries*t.dimensions;for(var H=Array(t.lookupValues),U=H,G=0,z=t.lookupValues;G<z;){var X=G++,Y=e.readBits(t.valueBits);if(-1==Y)throw new W(new et(tt.INVALID_SETUP,"fail lookup",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));U[X]=Y}var j=Array(t.lookupValues);t.multiplicands=j;for(var Z=0,K=t.lookupValues,q;Z<K;)q=Z++,t.multiplicands[q]=U[q]*t.deltaValue+t.minimumValue;if(2==t.lookupType&&t.sequenceP){for(var Q=1,J=t.lookupValues,$;Q<J;)$=Q++,t.multiplicands[$]=t.multiplicands[$-1];t.sequenceP=!1}}return t},We.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,addEntry:function(e,t,n,i,d){this.sparse?(this.codewords[n]=e,this.codewordLengths[n]=i,d[n]=t):this.codewords[t]=e},includeInSort:function(e){return!!this.sparse||255!=e&&!!(10<e)},computeCodewords:function(e,t,n){var d=Array(32),a=d;a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=0,a[16]=0,a[17]=0,a[18]=0,a[19]=0,a[20]=0,a[21]=0,a[22]=0,a[23]=0,a[24]=0,a[25]=0,a[26]=0,a[27]=0,a[28]=0,a[29]=0,a[30]=0,a[31]=0;for(var r=0;r<t&&!(255>e[r]);)++r;if(r==t)return!0;var s=0,o=s++;this.sparse?(this.codewords[o]=0,this.codewordLengths[o]=e[r],n[o]=r):this.codewords[r]=0;for(var u=0;++u<=e[r];)a[u]=1<<32-u;for(u=r;++u<t;){var l=e[u];if(255!=l){for(;0<l&&0==a[l];)--l;if(0==l)return!1;var _=a[l];a[l]=0;var f=_;f=(-1431655766&f)>>>1|(1431655765&f)<<1,f=(-858993460&f)>>>2|(858993459&f)<<2,f=(-252645136&f)>>>4|(252645135&f)<<4,f=(-16711936&f)>>>8|(16711935&f)<<8;var c=f>>>16|f<<16,g=s++;if(this.sparse?(this.codewords[g]=c,this.codewordLengths[g]=e[u],n[g]=u):this.codewords[u]=c,l!=e[u])for(var p=e[u];p>l;)a[p]=_+(1<<32-p),--p}}return!0},computeSortedHuffman:function(e,t){if(!this.sparse)for(var d=0,a=0,r=this.entries;a<r;){var s=a++,i=e[s];if(!!this.sparse||255!=i&&10<i){var o=this.codewords[s];o=(-1431655766&o)>>>1|(1431655765&o)<<1,o=(-858993460&o)>>>2|(858993459&o)<<2,o=(-252645136&o)>>>4|(252645135&o)<<4,o=(-16711936&o)>>>8|(16711935&o)<<8,this.sortedCodewords[d++]=o>>>16|o<<16}}else for(var u=0,l=this.sortedEntries;u<l;){var _=u++,f=this.codewords[_];f=(-1431655766&f)>>>1|(1431655765&f)<<1,f=(-858993460&f)>>>2|(858993459&f)<<2,f=(-252645136&f)>>>4|(252645135&f)<<4,f=(-16711936&f)>>>8|(16711935&f)<<8,this.sortedCodewords[_]=f>>>16|f<<16}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(He.uintAsc);for(var c=this.sparse?this.sortedEntries:this.entries,g=0;g<c;){var p=g++,h=this.sparse?e[t[p]]:e[p];if(!!this.sparse||255!=h&&10<h){var b=this.codewords[p];b=(-1431655766&b)>>>1|(1431655765&b)<<1,b=(-858993460&b)>>>2|(858993459&b)<<2,b=(-252645136&b)>>>4|(252645135&b)<<4,b=(-16711936&b)>>>8|(16711935&b)<<8;for(var y=b>>>16|b<<16,w=0,T=this.sortedEntries;1<T;){var E=w+(T>>1);S.gte(y,this.sortedCodewords[E])?(w=E,T-=T>>1):T>>=1}this.sparse?(this.sortedValues[w]=t[p],this.codewordLengths[w]=h):this.sortedValues[w]=p}}},computeAcceleratedHuffman:function(){var e=Array(1024);this.fastHuffman=e,this.fastHuffman[0]=-1;for(var t=0;t<1024;){var d=t++;this.fastHuffman[d]=-1}for(var i=this.sparse?this.sortedEntries:this.entries,a=0;a<i;){var r=a++;if(10>=this.codewordLengths[r]){var s;if(this.sparse){var o=this.sortedCodewords[r];o=(-1431655766&o)>>>1|(1431655765&o)<<1,o=(-858993460&o)>>>2|(858993459&o)<<2,o=(-252645136&o)>>>4|(252645135&o)<<4,o=(-16711936&o)>>>8|(16711935&o)<<8,s=o>>>16|o<<16}else s=this.codewords[r];for(;1024>s;)this.fastHuffman[s]=r,s+=1<<this.codewordLengths[r]}}},codebookDecode:function(e,t,n,d){10>e.validBits&&e.prepHuffman();var a=this.fastHuffman[1023&e.acc],i;if(0<=a){var r=this.codewordLengths[a];e.acc>>>=r,e.validBits-=r,0>e.validBits?(e.validBits=0,i=-1):i=a}else i=e.decodeScalarRaw(this);this.sparse&&(i=this.sortedValues[i]);var s=i,o=this.lookupValues,u=this.sequenceP,l=this.multiplicands,_=this.minimumValue;if(0>s)return!1;if(d>this.dimensions&&(d=this.dimensions),1==this.lookupType){for(var f=1,c=0,g=0,p=d;g<p;){var h=g++,m=0|S.toFloat(0|s/f)%S.toFloat(o),b=l[m]+c;t[n+h]+=b,u&&(c=b+_),f*=o}return!0}if(s*=this.dimensions,u)for(var x=0,y=0,w=d;y<w;){var T=y++,E=l[s+T]+x;t[n+T]+=E,x=E+_}else for(var C=0,I=d;C<I;){var v=C++;t[n+v]+=l[s+v]+0}return!0},codebookDecodeStep:function(e,t,n,d,a){10>e.validBits&&e.prepHuffman();var r=this.fastHuffman[1023&e.acc],i;if(0<=r){var s=this.codewordLengths[r];e.acc>>>=s,e.validBits-=s,0>e.validBits?(e.validBits=0,i=-1):i=r}else i=e.decodeScalarRaw(this);this.sparse&&(i=this.sortedValues[i]);var o=i,u=0;if(0>o)return!1;d>this.dimensions&&(d=this.dimensions);var l=this.lookupValues,_=this.sequenceP,f=this.multiplicands;if(1==this.lookupType){for(var c=1,g=0,p=d;g<p;){var h=g++,m=0|S.toFloat(0|o/c)%S.toFloat(l),b=f[m]+u;t[n+h*a]+=b,_&&(u=b),c*=l}return!0}o*=this.dimensions;for(var x=0,y=d;x<y;){var w=x++,T=f[o+w]+u;t[n+w*a]+=T,_&&(u=T)}return!0},decodeStart:function(e){10>e.validBits&&e.prepHuffman();var t=this.fastHuffman[1023&e.acc],n;if(0<=t){var i=this.codewordLengths[t];e.acc>>>=i,e.validBits-=i,0>e.validBits?(e.validBits=0,n=-1):n=t}else n=e.decodeScalarRaw(this);return this.sparse&&(n=this.sortedValues[n]),n},decodeDeinterleaveRepeat:function(e,t,n,d,a,r,s){var o=this.dimensions;if(0==this.lookupType)throw new W(new et(tt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var u=this.multiplicands,_=this.sequenceP,f=this.lookupValues,c;0<s;){c=0,10>e.validBits&&e.prepHuffman();var g=this.fastHuffman[1023&e.acc],i;if(0<=g){var p=this.codewordLengths[g];e.acc>>>=p,e.validBits-=p,0>e.validBits?(e.validBits=0,i=-1):i=g}else i=e.decodeScalarRaw(this);this.sparse&&(i=this.sortedValues[i]);var l=i;if(0>l){if(0==e.bytesInSeg&&e.lastSeg)return null;throw new W(new et(tt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(d+a*n+o>r*n&&(o=r*n-(a*n-d)),1==this.lookupType){var h=1;if(_)for(var m=0,b=o;m<b;){var x=m++,y=0|S.toFloat(0|l/h)%S.toFloat(f),w=u[y]+c,T=a,E=t[d];E[T]+=w,++d==n&&(d=0,++a),c=w,h*=f}else for(var C=0,I=o;C<I;){var v=C++,k=0|S.toFloat(0|l/h)%S.toFloat(f),L=u[k]+c,B=a,O=t[d];O[B]+=L,++d==n&&(d=0,++a),h*=f}}else if(l*=this.dimensions,_)for(var N=0,A=o;N<A;){var P=N++,R=u[l+P]+c,V=a,D=t[d];D[V]+=R,++d==n&&(d=0,++a),c=R}else for(var F=0,M=o;F<M;){var H=F++,U=u[l+H]+c,G=a,X=t[d];X[G]+=U,++d==n&&(d=0,++a)}s-=o}return{cInter:d,pInter:a}},residueDecode:function(e,t,i,d,n){if(0==n){for(var a=0|d/this.dimensions,r=0,s;r<a;)if(s=r++,!this.codebookDecodeStep(e,t,i+s,d-i-s,a))return!1;}else for(var o=0;o<d;){if(!this.codebookDecode(e,t,i,d-o))return!1;o+=this.dimensions,i+=this.dimensions}return!0},__class__:We};var Ue=function(){this.data=new L};s["kha.audio2.ogg.vorbis.data.Comment"]=Ue,Ue.__name__=!0,Ue.prototype={data:null,get_title:function(){return this.getString("title")},get_loopStart:function(){return h.parseInt(this.getString("loopstart"))},get_loopLength:function(){return h.parseInt(this.getString("looplength"))},get_version:function(){return this.getString("version")},get_album:function(){return this.getString("album")},get_organization:function(){return this.getString("organization")},get_tracknumber:function(){return this.getString("tracknumber")},get_performer:function(){return this.getString("performer")},get_copyright:function(){return this.getString("copyright")},get_license:function(){return this.getString("license")},get_artist:function(){return this.getString("artist")},get_description:function(){return this.getString("description")},get_genre:function(){return this.getString("genre")},get_date:function(){return this.getString("date")},get_location:function(){return this.getString("location")},get_contact:function(){return this.getString("contact")},get_isrc:function(){return this.getString("isrc")},get_artists:function(){return this.getArray("artist")},add:function(e,t){e=e.toLowerCase();var n=this.data;if(null==Vn[e]?n.h.hasOwnProperty(e):n.existsReserved(e)){var i=this.data;(null==Vn[e]?i.h[e]:i.getReserved(e)).push(t)}else{var d=[t],a=this.data;null==Vn[e]?a.h[e]=d:a.setReserved(e,d)}},getString:function(e){e=e.toLowerCase();var t=this.data;if(null==Vn[e]?t.h.hasOwnProperty(e):t.existsReserved(e)){var n=this.data;return(null==Vn[e]?n.h[e]:n.getReserved(e))[0]}return null},getArray:function(e){e=e.toLowerCase();var t=this.data;if(null==Vn[e]?t.h.hasOwnProperty(e):t.existsReserved(e)){var n=this.data;return null==Vn[e]?n.h[e]:n.getReserved(e)}return null},__class__:Ue};var Ge=function(){};s["kha.audio2.ogg.vorbis.data.Floor"]=Ge,Ge.__name__=!0,Ge.read=function(e,t){var n=new Ge;if(n.type=e.readBits(16),1<n.type)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==n.type){var d=n.floor0=new ze;d.order=e.readBits(8),d.rate=e.readBits(16),d.barkMapSize=e.readBits(16),d.amplitudeBits=e.readBits(6),d.amplitudeOffset=e.readBits(8),d.numberOfBooks=e.readBits(4)+1;for(var a=0,r=d.numberOfBooks,s;a<r;)s=a++,d.bookList[s]=e.readBits(8);throw new W(new et(tt.FEATURE_NOT_SUPPORTED,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}else{var o=[],u=n.floor1=new Xe,l=-1;u.partitions=e.readBits(5);var _=Array(u.partitions);u.partitionClassList=_;for(var f=0,g=u.partitions,p;f<g;)p=f++,u.partitionClassList[p]=e.readBits(4),u.partitionClassList[p]>l&&(l=u.partitionClassList[p]);var h=Array(l+1);u.classDimensions=h;var m=Array(l+1);u.classMasterbooks=m;var b=Array(l+1);u.classSubclasses=b;var S=Array(l+1);u.subclassBooks=S;for(var y=0,w=l+1,T;y<w;){if(T=y++,u.classDimensions[T]=e.readBits(3)+1,u.classSubclasses[T]=e.readBits(2),0!=u.classSubclasses[T]&&(u.classMasterbooks[T]=e.readBits(8),u.classMasterbooks[T]>=t.length))throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));var E=1<<u.classSubclasses[T],C=u.subclassBooks,I=Array(E);C[T]=I;for(var v=0,L;v<E;)if(L=v++,u.subclassBooks[T][L]=e.readBits(8)-1,u.subclassBooks[T][L]>=t.length)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}u.floor1Multiplier=e.readBits(2)+1,u.rangebits=e.readBits(4);var B=Array(250);u.xlist=B,u.xlist[0]=0,u.xlist[1]=1<<u.rangebits,u.values=2;for(var O=0,N=u.partitions;O<N;)for(var A=O++,P=u.partitionClassList[A],c=0,R=u.classDimensions[P],V;c<R;)V=c++,u.xlist[u.values]=e.readBits(u.rangebits),u.values++;for(var D=0,F=u.values,M;D<F;)M=D++,o.push(new je),o[M].x=u.xlist[M],o[M].y=M;o.sort(He.pointCompare);var H=Array(u.values);u.sortedOrder=H;for(var U=0,G=u.values,z;U<G;)z=U++,u.sortedOrder[z]=o[z].y;var X=Array(u.values);u.neighbors=X;for(var Y=2,Z=u.values;Y<Z;){for(var K=Y++,q=u.xlist,x=-1,Q=65536,J=0,$=0,ee=0,te;ee<K;)te=ee++,q[te]>x&&q[te]<q[K]&&(J=te,x=q[te]),q[te]<Q&&q[te]>q[K]&&($=te,Q=q[te]);var ne=J,ie=$,de=u.neighbors,ae=Array(u.values);de[K]=ae,u.neighbors[K][0]=ne,u.neighbors[K][1]=ie}}return n},Ge.prototype={floor0:null,floor1:null,type:null,__class__:Ge};var ze=function(){};s["kha.audio2.ogg.vorbis.data.Floor0"]=ze,ze.__name__=!0,ze.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:ze};var Xe=function(){};s["kha.audio2.ogg.vorbis.data.Floor1"]=Xe,Xe.__name__=!0,Xe.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:Xe};var Ye=function(){};s["kha.audio2.ogg.vorbis.data.Header"]=Ye,Ye.__name__=!0,Ye.read=function(e){var t=e.page;if(t.start(e),0==(2&t.flag))throw new W(new et(tt.INVALID_FIRST_PAGE,"not firstPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&t.flag))throw new W(new et(tt.INVALID_FIRST_PAGE,"lastPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&t.flag))throw new W(new et(tt.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.firstPageValidate(),e.inputPosition+=1,1!=e.input.readByte())throw new W(new et(tt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var d=new B(new ArrayBuffer(6)),a;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?a=-1:(e.bytesInSeg--,e.inputPosition+=1,a=e.input.readByte()),e.validBits=0,d.b[0]=a;var r;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?r=-1:(e.bytesInSeg--,e.inputPosition+=1,r=e.input.readByte()),e.validBits=0,d.b[1]=r;var s;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?s=-1:(e.bytesInSeg--,e.inputPosition+=1,s=e.input.readByte()),e.validBits=0,d.b[2]=s;var o;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?o=-1:(e.bytesInSeg--,e.inputPosition+=1,o=e.input.readByte()),e.validBits=0,d.b[3]=o;var u;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?u=-1:(e.bytesInSeg--,e.inputPosition+=1,u=e.input.readByte()),e.validBits=0,d.b[4]=u;var l;if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())?l=-1:(e.bytesInSeg--,e.inputPosition+=1,l=e.input.readByte()),e.validBits=0,d.b[5]=l,"vorbis"!=d.toString())throw new W(new et(tt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));e.inputPosition+=4;var _=e.input.readInt32();if(0!=_)throw new W(new et(tt.INVALID_FIRST_PAGE,"vorbis version : "+_,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var f=new Ye;if(e.inputPosition+=1,f.channel=e.input.readByte(),0==f.channel)throw new W(new et(tt.INVALID_FIRST_PAGE,"no channel",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));else if(16<f.channel)throw new W(new et(tt.TOO_MANY_CHANNELS,"too many channels",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(e.inputPosition+=4,f.sampleRate=e.input.readInt32(),0==f.sampleRate)throw new W(new et(tt.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=4,f.maximumBitRate=e.input.readInt32(),e.inputPosition+=4,f.nominalBitRate=e.input.readInt32(),e.inputPosition+=4,f.minimumBitRate=e.input.readInt32(),e.inputPosition+=1;var c=e.input.readByte(),g=15&c,p=c>>4;if(f.blocksize0=1<<g,f.blocksize1=1<<p,6>g||13<g)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(6>p||13<p)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(g>p)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.inputPosition+=1;var h=e.input.readByte();if(0==(1&h))throw new W(new et(tt.INVALID_FIRST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.page.start(e),e.startPacket();for(var m=0,b=new R;m=e.next(),0!=m;)e.inputPosition+=m,b.write(e.input.read(m)),e.bytesInSeg=0;var S=new A(b.getBytes());S.readByte(),S.read(6);var y=S.readInt32();f.vendor=S.readString(y),f.comment=new Ue;for(var w=S.readInt32(),T=0;T<w;){var E=T++,i=S.readInt32(),n=S.readString(i),C=n.indexOf("=");-1!=C&&f.comment.add(n.substring(0,C),n.substring(C+1))}var I=S.readByte();if(0==(1&I))throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));e.startPacket();var v;if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())?v=-1:(e.bytesInSeg--,e.inputPosition+=1,v=e.input.readByte()),e.validBits=0,5!=v)throw new W(new et(tt.INVALID_SETUP,"setup packet",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var k=new B(new ArrayBuffer(6)),L;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?L=-1:(e.bytesInSeg--,e.inputPosition+=1,L=e.input.readByte()),e.validBits=0,k.b[0]=L;var O;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?O=-1:(e.bytesInSeg--,e.inputPosition+=1,O=e.input.readByte()),e.validBits=0,k.b[1]=O;var N;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?N=-1:(e.bytesInSeg--,e.inputPosition+=1,N=e.input.readByte()),e.validBits=0,k.b[2]=N;var P;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?P=-1:(e.bytesInSeg--,e.inputPosition+=1,P=e.input.readByte()),e.validBits=0,k.b[3]=P;var V;0==e.bytesInSeg&&(e.lastSeg||0==e.next())?V=-1:(e.bytesInSeg--,e.inputPosition+=1,V=e.input.readByte()),e.validBits=0,k.b[4]=V;var D;if(0==e.bytesInSeg&&(e.lastSeg||0==e.next())?D=-1:(e.bytesInSeg--,e.inputPosition+=1,D=e.input.readByte()),e.validBits=0,k.b[5]=D,"vorbis"!=k.toString())throw new W(new et(tt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));var F=e.readBits(8)+1,M=Array(F);f.codebooks=M;for(var H=0,U;H<F;)U=H++,f.codebooks[U]=We.read(e);h=e.readBits(6)+1;for(var G=0,z=h,X;G<z;)if(X=G++,0!=e.readBits(16))throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var Y=e.readBits(6)+1,Z=Array(Y);f.floorConfig=Z;for(var K=0,q;K<Y;)q=K++,f.floorConfig[q]=Ge.read(e,f.codebooks);var Q=e.readBits(6)+1,J=Array(Q);f.residueConfig=J;for(var $=0,ee;$<Q;)ee=$++,f.residueConfig[ee]=nt.read(e,f.codebooks);var te=e.readBits(6)+1,ne=Array(te);f.mapping=ne;for(var ie=0;ie<te;){var de=ie++,ae=Ze.read(e,f.channel);f.mapping[de]=ae;for(var re=0,se=ae.submaps,oe;re<se;){if(oe=re++,ae.submapFloor[oe]>=f.floorConfig.length)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(ae.submapResidue[oe]>=f.residueConfig.length)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}}var ue=e.readBits(6)+1,le=Array(ue);f.modes=le;for(var _e=0;_e<ue;){var fe=_e++,ce=qe.read(e);if(f.modes[fe]=ce,ce.mapping>=f.mapping.length)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=e.bytesInSeg||!e.lastSeg&&0!=e.next();)e.bytesInSeg--,e.inputPosition+=1,e.input.readByte();return f},Ye.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:Ye};var je=function(){};s["kha.audio2.ogg.vorbis.data.IntPoint"]=je,je.__name__=!0,je.prototype={x:null,y:null,__class__:je};var Ze=function(){};s["kha.audio2.ogg.vorbis.data.Mapping"]=Ze,Ze.__name__=!0,Ze.read=function(e,t){var i=new Ze,d=e.readBits(16);if(0!=d)throw new W(new et(tt.INVALID_SETUP,"mapping type "+d,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var a=Array(t);i.chan=a;for(var r=0,s;r<t;)s=r++,i.chan[s]=new Ke;if(i.submaps=0==e.readBits(1)?1:e.readBits(4)+1,0!=e.readBits(1)){i.couplingSteps=e.readBits(8)+1;for(var o=0,u=i.couplingSteps;o<u;){var l=o++,_=t-1,n=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];i.chan[l].magnitude=e.readBits(16384>_?16>_?n[_]:512>_?5+n[_>>5]:10+n[_>>10]:16777216>_?524288>_?15+n[_>>15]:20+n[_>>20]:536870912>_?25+n[_>>25]:-2147483648>_?30+n[_>>30]:0);var f=t-1,c=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(i.chan[l].angle=e.readBits(16384>f?16>f?c[f]:512>f?5+c[f>>5]:10+c[f>>10]:16777216>f?524288>f?15+c[f>>15]:20+c[f>>20]:536870912>f?25+c[f>>25]:-2147483648>f?30+c[f>>30]:0),i.chan[l].magnitude>=t)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[l].angle>=t)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[l].magnitude==i.chan[l].angle)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else i.couplingSteps=0;if(0!=e.readBits(2))throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(1<i.submaps){for(var g=0,p;g<t;)if(p=g++,i.chan[p].mux=e.readBits(4),i.chan[p].mux>=i.submaps)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));}else for(var h=0,m;h<t;)m=h++,i.chan[m].mux=0;var b=Array(i.submaps);i.submapFloor=b;var x=Array(i.submaps);i.submapResidue=x;for(var S=0,y=i.submaps,w;S<y;)w=S++,e.readBits(8),i.submapFloor[w]=e.readBits(8),i.submapResidue[w]=e.readBits(8);return i},Ze.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(e,t,i,n,d){var a=i>>1,r=this.chan[t].mux,s=e[this.submapFloor[r]];if(0==s.type)throw new W(new et(tt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));else{for(var o=s.floor1,u=0,l=d[0]*o.floor1Multiplier,_=1,f=o.values;_<f;){var c=_++,g=o.sortedOrder[c];if(0<=d[g]){var p=d[g]*o.floor1Multiplier,h=o.xlist[g];He.drawLine(n,u,l,h,p,a),u=h,l=p}}if(u<a)for(var m=u;m<a;){var b=m++;n[b]*=He.INVERSE_DB_TABLE[l]}}},__class__:Ze};var Ke=function(){};s["kha.audio2.ogg.vorbis.data.MappingChannel"]=Ke,Ke.__name__=!0,Ke.prototype={magnitude:null,angle:null,mux:null,__class__:Ke};var qe=function(){};s["kha.audio2.ogg.vorbis.data.Mode"]=qe,qe.__name__=!0,qe.read=function(e){var t=new qe;if(t.blockflag=0!=e.readBits(1),t.windowtype=e.readBits(16),t.transformtype=e.readBits(16),t.mapping=e.readBits(8),0!=t.windowtype)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=t.transformtype)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return t},qe.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:qe};var Qe=function(){};s["kha.audio2.ogg.vorbis.data.Page"]=Qe,Qe.__name__=!0,Qe.prototype={flag:null,clone:function(){var e=new Qe;return e.flag=this.flag,e},start:function(e){var t,n,i;if(e.inputPosition+=1,79==e.input.readByte()?(e.inputPosition+=1,i=103!=e.input.readByte()):i=!0,i?n=!0:(e.inputPosition+=1,n=103!=e.input.readByte()),n?t=!0:(e.inputPosition+=1,t=83!=e.input.readByte()),t)throw new W(new et(tt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(e)},startWithoutCapturePattern:function(e){e.inputPosition+=1;var t=e.input.readByte();if(0!=t)throw new W(new et(tt.INVALID_STREAM_STRUCTURE_VERSION,""+t,{fileName:"kha/audio2/ogg/vorbis/data/Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));e.inputPosition+=1,this.flag=e.input.readByte(),e.inputPosition+=4;var n=e.input.readInt32();e.inputPosition+=4;var i=e.input.readInt32();e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.inputPosition+=4,e.input.readInt32(),e.setup(n,i)},__class__:Qe};var Je=function(){};s["kha.audio2.ogg.vorbis.data.PageFlag"]=Je,Je.__name__=!0;var $e=function(){};s["kha.audio2.ogg.vorbis.data.ProbedPage"]=$e,$e.__name__=!0,$e.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:$e};var et=function(e,t,n){null==t&&(t=""),this.type=e,this.message=t,this.posInfos=n};s["kha.audio2.ogg.vorbis.data.ReaderError"]=et,et.__name__=!0,et.prototype={type:null,message:null,posInfos:null,__class__:et};var tt=u["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"],NEED_MORE_DATA:{_hx_index:0,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},INVALID_API_MIXING:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},OUTOFMEM:{_hx_index:2,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},FEATURE_NOT_SUPPORTED:{_hx_index:3,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},TOO_MANY_CHANNELS:{_hx_index:4,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},FILE_OPEN_FAILURE:{_hx_index:5,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},SEEK_WITHOUT_LENGTH:{_hx_index:6,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},UNEXPECTED_EOF:{_hx_index:7,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},SEEK_INVALID:{_hx_index:8,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},INVALID_SETUP:{_hx_index:9,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},INVALID_STREAM:{_hx_index:10,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},MISSING_CAPTURE_PATTERN:{_hx_index:11,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},INVALID_STREAM_STRUCTURE_VERSION:{_hx_index:12,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},CONTINUED_PACKET_FLAG_INVALID:{_hx_index:13,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},INCORRECT_STREAM_SERIAL_NUMBER:{_hx_index:14,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},INVALID_FIRST_PAGE:{_hx_index:15,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},BAD_PACKET_TYPE:{_hx_index:16,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},CANT_FIND_LAST_PAGE:{_hx_index:17,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},SEEK_FAILED:{_hx_index:18,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o},OTHER:{_hx_index:19,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:o}},nt=function(){};s["kha.audio2.ogg.vorbis.data.Residue"]=nt,nt.__name__=!0,nt.read=function(e,t){var n=new nt;if(n.type=e.readBits(16),2<n.type)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var i=Array(64),d=i;n.begin=e.readBits(24),n.end=e.readBits(24),n.partSize=e.readBits(24)+1;var a=n.classifications=e.readBits(6)+1;n.classbook=e.readBits(8);for(var r=0,s=n.classifications;r<s;){var o=r++,u=0,l=e.readBits(3);0!=e.readBits(1)&&(u=e.readBits(5)),d[o]=8*u+l}var _=Array(n.classifications);n.residueBooks=_;for(var f=0,c=n.classifications;f<c;){var g=f++,p=n.residueBooks,h=Array(8);p[g]=h;for(var m=0,b;8>m;)if(b=m++,0==(d[g]&1<<b))n.residueBooks[g][b]=-1;else if(n.residueBooks[g][b]=e.readBits(8),n.residueBooks[g][b]>=t.length)throw new W(new et(tt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}var x=t[n.classbook].entries,S=t[n.classbook].dimensions,y=Array(x);n.classdata=y;for(var w=0;w<x;)for(var T=w++,E=T,C=S,I=n.classdata,v=Array(S),L=I[T]=v;0<=--C;)L[C]=E%a,E=0|E/a;return n},nt.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(e,t,d,a,r,n){for(var s=t.codebooks,o=s[this.classbook].dimensions,u=this.end-this.begin,_=this.partSize,f=0|S.toFloat(u)/S.toFloat(_),g=Array(t.channel*f+1),p=g,h=0;h<a;){var m=h++;if(!n[m])for(var i=d[m],x=0,y=i.length,w;x<y;)w=x++,i[w]=0}if(2==this.type&&1!=a){for(var T=0;T<a;){var E=T++;if(!n[E])break;else if(E==a-1)return}for(var C=0;8>C;){var I=C++,v=0;if(2==a)for(;v<f;){var k=this.begin+v*_,L=1&k,B=k>>>1;if(0==I){var O=s[this.classbook];10>e.validBits&&e.prepHuffman();var c=O.fastHuffman[1023&e.acc],N;if(0<=c){var A=O.codewordLengths[c];e.acc>>>=A,e.validBits-=A,0>e.validBits?(e.validBits=0,N=-1):N=c}else N=e.decodeScalarRaw(O);O.sparse&&(N=O.sortedValues[N]);var l=N;if(-1==l)return;for(var P=o;0<=--P;)p[P+v]=l%this.classifications,l=0|l/this.classifications}for(var R=0,V;R<o&&(V=R++,!(v>=f));){var D=this.begin+v*_,F=p[v],M=this.residueBooks[F][I];if(0<=M){var b=s[M],H=b.decodeDeinterleaveRepeat(e,d,a,L,B,r,_);if(null==H)return;L=H.cInter,B=H.pInter}else D+=_,L=1&D,B=D>>>1;++v}}else if(1==a)for(;v<f;){var W=this.begin+v*_,U=0,G=W;if(0==I){var z=s[this.classbook];10>e.validBits&&e.prepHuffman();var X=z.fastHuffman[1023&e.acc],Y;if(0<=X){var Z=z.codewordLengths[X];e.acc>>>=Z,e.validBits-=Z,0>e.validBits?(e.validBits=0,Y=-1):Y=X}else Y=e.decodeScalarRaw(z);z.sparse&&(Y=z.sortedValues[Y]);var K=Y;if(-1==K)return;for(var Q=o;0<=--Q;)p[Q+v]=K%this.classifications,K=0|K/this.classifications}for(var J=0,$;J<o&&($=J++,!(v>=f));){var ee=this.begin+v*_,te=this.residueBooks[p[v]][I];if(0<=te){var ne=s[te],ie=ne.decodeDeinterleaveRepeat(e,d,a,U,G,r,_);if(null==ie)return;U=ie.cInter,G=ie.pInter}else ee+=_,U=0,G=ee;++v}}else for(;v<f;){var de=this.begin+v*_,ae=0|S.toFloat(de)%S.toFloat(a),re=0|S.toFloat(de)/S.toFloat(a);if(0==I){var se=s[this.classbook];10>e.validBits&&e.prepHuffman();var oe=se.fastHuffman[1023&e.acc],ue;if(0<=oe){var le=se.codewordLengths[oe];e.acc>>>=le,e.validBits-=le,0>e.validBits?(e.validBits=0,ue=-1):ue=oe}else ue=e.decodeScalarRaw(se);se.sparse&&(ue=se.sortedValues[ue]);var _e=ue;if(-1==_e)return;for(var fe=o;0<=--fe;)p[fe+v]=_e%this.classifications,_e=0|_e/this.classifications}for(var ce=0,ge;ce<o&&(ge=ce++,!(v>=f));){var pe=this.begin+v*_,he=this.residueBooks[p[v]][I];if(0<=he){var me=s[he],be=me.decodeDeinterleaveRepeat(e,d,a,ae,re,r,_);if(null==be)return;ae=be.cInter,re=be.pInter}else pe+=_,ae=0|S.toFloat(pe)%S.toFloat(a),re=0|S.toFloat(pe)/S.toFloat(a);++v}}}return}for(var xe=0;8>xe;)for(var Se=xe++,ye=0;ye<f;){if(0==Se)for(var we=0,Te;we<a;)if(Te=we++,!n[Te]){var Ee=s[this.classbook];10>e.validBits&&e.prepHuffman();var Ce=Ee.fastHuffman[1023&e.acc],Ie;if(0<=Ce){var ve=Ee.codewordLengths[Ce];e.acc>>>=ve,e.validBits-=ve,0>e.validBits?(e.validBits=0,Ie=-1):Ie=Ce}else Ie=e.decodeScalarRaw(Ee);Ee.sparse&&(Ie=Ee.sortedValues[Ie]);var ke=Ie;if(-1==ke)return;for(var Le=o;0<=--Le;)p[Te*f+Le+ye]=ke%this.classifications,ke=0|ke/this.classifications}for(var Be=0,Oe;Be<o&&(Oe=Be++,!(ye>=f));){for(var Ne=0,Ae;Ne<a;)if(Ae=Ne++,!n[Ae]){var Pe=p[Ae*f+ye],Re=this.residueBooks[Pe][Se];if(0<=Re){var Ve=d[Ae],De=this.begin+ye*_,Fe=s[Re];if(!Fe.residueDecode(e,Ve,De,_,this.type))return}}++ye}}},__class__:nt};var it=function(){};s["kha.audio2.ogg.vorbis.data.Setting"]=it,it.__name__=!0;var dt=function(){};s["kha.compute.ConstantLocation"]=dt,dt.__name__=!0,dt.prototype={__class__:dt};var at=function(){};s["kha.compute.TextureUnit"]=at,at.__name__=!0,at.prototype={__class__:at};var rt=function(){};s["kha.graphics1.Graphics"]=rt,rt.__name__=!0,rt.__isInterface__=!0,rt.prototype={begin:null,end:null,setPixel:null,__class__:rt};var st=function(){this.transformations=[new rn(1,0,0,0,1,0,0,0,1)],this.transformationIndex=0,this.opacities=[1],this.myFontSize=12,this.pipe=null};s["kha.graphics2.Graphics"]=st,st.__name__=!0,st.prototype={begin:function(e){null==e&&(e=!0)},end:function(){},flush:function(){},clear:function(){},drawImage:function(e,t,n){this.drawSubImage(e,t,n,0,0,e.get_width(),e.get_height())},drawSubImage:function(e,t,n,i,d,a,r){this.drawScaledSubImage(e,i,d,a,r,t,n,a,r)},drawScaledImage:function(e,t,n,i,d){this.drawScaledSubImage(e,0,0,e.get_width(),e.get_height(),t,n,i,d)},drawScaledSubImage:function(){},drawRect:function(e,t,n,i,d){null==d&&(d=1)},fillRect:function(){},drawString:function(){},drawCharacters:function(){},drawLine:function(e,t,n,i,d){null==d&&(d=1)},drawVideo:function(){},fillTriangle:function(){},get_imageScaleQuality:function(){return 0},set_imageScaleQuality:function(){return 1},get_mipmapScaleQuality:function(){return 0},set_mipmapScaleQuality:function(){return 1},get_color:function(){return-16777216},set_color:function(){return-16777216},get_font:function(){return null},set_font:function(){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(e){return this.myFontSize=e},get_transformation:function(){return this.transformations[this.transformationIndex]},set_transformation:function(e){this.setTransformation(e);var t=this.transformations[this.transformationIndex];return t._00=e._00,t._10=e._10,t._20=e._20,t._01=e._01,t._11=e._11,t._21=e._21,t._02=e._02,t._12=e._12,t._22=e._22,e},pushTransformation:function(e){this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new rn(1,0,0,0,1,0,0,0,1));var t=this.transformations[this.transformationIndex];t._00=e._00,t._10=e._10,t._20=e._20,t._01=e._01,t._11=e._11,t._21=e._21,t._02=e._02,t._12=e._12,t._22=e._22,this.setTransformation(this.transformations[this.transformationIndex])},popTransformation:function(){return this.transformationIndex--,this.setTransformation(this.transformations[this.transformationIndex]),this.transformations[this.transformationIndex+1]},scale:function(e,t){var n=this.transformations[this.transformationIndex],i=e,d=0,a=0,r=0,s=t,o=0,u=0,l=0,_=1,f=this.transformations[this.transformationIndex],c=i*f._00+d*f._01+a*f._02,g=i*f._10+d*f._11+a*f._12,p=i*f._20+d*f._21+a*f._22,h=r*f._00+s*f._01+o*f._02,m=r*f._10+s*f._11+o*f._12,b=r*f._20+s*f._21+o*f._22,x=u*f._00+l*f._01+_*f._02,S=u*f._10+l*f._11+_*f._12,y=u*f._20+l*f._21+_*f._22;n._00=c,n._10=g,n._20=p,n._01=h,n._11=m,n._21=b,n._02=x,n._12=S,n._22=y},translation:function(e,t){var n=0,i=e,d=0,a=1,r=t,s=0,o=0,u=1,l=this.transformations[this.transformationIndex];return new rn(1*l._00+n*l._01+i*l._02,1*l._10+n*l._11+i*l._12,1*l._20+n*l._21+i*l._22,d*l._00+a*l._01+r*l._02,d*l._10+a*l._11+r*l._12,d*l._20+a*l._21+r*l._22,s*l._00+o*l._01+u*l._02,s*l._10+o*l._11+u*l._12,s*l._20+o*l._21+u*l._22)},translate:function(e,t){var n=this.transformations[this.transformationIndex],i=1,d=0,a=e,r=0,s=1,o=t,u=0,l=0,_=1,f=this.transformations[this.transformationIndex],c=i*f._00+d*f._01+a*f._02,g=i*f._10+d*f._11+a*f._12,p=i*f._20+d*f._21+a*f._22,h=r*f._00+s*f._01+o*f._02,m=r*f._10+s*f._11+o*f._12,b=r*f._20+s*f._21+o*f._22,x=u*f._00+l*f._01+_*f._02,S=u*f._10+l*f._11+_*f._12,y=u*f._20+l*f._21+_*f._22;n._00=c,n._10=g,n._20=p,n._01=h,n._11=m,n._21=b,n._02=x,n._12=S,n._22=y},pushTranslation:function(e,t){var n=0,i=e,d=0,a=1,r=t,s=0,o=0,u=1,l=this.transformations[this.transformationIndex],_=1*l._00+n*l._01+i*l._02,f=1*l._10+n*l._11+i*l._12,c=1*l._20+n*l._21+i*l._22,g=d*l._00+a*l._01+r*l._02,p=d*l._10+a*l._11+r*l._12,h=d*l._20+a*l._21+r*l._22,m=s*l._00+o*l._01+u*l._02,b=s*l._10+o*l._11+u*l._12,x=s*l._20+o*l._21+u*l._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new rn(1,0,0,0,1,0,0,0,1));var S=this.transformations[this.transformationIndex];S._00=_,S._10=f,S._20=c,S._01=g,S._11=p,S._21=h,S._02=m,S._12=b,S._22=x,this.setTransformation(this.transformations[this.transformationIndex])},rotation:function(e,t,n){var i=0,d=t,a=0,r=1,s=n,o=0,u=0,l=1,_=Math.cos(e),f=-Math.sin(e),c=0,g=Math.sin(e),p=Math.cos(e),h=0,b=0,x=0,S=1,y=1*_+i*g+d*b,w=1*f+i*p+d*x,T=1*c+i*h+d*S,E=a*_+r*g+s*b,C=a*f+r*p+s*x,I=a*c+r*h+s*S,v=o*_+u*g+l*b,k=o*f+u*p+l*x,L=o*c+u*h+l*S,B=1,O=0,N=-t,A=0,P=1,R=-n,V=0,D=0,F=1,M=y*B+w*A+T*V,H=y*O+w*P+T*D,W=y*N+w*R+T*F,U=E*B+C*A+I*V,G=E*O+C*P+I*D,z=E*N+C*R+I*F,X=v*B+k*A+L*V,Y=v*O+k*P+L*D,j=v*N+k*R+L*F,Z=this.transformations[this.transformationIndex];return new rn(M*Z._00+H*Z._01+W*Z._02,M*Z._10+H*Z._11+W*Z._12,M*Z._20+H*Z._21+W*Z._22,U*Z._00+G*Z._01+z*Z._02,U*Z._10+G*Z._11+z*Z._12,U*Z._20+G*Z._21+z*Z._22,X*Z._00+Y*Z._01+j*Z._02,X*Z._10+Y*Z._11+j*Z._12,X*Z._20+Y*Z._21+j*Z._22)},rotate:function(e,t,n){var i=this.transformations[this.transformationIndex],d=1,a=0,r=t,s=0,o=1,u=n,l=0,_=0,f=1,c=Math.cos(e),g=-Math.sin(e),p=0,h=Math.sin(e),b=Math.cos(e),x=0,S=0,y=0,w=1,T=d*c+a*h+r*S,E=d*g+a*b+r*y,C=d*p+a*x+r*w,I=s*c+o*h+u*S,v=s*g+o*b+u*y,k=s*p+o*x+u*w,L=l*c+_*h+f*S,B=l*g+_*b+f*y,O=l*p+_*x+f*w,N=1,A=0,P=-t,R=0,V=1,D=-n,F=0,M=0,H=1,W=T*N+E*R+C*F,U=T*A+E*V+C*M,G=T*P+E*D+C*H,z=I*N+v*R+k*F,X=I*A+v*V+k*M,Y=I*P+v*D+k*H,j=L*N+B*R+O*F,Z=L*A+B*V+O*M,K=L*P+B*D+O*H,q=this.transformations[this.transformationIndex],m=W*q._00+U*q._01+G*q._02,Q=W*q._10+U*q._11+G*q._12,J=W*q._20+U*q._21+G*q._22,$=z*q._00+X*q._01+Y*q._02,ee=z*q._10+X*q._11+Y*q._12,te=z*q._20+X*q._21+Y*q._22,ne=j*q._00+Z*q._01+K*q._02,ie=j*q._10+Z*q._11+K*q._12,de=j*q._20+Z*q._21+K*q._22;i._00=m,i._10=Q,i._20=J,i._01=$,i._11=ee,i._21=te,i._02=ne,i._12=ie,i._22=de},pushRotation:function(e,t,n){var i=0,d=t,a=0,r=1,s=n,o=0,u=0,l=1,_=Math.cos(e),f=-Math.sin(e),c=0,g=Math.sin(e),p=Math.cos(e),h=0,b=0,x=0,S=1,y=1*_+i*g+d*b,w=1*f+i*p+d*x,T=1*c+i*h+d*S,E=a*_+r*g+s*b,C=a*f+r*p+s*x,I=a*c+r*h+s*S,v=o*_+u*g+l*b,k=o*f+u*p+l*x,L=o*c+u*h+l*S,B=1,O=0,N=-t,A=0,P=1,R=-n,V=0,D=0,F=1,M=y*B+w*A+T*V,H=y*O+w*P+T*D,W=y*N+w*R+T*F,U=E*B+C*A+I*V,G=E*O+C*P+I*D,z=E*N+C*R+I*F,X=v*B+k*A+L*V,Y=v*O+k*P+L*D,j=v*N+k*R+L*F,Z=this.transformations[this.transformationIndex],m=M*Z._00+H*Z._01+W*Z._02,K=M*Z._10+H*Z._11+W*Z._12,q=M*Z._20+H*Z._21+W*Z._22,Q=U*Z._00+G*Z._01+z*Z._02,J=U*Z._10+G*Z._11+z*Z._12,$=U*Z._20+G*Z._21+z*Z._22,ee=X*Z._00+Y*Z._01+j*Z._02,te=X*Z._10+Y*Z._11+j*Z._12,ne=X*Z._20+Y*Z._21+j*Z._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new rn(1,0,0,0,1,0,0,0,1));var ie=this.transformations[this.transformationIndex];ie._00=m,ie._10=K,ie._20=q,ie._01=Q,ie._11=J,ie._21=$,ie._02=ee,ie._12=te,ie._22=ne,this.setTransformation(this.transformations[this.transformationIndex])},pushOpacity:function(e){this.setOpacity(e),this.opacities.push(e)},popOpacity:function(){var e=this.opacities.pop();return this.setOpacity(this.get_opacity()),e},get_opacity:function(){return this.opacities[this.opacities.length-1]},set_opacity:function(e){return this.setOpacity(e),this.opacities[this.opacities.length-1]=e},scissor:function(){},disableScissor:function(){},pipe:null,get_pipeline:function(){return this.pipe},set_pipeline:function(e){return this.setPipeline(e),this.pipe=e},transformations:null,transformationIndex:null,opacities:null,myFontSize:null,setTransformation:function(){},setOpacity:function(){},setPipeline:function(){},__class__:st};var ot=function(e){this.canvas=e};s["kha.graphics2.Graphics1"]=ot,ot.__name__=!0,ot.__interfaces__=[rt],ot.prototype={canvas:null,texture:null,pixels:null,begin:function(){(null==this.texture||this.texture.get_realWidth()!=this.canvas.get_width()||this.texture.get_realHeight()!=this.canvas.get_height())&&(this.texture=de.create(this.canvas.get_width(),this.canvas.get_height(),0,2)),this.pixels=this.texture.lock()},end:function(){this.texture.unlock(),this.canvas.get_g2().begin(),this.canvas.get_g2().drawImage(this.texture,0,0),this.canvas.get_g2().end()},setPixel:function(e,t,n){this.pixels.setInt32(4*(t*this.texture.get_realWidth())+4*e,n)},__class__:ot};var ut=function(){};s["kha.graphics2.GraphicsExtension"]=ut,ut.__name__=!0,ut.drawArc=function(e,i,d,a,r,o,u,l,_){null==_&&(_=0),null==l&&(l=!1),null==u&&(u=1),r%=2*Math.PI,o%=2*Math.PI,l?o>r&&(o-=2*Math.PI):o<r&&(o+=2*Math.PI),0>=_&&(_=Math.floor(10*Math.sqrt(a)));for(var f=(o-r)/_,g=Math.cos(f),c=Math.sin(f),s=Math.cos(r)*a,p=Math.sin(r)*a,h=0,m=_;h<m;){var b=h++,n=s+i,S=p+d,w=s;s=g*s-c*p,p=g*p+c*w,e.drawLine(n,S,s+i,p+d,u)}},ut.fillArc=function(e,i,d,a,r,o,u,l){null==l&&(l=0),null==u&&(u=!1),r%=2*Math.PI,o%=2*Math.PI,u?o>r&&(o-=2*Math.PI):o<r&&(o+=2*Math.PI),0>=l&&(l=Math.floor(10*Math.sqrt(a)));for(var _=(o-r)/l,f=Math.cos(_),c=Math.sin(_),s=Math.cos(r)*a,g=Math.sin(r)*a,p=s+i,h=g+d,m=0,b=l;m<b;){var S=m++,n=s+i,w=g+d,T=s;s=f*s-c*g,g=f*g+c*T,e.fillTriangle(n,w,s+i,g+d,p,h)}},ut.drawCircle=function(e,i,d,a,r,o){null==o&&(o=0),null==r&&(r=1),0>=o&&(o=Math.floor(10*Math.sqrt(a)));for(var u=2*Math.PI/o,l=Math.cos(u),_=Math.sin(u),s=a,f=0,c=0,g=o;c<g;){var p=c++,n=s+i,h=f+d,m=s;s=l*s-_*f,f=l*f+_*m,e.drawLine(n,h,s+i,f+d,r)}},ut.fillCircle=function(e,i,d,a,r){null==r&&(r=0),0>=r&&(r=Math.floor(10*Math.sqrt(a)));for(var o=2*Math.PI/r,u=Math.cos(o),l=Math.sin(o),s=a,_=0,f=0,c=r;f<c;){var g=f++,n=s+i,p=_+d,h=s;s=u*s-l*_,_=u*_+l*h,e.fillTriangle(n,p,s+i,_+d,i,d)}},ut.drawPolygon=function(e,t,n,i,d){null==d&&(d=1);for(var a=f.iter(i),r=a.next(),s=r;a.hasNext();){var o=a.next();e.drawLine(s.x+t,s.y+n,o.x+t,o.y+n,d),s=o}e.drawLine(s.x+t,s.y+n,r.x+t,r.y+n,d)},ut.fillPolygon=function(e,t,n,i){var d=f.iter(i);if(d.hasNext()){var a=d.next();if(d.hasNext())for(var r=d.next(),s;d.hasNext();)s=d.next(),e.fillTriangle(a.x+t,a.y+n,r.x+t,r.y+n,s.x+t,s.y+n),r=s}},ut.drawCubicBezier=function(e,n,d,a,r){null==r&&(r=1),null==a&&(a=20);for(var s=ut.calculateCubicBezierPoint(0,n,d),o=1,u=a+1,l,_;o<u;){var f=o++;l=f/a,_=ut.calculateCubicBezierPoint(l,n,d),e.drawLine(s[0],s[1],_[0],_[1],r),s=_}},ut.drawCubicBezierPath=function(e,n,d,a,r){null==r&&(r=1),null==a&&(a=20);for(var s=0,o=null,u=null,l;s<n.length-3;){0==s&&(o=ut.calculateCubicBezierPoint(0,[n[s],n[s+1],n[s+2],n[s+3]],[d[s],d[s+1],d[s+2],d[s+3]]));for(var _=1,f=a+1;_<f;){var c=_++;l=c/a,u=ut.calculateCubicBezierPoint(l,[n[s],n[s+1],n[s+2],n[s+3]],[d[s],d[s+1],d[s+2],d[s+3]]),e.drawLine(o[0],o[1],u[0],u[1],r),o=u}s+=3}},ut.calculateCubicBezierPoint=function(e,t,n){var i=1-e,d=e*e,a=i*i,r=a*i,s=d*e,o=[r*t[0],r*n[0]];return o[0]+=3*a*e*t[1],o[1]+=3*a*e*n[1],o[0]+=3*i*d*t[2],o[1]+=3*i*d*n[2],o[0]+=s*t[3],o[1]+=s*n[3],o},ut.drawAlignedString=function(e,t,n,i,d,a){var r=0;if(1==d||2==d){var s=e.get_font().width(e.get_fontSize(),t);r=1==d?.5*-s:-s}var o=0;if(1==a||2==a){var u=e.get_font().height(e.get_fontSize());o=1==a?.5*-u:-u}e.drawString(t,n+r,i+o)},ut.drawAlignedCharacters=function(e,t,n,i,d,a,r,s){var o=0;if(1==r||2==r){var u=e.get_font().widthOfCharacters(e.get_fontSize(),t,n,i);o=1==r?.5*-u:-u}var l=0;if(1==s||2==s){var _=e.get_font().height(e.get_fontSize());l=1==s?.5*-_:-_}e.drawCharacters(t,n,i,d+o,a+l)};var lt=function(){};s["kha.graphics2.truetype.VectorOfIntPointer"]=lt,lt.__name__=!0,lt.prototype={value:null,__class__:lt};var _t=function(){};s["kha.graphics2.truetype.Stbtt_temp_rect"]=_t,_t.__name__=!0,_t.prototype={x0:null,y0:null,x1:null,y1:null,__class__:_t};var ft=function(){};s["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=ft,ft.__name__=!0,ft.prototype={advanceWidth:null,leftSideBearing:null,__class__:ft};var ct=function(){};s["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=ct,ct.__name__=!0,ct.prototype={ascent:null,descent:null,lineGap:null,__class__:ct};var gt=function(){};s["kha.graphics2.truetype.Stbtt_temp_region"]=gt,gt.__name__=!0,gt.prototype={width:null,height:null,xoff:null,yoff:null,__class__:gt};var pt=function(){};s["kha.graphics2.truetype.Stbtt_bakedchar"]=pt,pt.__name__=!0,pt.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:pt};var ht=function(){};s["kha.graphics2.truetype.Stbtt_aligned_quad"]=ht,ht.__name__=!0,ht.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,__class__:ht};var mt=function(){};s["kha.graphics2.truetype.Stbtt_packedchar"]=mt,mt.__name__=!0,mt.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,xoff2:null,yoff2:null,__class__:mt};var bt=function(){};s["kha.graphics2.truetype.Stbtt_pack_range"]=bt,bt.__name__=!0,bt.prototype={font_size:null,first_unicode_codepoint_in_range:null,array_of_unicode_codepoints:null,num_chars:null,chardata_for_range:null,h_oversample:null,v_oversample:null,__class__:bt};var xt=function(){};s["kha.graphics2.truetype.Stbtt_pack_context"]=xt,xt.__name__=!0,xt.prototype={width:null,height:null,stride_in_bytes:null,padding:null,h_oversample:null,v_oversample:null,pixels:null,__class__:xt};var St=function(){};s["kha.graphics2.truetype.Stbtt_fontinfo"]=St,St.__name__=!0,St.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:St};var yt=function(){};s["kha.graphics2.truetype.Stbtt_vertex"]=yt,yt.__name__=!0,yt.prototype={x:null,y:null,cx:null,cy:null,type:null,padding:null,__class__:yt};var wt=function(){};s["kha.graphics2.truetype.Stbtt__bitmap"]=wt,wt.__name__=!0,wt.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:wt};var Tt=function(){};s["kha.graphics2.truetype.Stbtt__edge"]=Tt,Tt.__name__=!0,Tt.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:Tt};var Et=function(){};s["kha.graphics2.truetype.Stbtt__active_edge"]=Et,Et.__name__=!0,Et.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:Et};var Ct=function(){};s["kha.graphics2.truetype.Stbtt__point"]=Ct,Ct.__name__=!0,Ct.prototype={x:null,y:null,__class__:Ct};var It=function(){};s["kha.graphics2.truetype.StbTruetype"]=It,It.__name__=!0,It.STBTT_assert=function(e){if(!e)throw new W("Error")},It.STBTT_POINT_SIZE=function(e){return-e},It.ttBYTE=function(e,t){return null==t&&(t=0),e.readU8(t)},It.ttCHAR=function(e,t){null==t&&(t=0);var i=e.readU8(t);return 128<=i?i-256:i},It.ttUSHORT=function(e,t){null==t&&(t=0);var n=e.readU8(t),i=e.readU8(t+1);return i|n<<8},It.ttSHORT=function(e,t){null==t&&(t=0);var i=e.readU8(t),d=e.readU8(t+1),a=d|i<<8;return 0==(32768&a)?a:a-65536},It.ttULONG=function(e,t){null==t&&(t=0);var n=t;null==n&&(n=0);var i=e.readU8(n),d=e.readU8(n+1),a=e.readU8(n+2),r=e.readU8(n+3);return r|a<<8|d<<16|i<<24},It.ttLONG=function(e,t){null==t&&(t=0);var n=e.readU8(t),i=e.readU8(t+1),d=e.readU8(t+2),a=e.readU8(t+3);return a|d<<8|i<<16|n<<24},It.ttFixed=function(e,t){null==t&&(t=0);var n=t;null==n&&(n=0);var i=e.readU8(n),d=e.readU8(n+1),a=e.readU8(n+2),r=e.readU8(n+3);return r|a<<8|d<<16|i<<24},It.stbtt_tag4=function(e,t,n,i,d,a){return!(e.readU8(t)!=n||e.readU8(t+1)!=i||e.readU8(t+2)!=d)&&e.readU8(t+3)==a},It.stbtt_tag=function(e,t,n){var i=f.cca(n,0),d=f.cca(n,1),a=f.cca(n,2),r=f.cca(n,3);return!(e.readU8(t)!=i||e.readU8(t+1)!=d||e.readU8(t+2)!=a)&&e.readU8(t+3)==r},It.stbtt__isfont=function(e){var t=f.cca("1",0);if(e.readU8(0)==t&&0==e.readU8(1)&&0==e.readU8(2)&&0==e.readU8(3))return!0;var n=f.cca("typ1",0),i=f.cca("typ1",1),d=f.cca("typ1",2),a=f.cca("typ1",3);if(e.readU8(0)==n&&e.readU8(1)==i&&e.readU8(2)==d&&e.readU8(3)==a)return!0;var r=f.cca("OTTO",0),s=f.cca("OTTO",1),o=f.cca("OTTO",2),u=f.cca("OTTO",3);return!(e.readU8(0)!=r||e.readU8(1)!=s||e.readU8(2)!=o||e.readU8(3)!=u)||!(0!=e.readU8(0)||1!=e.readU8(1)||0!=e.readU8(2)||0!=e.readU8(3))},It.stbtt__find_table=function(e,t,n){var d=t+4;null==d&&(d=0);for(var a=e.readU8(d),r=e.readU8(d+1),s=0;s<(r|a<<8);){var o=s++,i=t+12+16*o,u=f.cca(n,0),l=f.cca(n,1),_=f.cca(n,2),c=f.cca(n,3);if(e.readU8(i)==u&&e.readU8(i+1)==l&&e.readU8(i+2)==_&&e.readU8(i+3)==c){var g=i+8;null==g&&(g=0);var p=g;null==p&&(p=0);var h=e.readU8(p),m=e.readU8(p+1),b=e.readU8(p+2),x=e.readU8(p+3);return x|b<<8|m<<16|h<<24}}return 0},It.stbtt_GetFontOffsetForIndex=function(e,t){if(It.stbtt__isfont(e))return 0==t?0:-1;var n=f.cca("ttcf",0),i=f.cca("ttcf",1),d=f.cca("ttcf",2),a=f.cca("ttcf",3);if(e.readU8(0)==n&&e.readU8(1)==i&&e.readU8(2)==d&&e.readU8(3)==a){var r=4,s;null==r&&(r=0);var o=r;null==o&&(o=0);var u=e.readU8(o),l=e.readU8(o+1),_=e.readU8(o+2),c=e.readU8(o+3);if(65536!=(c|_<<8|l<<16|u<<24)){var g=4;null==g&&(g=0);var p=g;null==p&&(p=0);var h=e.readU8(p),m=e.readU8(p+1),b=e.readU8(p+2),x=e.readU8(p+3);s=131072==(x|b<<8|m<<16|h<<24)}else s=!0;if(s){var S=8;null==S&&(S=0);var y=e.readU8(S),w=e.readU8(S+1),T=e.readU8(S+2),E=e.readU8(S+3);if(t>=(E|T<<8|w<<16|y<<24))return-1;var C=12+4*t;null==C&&(C=0);var I=C;null==I&&(I=0);var v=e.readU8(I),k=e.readU8(I+1),L=e.readU8(I+2),B=e.readU8(I+3);return B|L<<8|k<<16|v<<24}}return-1},It.stbtt_InitFont=function(e,n,d){e.data=n,e.fontstart=d;var a=It.stbtt__find_table(n,d,"cmap");if(e.loca=It.stbtt__find_table(n,d,"loca"),e.head=It.stbtt__find_table(n,d,"head"),e.glyf=It.stbtt__find_table(n,d,"glyf"),e.hhea=It.stbtt__find_table(n,d,"hhea"),e.hmtx=It.stbtt__find_table(n,d,"hmtx"),e.kern=It.stbtt__find_table(n,d,"kern"),0==a||0==e.loca||0==e.head||0==e.glyf||0==e.hhea||0==e.hmtx)return!1;var r=It.stbtt__find_table(n,d,"maxp");if(0!=r){var t=r+4;null==t&&(t=0);var s=n.readU8(t),o=n.readU8(t+1);e.numGlyphs=o|s<<8}else e.numGlyphs=65535;var u=a+2;null==u&&(u=0);var l=n.readU8(u),_=n.readU8(u+1);e.index_map=0;for(var f=0;f<(_|l<<8);){var c=f++,i=a+4+8*c,g=i;null==g&&(g=0);var p=n.readU8(g),h=n.readU8(g+1);switch(h|p<<8){case 0:var m=i+4;null==m&&(m=0);var b=m;null==b&&(b=0);var x=n.readU8(b),S=n.readU8(b+1),y=n.readU8(b+2),w=n.readU8(b+3);e.index_map=a+(w|y<<8|S<<16|x<<24);break;case 3:var T=i+2;null==T&&(T=0);var E=n.readU8(T),C=n.readU8(T+1);switch(C|E<<8){case 1:case 10:var I=i+4;null==I&&(I=0);var v=I;null==v&&(v=0);var k=n.readU8(v),L=n.readU8(v+1),B=n.readU8(v+2),O=n.readU8(v+3);e.index_map=a+(O|B<<8|L<<16|k<<24);}}}if(0==e.index_map)return!1;var N=e.head+50;null==N&&(N=0);var A=n.readU8(N),P=n.readU8(N+1);return e.indexToLocFormat=P|A<<8,!0},It.stbtt_FindGlyphIndex=function(e,t){var i=e.data,d=e.index_map,a=d;null==a&&(a=0);var r=i.readU8(a),s=i.readU8(a+1),o=s|r<<8;if(0==o){var u=d+2;null==u&&(u=0);var l=i.readU8(u),_=i.readU8(u+1);if(t<(_|l<<8)-6){var f=d+6+t;return null==f&&(f=0),i.readU8(f)}return 0}if(6==o){var c=d+6;null==c&&(c=0);var g=i.readU8(c),p=i.readU8(c+1),h=p|g<<8,m=d+8;null==m&&(m=0);var b=i.readU8(m),x=i.readU8(m+1);if(t>=h&&t<h+(x|b<<8)){var S=d+10+2*(t-h);null==S&&(S=0);var y=i.readU8(S),w=i.readU8(S+1);return w|y<<8}return 0}if(2==o)throw new W("Error");else{if(4==o){var T=d+6;null==T&&(T=0);var E=i.readU8(T),C=i.readU8(T+1),I=(C|E<<8)>>1,v=d+8;null==v&&(v=0);var k=i.readU8(v),L=i.readU8(v+1),B=(L|k<<8)>>1,O=d+10;null==O&&(O=0);var N=i.readU8(O),A=i.readU8(O+1),P=A|N<<8,R=d+12;null==R&&(R=0);var V=i.readU8(R),D=i.readU8(R+1),F=(D|V<<8)>>1,M=d+14,H=M;if(65535<t)return 0;var U=H+2*F;null==U&&(U=0);var G=i.readU8(U),z=i.readU8(U+1);for(t>=(z|G<<8)&&(H+=2*F),H-=2;0!=P;){B>>=1;var X=H+2*B;null==X&&(X=0);var Y=i.readU8(X),j=i.readU8(X+1);t>(j|Y<<8)&&(H+=2*B),--P}H+=2;var Z=H-M>>1,K=M+2*Z;null==K&&(K=0);var q=i.readU8(K),Q=i.readU8(K+1);if(t>(Q|q<<8))throw new W("Error");var J=d+14+2*I+2+2*Z;null==J&&(J=0);var $=i.readU8(J),ee=i.readU8(J+1),te=ee|$<<8;if(t<te)return 0;var ne=d+14+6*I+2+2*Z;null==ne&&(ne=0);var ie=i.readU8(ne),de=i.readU8(ne+1),ae=de|ie<<8;if(0==ae){var re=d+14+4*I+2+2*Z;null==re&&(re=0);var se=i.readU8(re),oe=i.readU8(re+1),ue=oe|se<<8;return t+(0==(32768&ue)?ue:ue-65536)}var n=ae+2*(t-te)+d+14+6*I+2+2*Z;null==n&&(n=0);var le=i.readU8(n),_e=i.readU8(n+1);return _e|le<<8}if(12==o||13==o){var fe=d+12;null==fe&&(fe=0);var ce=fe;null==ce&&(ce=0);for(var ge=i.readU8(ce),pe=i.readU8(ce+1),he=i.readU8(ce+2),me=i.readU8(ce+3),be=0,xe=me|he<<8|pe<<16|ge<<24;be<xe;){var Se=be+(xe-be>>1),ye=d+16+12*Se;null==ye&&(ye=0);var we=ye;null==we&&(we=0);var Te=i.readU8(we),Ee=i.readU8(we+1),Ce=i.readU8(we+2),Ie=i.readU8(we+3),ve=Ie|Ce<<8|Ee<<16|Te<<24,ke=d+16+12*Se+4;null==ke&&(ke=0);var Le=ke;null==Le&&(Le=0);var Be=i.readU8(Le),Oe=i.readU8(Le+1),Ne=i.readU8(Le+2),Ae=i.readU8(Le+3);if(t<ve)xe=Se;else if(t>(Ae|Ne<<8|Oe<<16|Be<<24))be=Se+1;else{var Pe=d+16+12*Se+8;null==Pe&&(Pe=0);var Re=Pe;null==Re&&(Re=0);var Ve=i.readU8(Re),De=i.readU8(Re+1),Fe=i.readU8(Re+2),Me=i.readU8(Re+3),He=Me|Fe<<8|De<<16|Ve<<24;return 12==o?He+t-ve:He}}return 0}}throw new W("Error")},It.stbtt_GetCodepointShape=function(e,t){return It.stbtt_GetGlyphShape(e,It.stbtt_FindGlyphIndex(e,t))},It.stbtt_setvertex=function(e,t,n,i,d,a){e.type=t,e.x=n,e.y=i,e.cx=d,e.cy=a},It.stbtt__GetGlyfOffset=function(e,t){var n,i;if(t>=e.numGlyphs)return-1;if(2<=e.indexToLocFormat)return-1;if(0==e.indexToLocFormat){var d=e.glyf,a=e.data,r=e.loca+2*t;null==r&&(r=0);var s=a.readU8(r),o=a.readU8(r+1);n=d+2*(o|s<<8);var u=e.glyf,l=e.data,_=e.loca+2*t+2;null==_&&(_=0);var f=l.readU8(_),c=l.readU8(_+1);i=u+2*(c|f<<8)}else{var g=e.glyf,p=e.data,h=e.loca+4*t;null==h&&(h=0);var m=h;null==m&&(m=0);var b=p.readU8(m),x=p.readU8(m+1),S=p.readU8(m+2),y=p.readU8(m+3);n=g+(y|S<<8|x<<16|b<<24);var w=e.glyf,T=e.data,E=e.loca+4*t+4;null==E&&(E=0);var C=E;null==C&&(C=0);var I=T.readU8(C),v=T.readU8(C+1),k=T.readU8(C+2),L=T.readU8(C+3);i=w+(L|k<<8|v<<16|I<<24)}return n==i?-1:n},It.stbtt_GetGlyphBox=function(e,t,i){var d=It.stbtt__GetGlyfOffset(e,t);if(0>d)return!1;var a=e.data,r=d+2;null==r&&(r=0);var s=a.readU8(r),o=a.readU8(r+1),u=o|s<<8;i.x0=0==(32768&u)?u:u-65536;var n=e.data,l=d+4;null==l&&(l=0);var _=n.readU8(l),f=n.readU8(l+1),c=f|_<<8;i.y0=0==(32768&c)?c:c-65536;var g=e.data,p=d+6;null==p&&(p=0);var h=g.readU8(p),m=g.readU8(p+1),b=m|h<<8;i.x1=0==(32768&b)?b:b-65536;var x=e.data,S=d+8;null==S&&(S=0);var y=x.readU8(S),w=x.readU8(S+1),T=w|y<<8;return i.y1=0==(32768&T)?T:T-65536,!0},It.stbtt_GetCodepointBox=function(e,t,n){return It.stbtt_GetGlyphBox(e,It.stbtt_FindGlyphIndex(e,t),n)},It.stbtt_IsGlyphEmpty=function(e,t){var i=It.stbtt__GetGlyfOffset(e,t);if(0>i)return!0;var d=e.data,a=i;null==a&&(a=0);var r=d.readU8(a),s=d.readU8(a+1),o=s|r<<8,n=0==(32768&o)?o:o-65536;return 0==n},It.stbtt__close_shape=function(e,t,n,i,d,a,r,s,o,u){return i?(n&&It.stbtt_setvertex(e[t++],3,o+r>>1,u+s>>1,o,u),It.stbtt_setvertex(e[t++],3,d,a,r,s)):n?It.stbtt_setvertex(e[t++],3,d,a,o,u):It.stbtt_setvertex(e[t++],2,d,a,0,0),t},It.copyVertices=function(e,t,n,d){for(var a=0;a<d;){var r=a++;t[n+r]=e[r]}},It.stbtt_GetGlyphShape=function(e,t){var d=e.data,a=null,r=0,s=It.stbtt__GetGlyfOffset(e,t);if(0>s)return null;var o=s;null==o&&(o=0);var u=d.readU8(o),l=d.readU8(o+1),_=l|u<<8,n=0==(32768&_)?_:_-65536;if(0<n){var f=0,c=0,g=0,p=0,h=!1,b=!1,S=s+10,w=S+2*n;null==w&&(w=0);var T=d.readU8(w),E=d.readU8(w+1),C=S+2*n+2+(E|T<<8),I=S+2*n-2;null==I&&(I=0);var k=d.readU8(I),L=d.readU8(I+1),B=1+(L|k<<8),O=B+2*n,m=Array(O);if(a=m,null==a)return null;for(var N=0,A=a.length,P;N<A;)P=N++,a[P]=new yt;g=0;var R=0;p=O-B;for(var V=0,D;V<B;)D=V++,0==R?(f=d.readU8(C++),0!=(8&f)&&(R=d.readU8(C++))):--R,a[p+D].type=f;for(var F=0,M=0,H;M<B;){if(H=M++,f=a[p+H].type,0!=(2&f)){var U=d.readU8(C++);F+=0==(16&f)?-U:U}else if(0==(16&f)){var G=d.readU8(C),z=d.readU8(C+1),X=z|G<<8,Y;Y=0==(32768&X)?X:X-65536,F+=Y,C+=2}a[p+H].x=F}for(var Z=0,K=0,q;K<B;){if(q=K++,f=a[p+q].type,0!=(4&f)){var Q=d.readU8(C++);Z+=0==(32&f)?-Q:Q}else if(0==(32&f)){var J=d.readU8(C),$=d.readU8(C+1),ee=$|J<<8,te;te=0==(32768&ee)?ee:ee-65536,Z+=te,C+=2}a[p+q].y=Z}r=0;for(var ne=0,ie=ne,de=ie,ae=de,re=ae,se=re,oe=0;oe<B;){if(f=a[p+oe].type,F=a[p+oe].x,Z=a[p+oe].y,g==oe){0!=oe&&(r=It.stbtt__close_shape(a,r,h,b,se,re,ie,ne,ae,de)),b=0==(1&f),b?(ie=F,ne=Z,0==(1&a[p+oe+1].type)?(se=F+a[p+oe+1].x>>1,re=Z+a[p+oe+1].y>>1):(se=a[p+oe+1].x,re=a[p+oe+1].y,++oe)):(se=F,re=Z),It.stbtt_setvertex(a[r++],1,se,re,0,0),h=!1;var ue=S+2*c;null==ue&&(ue=0);var le=d.readU8(ue),_e=d.readU8(ue+1);g=1+(_e|le<<8),++c}else 0==(1&f)?(h&&It.stbtt_setvertex(a[r++],3,ae+F>>1,de+Z>>1,ae,de),ae=F,de=Z,h=!0):(h?It.stbtt_setvertex(a[r++],3,F,Z,ae,de):It.stbtt_setvertex(a[r++],2,F,Z,0,0),h=!1);++oe}r=It.stbtt__close_shape(a,r,h,b,se,re,ie,ne,ae,de)}else if(-1==n){var fe=1,ce=s+10;for(r=0,a=null;0!=fe;){var ge=0,pe=null,he=null,me=1,be=0,xe=0,Se=1,ye=0,we=0,Te=ce;null==Te&&(Te=0);var Ee=d.readU8(Te),Ce=d.readU8(Te+1),Ie=Ce|Ee<<8,ve=0==(32768&Ie)?Ie:Ie-65536,ke=ce+=2;null==ke&&(ke=0);var Le=d.readU8(ke),Be=d.readU8(ke+1),Oe=Be|Le<<8,Ne=0==(32768&Oe)?Oe:Oe-65536;if(ce+=2,0==(2&ve))throw new W("Error");else if(0!=(1&ve)){var Ae=ce;null==Ae&&(Ae=0);var Pe=d.readU8(Ae),Re=d.readU8(Ae+1),Ve=Re|Pe<<8;ye=0==(32768&Ve)?Ve:Ve-65536;var De=ce+=2;null==De&&(De=0);var Fe=d.readU8(De),Me=d.readU8(De+1),He=Me|Fe<<8;we=0==(32768&He)?He:He-65536,ce+=2}else{var We=ce;null==We&&(We=0);var Ue=d.readU8(We);ye=128<=Ue?Ue-256:Ue;var Ge=++ce;null==Ge&&(Ge=0);var ze=d.readU8(Ge);we=128<=ze?ze-256:ze,++ce}if(0!=(8&ve)){var Xe=ce;null==Xe&&(Xe=0);var Ye=d.readU8(Xe),je=d.readU8(Xe+1),Ze=je|Ye<<8;Se=(0==(32768&Ze)?Ze:Ze-65536)/16384,me=Se,ce+=2,xe=0,be=xe}else if(0!=(64&ve)){var Ke=ce;null==Ke&&(Ke=0);var qe=d.readU8(Ke),Qe=d.readU8(Ke+1),Je=Qe|qe<<8;me=(0==(32768&Je)?Je:Je-65536)/16384,ce+=2,xe=0,be=xe;var $e=ce;null==$e&&($e=0);var et=d.readU8($e),tt=d.readU8($e+1),nt=tt|et<<8;Se=(0==(32768&nt)?nt:nt-65536)/16384,ce+=2}else if(0!=(128&ve)){var it=ce;null==it&&(it=0);var dt=d.readU8(it),at=d.readU8(it+1),rt=at|dt<<8;me=(0==(32768&rt)?rt:rt-65536)/16384;var st=ce+=2;null==st&&(st=0);var ot=d.readU8(st),ut=d.readU8(st+1),lt=ut|ot<<8;be=(0==(32768&lt)?lt:lt-65536)/16384;var _t=ce+=2;null==_t&&(_t=0);var ft=d.readU8(_t),ct=d.readU8(_t+1),gt=ct|ft<<8;xe=(0==(32768&gt)?gt:gt-65536)/16384;var pt=ce+=2;null==pt&&(pt=0);var ht=d.readU8(pt),mt=d.readU8(pt+1),bt=mt|ht<<8;Se=(0==(32768&bt)?bt:bt-65536)/16384,ce+=2}var xt=Math.sqrt(me*me+be*be),St=Math.sqrt(xe*xe+Se*Se);if(pe=It.stbtt_GetGlyphShape(e,Ne),ge=null==pe?0:pe.length,0<ge){for(var wt=0,Tt=ge;wt<Tt;){var Et=wt++,Ct=pe[Et],v=Ct.x,vt=Ct.y;Ct.x=0|xt*(me*v+xe*vt+ye),Ct.y=0|St*(be*v+Se*vt+we),v=Ct.cx,vt=Ct.cy,Ct.cx=0|xt*(me*v+xe*vt+ye),Ct.cy=0|St*(be*v+Se*vt+we)}var kt=Array(r+ge);if(he=kt,null==he)return null;0<r&&It.copyVertices(a,he,0,r),It.copyVertices(pe,he,r,ge),a=he,r+=ge}fe=32&ve}}else if(0>n)throw new W("Error");if(null==a)return null;if(a.length<r)throw new W("Error");if(r<a.length){var Lt=Array(r),Bt=Lt;return It.copyVertices(a,Bt,0,r),Bt}return a},It.stbtt_GetGlyphHMetrics=function(e,t){var i=e.data,d=e.hhea+34;null==d&&(d=0);var a=i.readU8(d),r=i.readU8(d+1),s=r|a<<8,o=new ft;if(t<s){var u=e.data,l=e.hmtx+4*t;null==l&&(l=0);var _=u.readU8(l),f=u.readU8(l+1),c=f|_<<8;o.advanceWidth=0==(32768&c)?c:c-65536;var n=e.data,g=e.hmtx+4*t+2;null==g&&(g=0);var p=n.readU8(g),h=n.readU8(g+1),m=h|p<<8;o.leftSideBearing=0==(32768&m)?m:m-65536}else{var b=e.data,x=e.hmtx+4*(s-1);null==x&&(x=0);var S=b.readU8(x),y=b.readU8(x+1),w=y|S<<8;o.advanceWidth=0==(32768&w)?w:w-65536;var T=e.data,E=e.hmtx+4*s+2*(t-s);null==E&&(E=0);var C=T.readU8(E),I=T.readU8(E+1),v=I|C<<8;o.leftSideBearing=0==(32768&v)?v:v-65536}return o},It.stbtt_GetGlyphKernAdvance=function(e,t,i){var d=e.kern,a=e.data,s,o;if(0==e.kern)return 0;var u=d+2;null==u&&(u=0);var _=a.readU8(u),f=a.readU8(u+1);if(1>(f|_<<8))return 0;var c=d+8;null==c&&(c=0);var g=a.readU8(c),p=a.readU8(c+1);if(1!=(p|g<<8))return 0;var h=0,b=d+10;null==b&&(b=0);for(var x=a.readU8(b),S=a.readU8(b+1),y=(S|x<<8)-1,w=t<<16|i;h<=y;){o=h+y>>1;var T=d+18+6*o;null==T&&(T=0);var E=T;null==E&&(E=0);var C=a.readU8(E),I=a.readU8(E+1),v=a.readU8(E+2),k=a.readU8(E+3);if(s=k|v<<8|I<<16|C<<24,w<s)y=o-1;else if(w>s)h=o+1;else{var L=d+22+6*o;null==L&&(L=0);var B=a.readU8(L),O=a.readU8(L+1),N=O|B<<8;return 0==(32768&N)?N:N-65536}}return 0},It.stbtt_GetCodepointKernAdvance=function(e,t,n){return 0==e.kern?0:It.stbtt_GetGlyphKernAdvance(e,It.stbtt_FindGlyphIndex(e,t),It.stbtt_FindGlyphIndex(e,n))},It.stbtt_GetCodepointHMetrics=function(e,t){return It.stbtt_GetGlyphHMetrics(e,It.stbtt_FindGlyphIndex(e,t))},It.stbtt_GetFontVMetrics=function(e){var t=new ct,i=e.data,d=e.hhea+4;null==d&&(d=0);var a=i.readU8(d),r=i.readU8(d+1),s=r|a<<8;t.ascent=0==(32768&s)?s:s-65536;var n=e.data,o=e.hhea+6;null==o&&(o=0);var u=n.readU8(o),l=n.readU8(o+1),_=l|u<<8;t.descent=0==(32768&_)?_:_-65536;var f=e.data,c=e.hhea+8;null==c&&(c=0);var g=f.readU8(c),p=f.readU8(c+1),h=p|g<<8;return t.lineGap=0==(32768&h)?h:h-65536,t},It.stbtt_GetFontBoundingBox=function(e){var t=new _t,i=e.data,d=e.head+36;null==d&&(d=0);var a=i.readU8(d),r=i.readU8(d+1),s=r|a<<8;t.x0=0==(32768&s)?s:s-65536;var n=e.data,o=e.head+38;null==o&&(o=0);var u=n.readU8(o),l=n.readU8(o+1),_=l|u<<8;t.y0=0==(32768&_)?_:_-65536;var f=e.data,c=e.head+40;null==c&&(c=0);var g=f.readU8(c),p=f.readU8(c+1),h=p|g<<8;t.x1=0==(32768&h)?h:h-65536;var m=e.data,b=e.head+42;null==b&&(b=0);var x=m.readU8(b),S=m.readU8(b+1),y=S|x<<8;return t.y1=0==(32768&y)?y:y-65536,t},It.stbtt_ScaleForPixelHeight=function(e,t){var i=e.data,d=e.hhea+4;null==d&&(d=0);var a=i.readU8(d),r=i.readU8(d+1),s=r|a<<8,n=e.data,o=e.hhea+6;null==o&&(o=0);var u=n.readU8(o),l=n.readU8(o+1),_=l|u<<8,f=(0==(32768&s)?s:s-65536)-(0==(32768&_)?_:_-65536);return t/f},It.stbtt_ScaleForMappingEmToPixels=function(e,t){var n=e.data,i=e.head+18;null==i&&(i=0);var d=n.readU8(i),a=n.readU8(i+1);return t/(a|d<<8)},It.stbtt_GetGlyphBitmapBoxSubpixel=function(e,t,n,i,d,a){var r=new _t;if(!It.stbtt_GetGlyphBox(e,t,r))r.x0=0,r.y0=0,r.x1=0,r.y1=0;else{var s=r.x0,o=r.x1,u=r.y0,l=r.y1;r.x0=Math.floor(s*n+d),r.y0=Math.floor(-l*i+a),r.x1=Math.ceil(o*n+d),r.y1=Math.ceil(-u*i+a)}return r},It.stbtt_GetGlyphBitmapBox=function(e,t,n,i){return It.stbtt_GetGlyphBitmapBoxSubpixel(e,t,n,i,0,0)},It.stbtt_GetCodepointBitmapBoxSubpixel=function(e,t,n,i,d,a){return It.stbtt_GetGlyphBitmapBoxSubpixel(e,It.stbtt_FindGlyphIndex(e,t),n,i,d,a)},It.stbtt_GetCodepointBitmapBox=function(e,t,n,i){return It.stbtt_GetCodepointBitmapBoxSubpixel(e,t,n,i,0,0)},It.stbtt__new_active=function(t,e,n,i){var d=new Et,a=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==d?d:(d.fdx=a,d.fdy=0==a?0:1/a,d.fx=t[e].x0+a*(i-t[e].y0),d.fx-=n,d.direction=t[e].invert?1:-1,d.sy=t[e].y0,d.ey=t[e].y1,d.next=null,d)},It.stbtt__handle_clipped_edge=function(t,n,i,d,e,a,r,s){if(a!=s){if(!(a<s))throw new W("Error");if(!(d.sy<=d.ey))throw new W("Error");if(!(a>d.ey)&&!(s<d.sy)){if(a<d.sy&&(e+=(r-e)*(d.sy-a)/(s-a),a=d.sy),s>d.ey&&(r+=(r-e)*(d.ey-s)/(s-a),s=d.ey),e==i){if(!(r<=i+1))throw new W("Error");}else if(e==i+1){if(!(r>=i))throw new W("Error");}else if(e<=i){if(!(r<=i))throw new W("Error");}else if(e>=i+1){if(!(r>=i+1))throw new W("Error");}else if(!(r>=i&&r<=i+1))throw new W("Error");if(e<=i&&r<=i){t[n+i]+=d.direction*(s-a)}else if(!(e>=i+1&&r>=i+1)){if(!(e>=i&&e<=i+1&&r>=i&&r<=i+1))throw new W("Error");t[n+i]+=d.direction*(s-a)*(1-(e-i+(r-i))/2)}}}},It.stbtt__fill_active_edges_new=function(n,i,d,a,r,s){for(var o=s+1;null!=r;){if(!(r.ey>=s))throw new W("Error");if(0==r.fdx){var u=r.fx;u<a&&(0<=u?(It.stbtt__handle_clipped_edge(n,0,0|u,r,u,s,u,o),It.stbtt__handle_clipped_edge(i,d-1,0|u+1,r,u,s,u,o)):It.stbtt__handle_clipped_edge(i,d-1,0,r,u,s,u,o))}else{var l=r.fx,_=r.fdx,f=l+_,c=r.fdy,g,p,h,m;if(!(r.sy<=o&&r.ey>=s))throw new W("Error");if(r.sy>s?(g=l+_*(r.sy-s),h=r.sy):(g=l,h=s),r.ey<o?(p=l+_*(r.ey-s),m=r.ey):(p=f,m=o),!(0<=g&&0<=p&&g<a&&p<a))for(var b=0;b<a;){var S=b++,y=s,w=S,T=S+1,E=f,C=o,I=(S-l)/_+s,v=(S+1-l)/_+s;l<w&&E>T?(It.stbtt__handle_clipped_edge(n,0,S,r,l,y,w,I),It.stbtt__handle_clipped_edge(n,0,S,r,w,I,T,v),It.stbtt__handle_clipped_edge(n,0,S,r,T,v,E,C)):E<w&&l>T?(It.stbtt__handle_clipped_edge(n,0,S,r,l,y,T,v),It.stbtt__handle_clipped_edge(n,0,S,r,T,v,w,I),It.stbtt__handle_clipped_edge(n,0,S,r,w,I,E,C)):l<w&&E>w?(It.stbtt__handle_clipped_edge(n,0,S,r,l,y,w,I),It.stbtt__handle_clipped_edge(n,0,S,r,w,I,E,C)):E<w&&l>w?(It.stbtt__handle_clipped_edge(n,0,S,r,l,y,w,I),It.stbtt__handle_clipped_edge(n,0,S,r,w,I,E,C)):l<T&&E>T?(It.stbtt__handle_clipped_edge(n,0,S,r,l,y,T,v),It.stbtt__handle_clipped_edge(n,0,S,r,T,v,E,C)):E<T&&l>T?(It.stbtt__handle_clipped_edge(n,0,S,r,l,y,T,v),It.stbtt__handle_clipped_edge(n,0,S,r,T,v,E,C)):It.stbtt__handle_clipped_edge(n,0,S,r,l,y,E,C)}else if((0|g)==(0|p)){var k=0|g,x=m-h;if(!(0<=k&&k<a))throw new W("Error");n[k]+=r.direction*(1-(g-k+(p-k))/2)*x;i[d+k]+=r.direction*x}else{if(g>p){h=o-(h-s),m=o-(m-s);var L=h;h=m,m=L,L=p,p=g,g=L,_=-_,c=-c,L=l,l=f,f=L}var B=0|g,O=0|p,N=(B+1-l)*c+s,A=r.direction,P=A*(N-h);n[B]+=P*(1-(g-B+(B+1-B))/2);for(var R=A*c,V=B+1;V<O;){var D=V++;n[D]+=P+R/2,P+=R}if(N+=c*(O-(B+1)),!(1.01>=Math.abs(P)))throw new W("Error");n[O]+=P+A*(1-(O-O+(p-O))/2)*(m-N);i[d+O]+=A*(m-h)}}r=r.next}},It.stbtt__rasterize_sorted_edges=function(t,d,e,n,a,r){var s=null,o=0,u=0,l=0,_;if(64<t.w){var f=Array(2*t.w+1);_=f}else{var c=Array(129);_=c}var g=_;u=t.w;var p=r;for(d[l+e].y0=r+t.h+1;o<t.h;){for(var h=p+0,b=p+1,x=s,S=null,w=0,T=t.w;w<T;){var E=w++;_[E]=0}for(var i=0,C=t.w+1;i<C;){var I=i++;g[u+I]=0}for(;null!=x;){var v=x;if(v.ey<=h){if(null==S?(s=v.next,x=v.next):(S.next=v.next,x=v.next),0==v.direction)throw new W("Error");v.direction=0}else S=x,x=x.next}for(;d[l].y0<=b;){if(d[l].y0!=d[l].y1){var L=It.stbtt__new_active(d,l,a,h);if(!(L.ey>=h))throw new W("Error");L.next=s,s=L}++l}null!=s&&It.stbtt__fill_active_edges_new(_,g,u+1,t.w,s,h);for(var B=0,O=0,N=t.w;O<N;){var A=O++;B+=g[u+A];var P=_[A]+B;P=255*Math.abs(P)+.5;var R=0|P;255<R&&(R=255),t.pixels.writeU8(t.pixels_offset+o*t.stride+A,R)}for(S=null,x=s;null!=x;){var V=x;V.fx+=V.fdx,S=x,x=x.next}++p,++o}},It.STBTT__COMPARE=function(e,t){return e.y0<t.y0},It.stbtt__sort_edges_ins_sort=function(e,i){for(var n=1,d;n<i;){var a=n++,r=e[a];for(d=a;0<d;){var t=e[d-1],s=It.STBTT__COMPARE(r,t);if(!s)break;e[d]=e[d-1],--d}a!=d&&(e[d]=r)}},It.stbtt__sort_edges_quicksort=function(e,d,a){for(;12<a;){var r=a>>1,s=It.STBTT__COMPARE(e[d],e[d+r]),o=It.STBTT__COMPARE(e[d+r],e[d+a-1]),u,l;if(s!=o){l=It.STBTT__COMPARE(e[d],e[d+a-1]);var _=l==o?0:a-1;u=e[d+_],e[d+_]=e[d+r],e[d+r]=u}u=e[d],e[d]=e[d+r],e[d+r]=u;for(var f=1,g=a-1;;){for(;It.STBTT__COMPARE(e[d+f],e[d]);)++f;for(;It.STBTT__COMPARE(e[d],e[d+g]);)--g;if(f>=g)break;u=e[d+f],e[d+f]=e[d+g],e[d+g]=u,++f,--g}g<a-f?(It.stbtt__sort_edges_quicksort(e,d,g),d+=f,a-=f):(It.stbtt__sort_edges_quicksort(e,d+f,a-f),a=g)}},It.stbtt__sort_edges=function(e,t){It.stbtt__sort_edges_quicksort(e,0,t),It.stbtt__sort_edges_ins_sort(e,t)},It.stbtt__rasterize=function(t,i,d,r,s,o,u,l,_,f,c){for(var g=c?-o:o,h=1,x=0,S=0,y=0,w;y<r;){var T=y++;S+=d[T]}var E=Array(S+1),C=E;if(null!=C){for(var e=0,I=C.length,v;e<I;)v=e++,C[v]=new Tt;S=0;for(var k=0,L=0;L<r;){var B=L++,O=i,p=x+k;k+=d[B],w=d[B]-1;for(var N=0,A=d[B];N<A;){var P=N++,R=P,V=w;if(O[p+w].y==O[p+P].y){w=P;continue}C[S].invert=!1,(c?O[p+w].y>O[p+P].y:O[p+w].y<O[p+P].y)&&(C[S].invert=!0,R=w,V=P),C[S].x0=O[p+R].x*s+u,C[S].y0=(O[p+R].y*g+l)*h,C[S].x1=O[p+V].x*s+u,C[S].y1=(O[p+V].y*g+l)*h,++S,w=P}}It.stbtt__sort_edges(C,S),It.stbtt__rasterize_sorted_edges(t,C,S,h,_,f)}},It.stbtt__add_point=function(e,t,n,i){null==e||(e[t].x=n,e[t].y=i)},It.stbtt__tesselate_curve=function(e,t,i,d,a,r,s,o,u,l){var n=(i+2*a+s)/4,_=(d+2*r+o)/4,f=(i+s)/2-n,c=(d+o)/2-_;return 16<l?1:(f*f+c*c>u?(It.stbtt__tesselate_curve(e,t,i,d,(i+a)/2,(d+r)/2,n,_,u,l+1),It.stbtt__tesselate_curve(e,t,n,_,(a+s)/2,(r+o)/2,s,o,u,l+1)):(It.stbtt__add_point(e,t.value,s,o),t.value+=1),1)},It.stbtt_FlattenCurves=function(e,t,i,d,a){for(var r=null,s=0,o=i*i,u=0,l=0,_=0,f;_<t;)f=_++,1==e[f].type&&++u;if(a.value=u,0==u)return null;var c=Array(u);if(d.value=c,null==d.value)return a.value=0,null;for(var g=0;2>g;){var p=g++,h=0,m=0;if(1==p){var b=Array(s);if(r=b,null==r)return d.value=null,a.value=0,null;for(var S=0,w=r.length,T;S<w;)T=S++,r[T]=new Ct}s=0,u=-1;for(var E=0,C;E<t;)switch(C=E++,e[C].type){case 1:0<=u&&(d.value[u]=s-l),++u,l=s,h=e[C].x,m=e[C].y,It.stbtt__add_point(r,s++,h,m);break;case 2:h=e[C].x,m=e[C].y,It.stbtt__add_point(r,s++,h,m);break;case 3:var I={value:s};It.stbtt__tesselate_curve(r,I,h,m,e[C].cx,e[C].cy,e[C].x,e[C].y,o,0),s=I.value,h=e[C].x,m=e[C].y;}d.value[u]=s-l}return r},It.stbtt_Rasterize=function(e,t,n,i,d,a,r,s,o,u,l){var _=d>a?a:d,f=0,c=null,g={value:f},p=new lt,h=It.stbtt_FlattenCurves(n,i,t/_,p,g);f=g.value,c=p.value,null!=h&&It.stbtt__rasterize(e,h,c,f,d,a,r,s,o,u,l)},It.stbtt_GetGlyphBitmapSubpixel=function(e,t,n,i,d,a,r){var s=new wt,o=It.stbtt_GetGlyphShape(e,a),u=o.length;if(0==t&&(t=n),0==n){if(0==t)return null;n=t}var l=It.stbtt_GetGlyphBitmapBoxSubpixel(e,a,t,n,i,d),_=l.x0,f=l.y0,c=l.x1,g=l.y1;return s.w=c-_,s.h=g-f,s.pixels=null,r.width=s.w,r.height=s.h,r.xoff=_,r.yoff=f,0!=s.w&&0!=s.h&&(s.pixels=nn.alloc(s.w*s.h),null!=s.pixels&&(s.stride=s.w,It.stbtt_Rasterize(s,.35,o,u,t,n,i,d,_,f,!0))),s.pixels},It.stbtt_GetGlyphBitmap=function(e,t,n,i,d){return It.stbtt_GetGlyphBitmapSubpixel(e,t,n,0,0,i,d)},It.stbtt_MakeGlyphBitmapSubpixel=function(e,t,n,i,d,a,r,s,o,u,l){var _=0,f=0,c=It.stbtt_GetGlyphShape(e,l),g=null==c?0:c.length,p=new wt,h=It.stbtt_GetGlyphBitmapBoxSubpixel(e,l,r,s,o,u);_=h.x0,f=h.y0,p.pixels=t,p.pixels_offset=n,p.w=i,p.h=d,p.stride=a,0!=p.w&&0!=p.h&&It.stbtt_Rasterize(p,.35,c,g,r,s,o,u,_,f,!0)},It.stbtt_MakeGlyphBitmap=function(e,t,n,i,d,a,r,s,o){It.stbtt_MakeGlyphBitmapSubpixel(e,t,n,i,d,a,r,s,0,0,o)},It.stbtt_GetCodepointBitmapSubpixel=function(e,t,n,i,d,a,r){return It.stbtt_GetGlyphBitmapSubpixel(e,t,n,i,d,It.stbtt_FindGlyphIndex(e,a),r)},It.stbtt_MakeCodepointBitmapSubpixel=function(e,t,n,i,d,a,r,s,o,u,l){It.stbtt_MakeGlyphBitmapSubpixel(e,t,n,i,d,a,r,s,o,u,It.stbtt_FindGlyphIndex(e,l))},It.stbtt_GetCodepointBitmap=function(e,t,n,i,d){return It.stbtt_GetCodepointBitmapSubpixel(e,t,n,0,0,i,d)},It.stbtt_MakeCodepointBitmap=function(e,t,n,i,d,a,r,s,o){It.stbtt_MakeCodepointBitmapSubpixel(e,t,n,i,d,a,r,s,0,0,o)},It.stbtt_BakeFontBitmap=function(e,t,n,d,a,r,s,o){var u=new St;if(!It.stbtt_InitFont(u,e,t))return-1;for(var l=1,_=l,f=1,c=It.stbtt_ScaleForPixelHeight(u,n),p=0,h=0,m;h<s.length;){m=s[h],++h;var b=It.stbtt_FindGlyphIndex(u,m),g=It.stbtt_GetGlyphHMetrics(u,b),S=g.advanceWidth,w=g.leftSideBearing,T=It.stbtt_GetGlyphBitmapBox(u,b,c,c),E=T.x0,C=T.y0,I=T.x1,v=T.y1,k=I-E,L=v-C;if(_+k+1>=a&&(l=f,_=1),l+L+1>=r)return-p;if(_+k>=a)throw new W("Error");if(l+L>=r)throw new W("Error");o[p].x0=_,o[p].y0=l,o[p].x1=_+k,o[p].y1=l+L,o[p].xadvance=c*S,o[p].xoff=E,o[p].yoff=C,_=_+k+1,l+L+1>f&&(f=l+L+1),++p}for(var B=0;B<a*r;){var O=B++;d.writeU8(O,0)}p=0;for(var N=0,A;N<s.length;){var P=s[N];++N;var R=It.stbtt_FindGlyphIndex(u,P);A=o[p],It.stbtt_MakeGlyphBitmap(u,d,A.x0+A.y0*a,A.x1-A.x0,A.y1-A.y0,a,c,c,R),++p}return f},It.stbtt_GetBakedQuad=function(e,t,n,i,d,a,r,s){var o=s?0:-.5,u=1/t,l=1/n,_=e[i],f=Math.floor(d.value+_.xoff+.5),c=Math.floor(a.value+_.yoff+.5);r.x0=f+o,r.y0=c+o,r.x1=f+_.x1-_.x0+o,r.y1=c+_.y1-_.y0+o,r.s0=_.x0*u,r.t0=_.y0*l,r.s1=_.x1*u,r.t1=_.y1*l,d.value+=_.xadvance};var vt=function(){};s["kha.graphics4.ConstantLocation"]=vt,vt.__name__=!0,vt.__isInterface__=!0;var kt=function(e){this.texture_=e};s["kha.graphics4.CubeMap"]=kt,kt.__name__=!0,kt.__interfaces__=[ie,q],kt.getRenderTargetFormat=function(e){return 0===e?0:2===e?3:3===e?4:4===e?1:0},kt.getDepthBufferBits=function(e){return 0===e?-1:1===e?24:2===e?24:3===e?24:4===e?32:5===e?16:void 0},kt.getStencilBufferBits=function(e){return 0===e?-1:1===e?-1:2===e?8:3===e?8:4===e?8:5===e?0:void 0},kt.getTextureFormat=function(e){return 0===e?0:2===e?3:4===e?4:5===e?5:1},kt.createRenderTarget=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0);var d=new kt(null);return d.format=t,d.renderTarget_=Krom.createRenderTargetCubeMap(e,kt.getDepthBufferBits(n),kt.getRenderTargetFormat(t),kt.getStencilBufferBits(n),i),d},kt.prototype={texture_:null,renderTarget_:null,format:null,graphics4:null,unload:function(){},lock:function(e){return null==e&&(e=0),null},unlock:function(){},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},g1:null,get_g1:function(){return null},g2:null,get_g2:function(){return null},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new dn(this)),this.graphics4},__class__:kt};var Lt=function(e,t){null!=e&&(this.shader=Krom.createFragmentShader(e[0].bytes.b.bufferValue,t[0]))};s["kha.graphics4.FragmentShader"]=Lt,Lt.__name__=!0,Lt.fromSource=function(e){var t=new Lt(null,null);return t.shader=Krom.createFragmentShaderFromSource(e),t},Lt.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Lt};var Bt=function(e,t){this.shader=Krom.createGeometryShader(e[0].bytes.b.bufferValue,t[0])};s["kha.graphics4.GeometryShader"]=Bt,Bt.__name__=!0,Bt.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Bt};var Ot=function(){};s["kha.graphics4.Graphics"]=Ot,Ot.__name__=!0,Ot.__isInterface__=!0,Ot.prototype={begin:null,beginFace:null,beginEye:null,end:null,vsynced:null,refreshRate:null,clear:null,viewport:null,scissor:null,disableScissor:null,setVertexBuffer:null,setVertexBuffers:null,setIndexBuffer:null,setTexture:null,setTextureDepth:null,setTextureArray:null,setVideoTexture:null,setImageTexture:null,setTextureParameters:null,setTexture3DParameters:null,setTextureCompareMode:null,setCubeMapCompareMode:null,setCubeMap:null,setCubeMapDepth:null,setStencilReferenceValue:null,instancedRenderingAvailable:null,setPipeline:null,setBool:null,setInt:null,setInt2:null,setInt3:null,setInt4:null,setInts:null,setFloat:null,setFloat2:null,setFloat3:null,setFloat4:null,setFloats:null,setVector2:null,setVector3:null,setVector4:null,setMatrix:null,setMatrix3:null,drawIndexedVertices:null,drawIndexedVerticesInstanced:null,flush:null,__class__:Ot};var Nt=function(e){this.pipeline=e;try{this.projectionLocation=e.getConstantLocation("projectionMatrix")}catch(e){w.trace(e instanceof W?e.val:e,{fileName:"kha/graphics4/Graphics2.hx",lineNumber:39,className:"kha.graphics4.PipelineCache",methodName:"new"})}try{this.textureLocation=e.getTextureUnit("tex")}catch(e){w.trace(e instanceof W?e.val:e,{fileName:"kha/graphics4/Graphics2.hx",lineNumber:40,className:"kha.graphics4.PipelineCache",methodName:"new"})}};s["kha.graphics4.PipelineCache"]=Nt,Nt.__name__=!0,Nt.prototype={pipeline:null,projectionLocation:null,textureLocation:null,__class__:Nt};var At=function(e){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=e,At.bufferIndex=0,At.initShaders(),this.myPipeline=At.standardImagePipeline,this.initBuffers()};s["kha.graphics4.ImageShaderPainter"]=At,At.__name__=!0,At.initShaders=function(){if(null==At.structure&&(At.structure=Vt.createImageVertexStructure()),null==At.standardImagePipeline){var e=Vt.createImagePipeline(At.structure);e.compile(),At.standardImagePipeline=new Nt(e)}},At.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(e){return this.myPipeline=null==e?At.standardImagePipeline:e,this.myPipeline},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==At.rectVertexBuffer){At.rectVertexBuffer=new zt(6e3,At.structure,1),At.rectVertices=At.rectVertexBuffer.lock(),At.indexBuffer=new Dt(9e3,0);for(var e=At.indexBuffer.lock(),t=0;1500>t;){var n=t++;e[2*(3*n)]=4*n,e[2*(3*n)+1]=4*n+1,e[2*(3*n)+2]=4*n+2,e[2*(3*n)+3]=4*n,e[2*(3*n)+4]=4*n+2,e[2*(3*n)+5]=4*n+3}At.indexBuffer.unlock()}},setRectVertices:function(e,t,n,i,d,a,r,s){var o=4*(9*At.bufferIndex);At.rectVertices[o]=e,At.rectVertices[o+1]=t,At.rectVertices[o+2]=-5,At.rectVertices[o+9]=n,At.rectVertices[o+10]=i,At.rectVertices[o+11]=-5,At.rectVertices[o+18]=d,At.rectVertices[o+19]=a,At.rectVertices[o+20]=-5,At.rectVertices[o+27]=r,At.rectVertices[o+28]=s,At.rectVertices[o+29]=-5},setRectTexCoords:function(e,t,n,i){var d=4*(9*At.bufferIndex);At.rectVertices[d+3]=e,At.rectVertices[d+4]=i,At.rectVertices[d+12]=e,At.rectVertices[d+13]=t,At.rectVertices[d+21]=n,At.rectVertices[d+22]=t,At.rectVertices[d+30]=n,At.rectVertices[d+31]=i},setRectColor:function(e,t,n,i){var d=4*(9*At.bufferIndex);At.rectVertices[d+5]=e,At.rectVertices[d+6]=t,At.rectVertices[d+7]=n,At.rectVertices[d+8]=i,At.rectVertices[d+14]=e,At.rectVertices[d+15]=t,At.rectVertices[d+16]=n,At.rectVertices[d+17]=i,At.rectVertices[d+23]=e,At.rectVertices[d+24]=t,At.rectVertices[d+25]=n,At.rectVertices[d+26]=i,At.rectVertices[d+32]=e,At.rectVertices[d+33]=t,At.rectVertices[d+34]=n,At.rectVertices[d+35]=i},drawBuffer:function(){At.rectVertexBuffer.unlock(4*At.bufferIndex),this.g.setVertexBuffer(At.rectVertexBuffer),this.g.setIndexBuffer(At.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,At.lastTexture),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,this.bilinearMipmaps?2:0),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*(2*At.bufferIndex)),this.g.setTexture(this.myPipeline.textureLocation,null),At.bufferIndex=0,At.rectVertices=At.rectVertexBuffer.lock()},setBilinearFilter:function(e){this.end(),this.bilinear=e},setBilinearMipmapFilter:function(e){this.end(),this.bilinearMipmaps=e},drawImage:function(e,t,n,i,d,s,o,u,l,_,f){var c=e;(1500<=At.bufferIndex+1||null!=At.lastTexture&&c!=At.lastTexture)&&this.drawBuffer();var p=.00392156862745098*((16711680&f)>>>16),r=.00392156862745098*((65280&f)>>>8),g=.00392156862745098*(255&f),h=.00392156862745098*(f>>>24)*_,a=4*(9*At.bufferIndex);At.rectVertices[a+5]=p,At.rectVertices[a+6]=r,At.rectVertices[a+7]=g,At.rectVertices[a+8]=h,At.rectVertices[a+14]=p,At.rectVertices[a+15]=r,At.rectVertices[a+16]=g,At.rectVertices[a+17]=h,At.rectVertices[a+23]=p,At.rectVertices[a+24]=r,At.rectVertices[a+25]=g,At.rectVertices[a+26]=h,At.rectVertices[a+32]=p,At.rectVertices[a+33]=r,At.rectVertices[a+34]=g,At.rectVertices[a+35]=h;var m=c.get_width()/c.get_realWidth(),b=c.get_height()/c.get_realHeight(),x=4*(9*At.bufferIndex);At.rectVertices[x+3]=0,At.rectVertices[x+4]=b,At.rectVertices[x+12]=0,At.rectVertices[x+13]=0,At.rectVertices[x+21]=m,At.rectVertices[x+22]=0,At.rectVertices[x+30]=m,At.rectVertices[x+31]=b;var S=4*(9*At.bufferIndex);At.rectVertices[S]=t,At.rectVertices[S+1]=n,At.rectVertices[S+2]=-5,At.rectVertices[S+9]=i,At.rectVertices[S+10]=d,At.rectVertices[S+11]=-5,At.rectVertices[S+18]=s,At.rectVertices[S+19]=o,At.rectVertices[S+20]=-5,At.rectVertices[S+27]=u,At.rectVertices[S+28]=l,At.rectVertices[S+29]=-5,++At.bufferIndex,At.lastTexture=c},drawImage2:function(e,t,n,i,d,s,o,u,l,_,f,c,p,h,m){var x=e;(1500<=At.bufferIndex+1||null!=At.lastTexture&&x!=At.lastTexture)&&this.drawBuffer();var S=t/x.get_realWidth(),y=n/x.get_realHeight(),w=(t+i)/x.get_realWidth(),T=(n+d)/x.get_realHeight(),E=4*(9*At.bufferIndex);At.rectVertices[E+3]=S,At.rectVertices[E+4]=T,At.rectVertices[E+12]=S,At.rectVertices[E+13]=y,At.rectVertices[E+21]=w,At.rectVertices[E+22]=y,At.rectVertices[E+30]=w,At.rectVertices[E+31]=T;var C=.00392156862745098*((16711680&m)>>>16),r=.00392156862745098*((65280&m)>>>8),g=.00392156862745098*(255&m),b=.00392156862745098*(m>>>24)*h,a=4*(9*At.bufferIndex);At.rectVertices[a+5]=C,At.rectVertices[a+6]=r,At.rectVertices[a+7]=g,At.rectVertices[a+8]=b,At.rectVertices[a+14]=C,At.rectVertices[a+15]=r,At.rectVertices[a+16]=g,At.rectVertices[a+17]=b,At.rectVertices[a+23]=C,At.rectVertices[a+24]=r,At.rectVertices[a+25]=g,At.rectVertices[a+26]=b,At.rectVertices[a+32]=C,At.rectVertices[a+33]=r,At.rectVertices[a+34]=g,At.rectVertices[a+35]=b;var I=4*(9*At.bufferIndex);At.rectVertices[I]=s,At.rectVertices[I+1]=o,At.rectVertices[I+2]=-5,At.rectVertices[I+9]=u,At.rectVertices[I+10]=l,At.rectVertices[I+11]=-5,At.rectVertices[I+18]=_,At.rectVertices[I+19]=f,At.rectVertices[I+20]=-5,At.rectVertices[I+27]=c,At.rectVertices[I+28]=p,At.rectVertices[I+29]=-5,++At.bufferIndex,At.lastTexture=x},drawImageScale:function(e,t,n,i,d,a,s,o,u,l,_){var f=e;(1500<=At.bufferIndex+1||null!=At.lastTexture&&f!=At.lastTexture)&&this.drawBuffer();var c=t/f.get_realWidth(),p=n/f.get_realHeight(),h=(t+i)/f.get_realWidth(),m=(n+d)/f.get_realHeight(),x=4*(9*At.bufferIndex);At.rectVertices[x+3]=c,At.rectVertices[x+4]=m,At.rectVertices[x+12]=c,At.rectVertices[x+13]=p,At.rectVertices[x+21]=h,At.rectVertices[x+22]=p,At.rectVertices[x+30]=h,At.rectVertices[x+31]=m;var S=.00392156862745098*((16711680&_)>>>16),r=.00392156862745098*((65280&_)>>>8),g=.00392156862745098*(255&_),b=4*(9*At.bufferIndex);At.rectVertices[b+5]=S,At.rectVertices[b+6]=r,At.rectVertices[b+7]=g,At.rectVertices[b+8]=l,At.rectVertices[b+14]=S,At.rectVertices[b+15]=r,At.rectVertices[b+16]=g,At.rectVertices[b+17]=l,At.rectVertices[b+23]=S,At.rectVertices[b+24]=r,At.rectVertices[b+25]=g,At.rectVertices[b+26]=l,At.rectVertices[b+32]=S,At.rectVertices[b+33]=r,At.rectVertices[b+34]=g,At.rectVertices[b+35]=l;var y=4*(9*At.bufferIndex);At.rectVertices[y]=a,At.rectVertices[y+1]=u,At.rectVertices[y+2]=-5,At.rectVertices[y+9]=a,At.rectVertices[y+10]=s,At.rectVertices[y+11]=-5,At.rectVertices[y+18]=o,At.rectVertices[y+19]=s,At.rectVertices[y+20]=-5,At.rectVertices[y+27]=o,At.rectVertices[y+28]=u,At.rectVertices[y+29]=-5,++At.bufferIndex,At.lastTexture=f},end:function(){0<At.bufferIndex&&this.drawBuffer(),At.lastTexture=null},__class__:At};var Pt=function(e){this.myPipeline=null,this.g=e,Pt.bufferIndex=0,Pt.triangleBufferIndex=0,Pt.initShaders(),this.myPipeline=Pt.standardColorPipeline,this.initBuffers()};s["kha.graphics4.ColoredShaderPainter"]=Pt,Pt.__name__=!0,Pt.initShaders=function(){if(null==Pt.structure&&(Pt.structure=Vt.createColoredVertexStructure()),null==Pt.standardColorPipeline){var e=Vt.createColoredPipeline(Pt.structure);e.compile(),Pt.standardColorPipeline=new Nt(e)}},Pt.prototype={projectionMatrix:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(e){return this.myPipeline=null==e?Pt.standardColorPipeline:e,this.myPipeline},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==Pt.rectVertexBuffer){Pt.rectVertexBuffer=new zt(4e3,Pt.structure,1),Pt.rectVertices=Pt.rectVertexBuffer.lock(),Pt.indexBuffer=new Dt(6e3,0);for(var e=Pt.indexBuffer.lock(),t=0;1e3>t;){var n=t++;e[2*(3*n)]=4*n,e[2*(3*n)+1]=4*n+1,e[2*(3*n)+2]=4*n+2,e[2*(3*n)+3]=4*n,e[2*(3*n)+4]=4*n+2,e[2*(3*n)+5]=4*n+3}Pt.indexBuffer.unlock(),Pt.triangleVertexBuffer=new zt(3e3,Pt.structure,1),Pt.triangleVertices=Pt.triangleVertexBuffer.lock(),Pt.triangleIndexBuffer=new Dt(3e3,0);for(var i=Pt.triangleIndexBuffer.lock(),d=0;1e3>d;){var a=d++;i[3*a]=3*a,i[3*a+1]=3*a+1,i[3*a+2]=3*a+2}Pt.triangleIndexBuffer.unlock()}},setRectVertices:function(e,t,n,i,d,a,r,s){var o=4*(7*Pt.bufferIndex);Pt.rectVertices[o]=e,Pt.rectVertices[o+1]=t,Pt.rectVertices[o+2]=-5,Pt.rectVertices[o+7]=n,Pt.rectVertices[o+8]=i,Pt.rectVertices[o+9]=-5,Pt.rectVertices[o+14]=d,Pt.rectVertices[o+15]=a,Pt.rectVertices[o+16]=-5,Pt.rectVertices[o+21]=r,Pt.rectVertices[o+22]=s,Pt.rectVertices[o+23]=-5},setRectColors:function(e,t){var n=4*(7*Pt.bufferIndex),i=e*(.00392156862745098*(t>>>24)),d=i*(.00392156862745098*((16711680&t)>>>16)),a=i*(.00392156862745098*((65280&t)>>>8)),r=i*(.00392156862745098*(255&t));Pt.rectVertices[n+3]=d,Pt.rectVertices[n+4]=a,Pt.rectVertices[n+5]=r,Pt.rectVertices[n+6]=i,Pt.rectVertices[n+10]=d,Pt.rectVertices[n+11]=a,Pt.rectVertices[n+12]=r,Pt.rectVertices[n+13]=i,Pt.rectVertices[n+17]=d,Pt.rectVertices[n+18]=a,Pt.rectVertices[n+19]=r,Pt.rectVertices[n+20]=i,Pt.rectVertices[n+24]=d,Pt.rectVertices[n+25]=a,Pt.rectVertices[n+26]=r,Pt.rectVertices[n+27]=i},setTriVertices:function(e,t,n,i,d,a){var r=3*(7*Pt.triangleBufferIndex);Pt.triangleVertices[r]=e,Pt.triangleVertices[r+1]=t,Pt.triangleVertices[r+2]=-5,Pt.triangleVertices[r+7]=n,Pt.triangleVertices[r+8]=i,Pt.triangleVertices[r+9]=-5,Pt.triangleVertices[r+14]=d,Pt.triangleVertices[r+15]=a,Pt.triangleVertices[r+16]=-5},setTriColors:function(e,t){var n=3*(7*Pt.triangleBufferIndex),i=e*(.00392156862745098*(t>>>24)),d=i*(.00392156862745098*((16711680&t)>>>16)),a=i*(.00392156862745098*((65280&t)>>>8)),r=i*(.00392156862745098*(255&t));Pt.triangleVertices[n+3]=d,Pt.triangleVertices[n+4]=a,Pt.triangleVertices[n+5]=r,Pt.triangleVertices[n+6]=i,Pt.triangleVertices[n+10]=d,Pt.triangleVertices[n+11]=a,Pt.triangleVertices[n+12]=r,Pt.triangleVertices[n+13]=i,Pt.triangleVertices[n+17]=d,Pt.triangleVertices[n+18]=a,Pt.triangleVertices[n+19]=r,Pt.triangleVertices[n+20]=i},drawBuffer:function(e){!e&&0<Pt.triangleBufferIndex&&this.drawTriBuffer(!0),Pt.rectVertexBuffer.unlock(4*Pt.bufferIndex),this.g.setVertexBuffer(Pt.rectVertexBuffer),this.g.setIndexBuffer(Pt.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*(2*Pt.bufferIndex)),Pt.bufferIndex=0,Pt.rectVertices=Pt.rectVertexBuffer.lock()},drawTriBuffer:function(e){!e&&0<Pt.bufferIndex&&this.drawBuffer(!0),Pt.triangleVertexBuffer.unlock(3*Pt.triangleBufferIndex),this.g.setVertexBuffer(Pt.triangleVertexBuffer),this.g.setIndexBuffer(Pt.triangleIndexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Pt.triangleBufferIndex),Pt.triangleBufferIndex=0,Pt.triangleVertices=Pt.triangleVertexBuffer.lock()},fillRect:function(e,t,n,i,d,a,r,s,o,u){0<Pt.triangleBufferIndex&&this.drawTriBuffer(!0),1e3<=Pt.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(e,t),this.setRectVertices(n,i,d,a,r,s,o,u),++Pt.bufferIndex},fillTriangle:function(e,t,n,i,d,a,r,s){0<Pt.bufferIndex&&this.drawBuffer(!0),1e3<=Pt.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(e,t),this.setTriVertices(n,i,d,a,r,s),++Pt.triangleBufferIndex},endTris:function(e){0<Pt.triangleBufferIndex&&this.drawTriBuffer(e)},endRects:function(e){0<Pt.bufferIndex&&this.drawBuffer(e)},end:function(){0<Pt.triangleBufferIndex&&this.drawTriBuffer(!1),0<Pt.bufferIndex&&this.drawBuffer(!1)},__class__:Pt};var Rt=function(e){this.bakedQuadCache=new ae,this.bilinear=!1,this.myPipeline=null,this.g=e,Rt.bufferIndex=0,Rt.initShaders(),this.myPipeline=Rt.standardTextPipeline,this.initBuffers()};s["kha.graphics4.TextShaderPainter"]=Rt,Rt.__name__=!0,Rt.initShaders=function(){if(null==Rt.structure&&(Rt.structure=Vt.createTextVertexStructure()),null==Rt.standardTextPipeline){var e=Vt.createTextPipeline(Rt.structure);e.compile(),Rt.standardTextPipeline=new Nt(e)}},Rt.findIndex=function(e){for(var t=st.fontGlyphs,n=re.charBlocks,d=0,a=0,r=0|n.length/2;a<r;){var s=a++,i=n[2*s],o=n[2*s+1];if(e>=i&&e<=o)return d+e-i;d+=o-i+1}return 0},Rt.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,fontSize:null,bilinear:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(e){return this.myPipeline=null==e?Rt.standardTextPipeline:e,this.myPipeline},setProjection:function(e){this.projectionMatrix=e},initBuffers:function(){if(null==Rt.rectVertexBuffer){Rt.rectVertexBuffer=new zt(4e3,Rt.structure,1),Rt.rectVertices=Rt.rectVertexBuffer.lock(),Rt.indexBuffer=new Dt(6e3,0);for(var e=Rt.indexBuffer.lock(),t=0;1e3>t;){var n=t++;e[2*(3*n)]=4*n,e[2*(3*n)+1]=4*n+1,e[2*(3*n)+2]=4*n+2,e[2*(3*n)+3]=4*n,e[2*(3*n)+4]=4*n+2,e[2*(3*n)+5]=4*n+3}Rt.indexBuffer.unlock()}},setRectVertices:function(e,t,n,i,d,a,r,s){var o=4*(9*Rt.bufferIndex);Rt.rectVertices[o]=e,Rt.rectVertices[o+1]=t,Rt.rectVertices[o+2]=-5,Rt.rectVertices[o+9]=n,Rt.rectVertices[o+10]=i,Rt.rectVertices[o+11]=-5,Rt.rectVertices[o+18]=d,Rt.rectVertices[o+19]=a,Rt.rectVertices[o+20]=-5,Rt.rectVertices[o+27]=r,Rt.rectVertices[o+28]=s,Rt.rectVertices[o+29]=-5},setRectTexCoords:function(e,t,n,i){var d=4*(9*Rt.bufferIndex);Rt.rectVertices[d+3]=e,Rt.rectVertices[d+4]=i,Rt.rectVertices[d+12]=e,Rt.rectVertices[d+13]=t,Rt.rectVertices[d+21]=n,Rt.rectVertices[d+22]=t,Rt.rectVertices[d+30]=n,Rt.rectVertices[d+31]=i},setRectColors:function(e,t){var n=4*(9*Rt.bufferIndex),i=e*(.00392156862745098*(t>>>24));Rt.rectVertices[n+5]=.00392156862745098*((16711680&t)>>>16),Rt.rectVertices[n+6]=.00392156862745098*((65280&t)>>>8),Rt.rectVertices[n+7]=.00392156862745098*(255&t),Rt.rectVertices[n+8]=i,Rt.rectVertices[n+14]=.00392156862745098*((16711680&t)>>>16),Rt.rectVertices[n+15]=.00392156862745098*((65280&t)>>>8),Rt.rectVertices[n+16]=.00392156862745098*(255&t),Rt.rectVertices[n+17]=i,Rt.rectVertices[n+23]=.00392156862745098*((16711680&t)>>>16),Rt.rectVertices[n+24]=.00392156862745098*((65280&t)>>>8),Rt.rectVertices[n+25]=.00392156862745098*(255&t),Rt.rectVertices[n+26]=i,Rt.rectVertices[n+32]=.00392156862745098*((16711680&t)>>>16),Rt.rectVertices[n+33]=.00392156862745098*((65280&t)>>>8),Rt.rectVertices[n+34]=.00392156862745098*(255&t),Rt.rectVertices[n+35]=i},drawBuffer:function(){Rt.rectVertexBuffer.unlock(4*Rt.bufferIndex),this.g.setVertexBuffer(Rt.rectVertexBuffer),this.g.setIndexBuffer(Rt.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,Rt.lastTexture),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,0),this.g.drawIndexedVertices(0,3*(2*Rt.bufferIndex)),this.g.setTexture(this.myPipeline.textureLocation,null),Rt.bufferIndex=0,Rt.rectVertices=Rt.rectVertexBuffer.lock()},setBilinearFilter:function(e){this.end(),this.bilinear=e},setFont:function(e){this.font=U.__cast(e,se)},bakedQuadCache:null,drawString:function(e,t,n,d,a,r){var s=this.font._get(this.fontSize),o=s.getTexture();null!=Rt.lastTexture&&o!=Rt.lastTexture&&this.drawBuffer(),Rt.lastTexture=o;for(var u=d,l=0,_=e.length;l<_;){var f=l++,i=e.charCodeAt(f),c=s.getBakedQuad(this.bakedQuadCache,Rt.findIndex(i),u,a);if(null!=c){1e3<=Rt.bufferIndex+1&&this.drawBuffer(),this.setRectColors(t,n),this.setRectTexCoords(c.s0*o.get_width()/o.get_realWidth(),c.t0*o.get_height()/o.get_realHeight(),c.s1*o.get_width()/o.get_realWidth(),c.t1*o.get_height()/o.get_realHeight());var g=c.x0,p=c.y1;null==p&&(p=0),null==g&&(g=0);var h=g,m=p,b=r._02*h+r._12*m+r._22,x=(r._00*h+r._10*m+r._20)/b,S=(r._01*h+r._11*m+r._21)/b,y=x,w=S;null==w&&(w=0),null==y&&(y=0);var T=y,E=w,C=c.x0,I=c.y0;null==I&&(I=0),null==C&&(C=0);var v=C,k=I,L=r._02*v+r._12*k+r._22,B=(r._00*v+r._10*k+r._20)/L,O=(r._01*v+r._11*k+r._21)/L,N=B,A=O;null==A&&(A=0),null==N&&(N=0);var P=N,R=A,V=c.x1,D=c.y0;null==D&&(D=0),null==V&&(V=0);var F=V,M=D,H=r._02*F+r._12*M+r._22,W=(r._00*F+r._10*M+r._20)/H,U=(r._01*F+r._11*M+r._21)/H,G=W,z=U;null==z&&(z=0),null==G&&(G=0);var X=G,Y=z,j=c.x1,Z=c.y1;null==Z&&(Z=0),null==j&&(j=0);var K=j,q=Z,Q=r._02*K+r._12*q+r._22,J=(r._00*K+r._10*q+r._20)/Q,$=(r._01*K+r._11*q+r._21)/Q,ee=J,te=$;null==te&&(te=0),null==ee&&(ee=0);var ne=ee,ie=te;this.setRectVertices(T,E,P,R,X,Y,ne,ie),u+=c.xadvance,++Rt.bufferIndex}}},drawCharacters:function(e,t,n,d,a,r,s,o){var u=this.font._get(this.fontSize),l=u.getTexture();null!=Rt.lastTexture&&l!=Rt.lastTexture&&this.drawBuffer(),Rt.lastTexture=l;for(var _=r,f=t;f<t+n;){var c=f++,i=u.getBakedQuad(this.bakedQuadCache,Rt.findIndex(e[c]),_,s);if(null!=i){1e3<=Rt.bufferIndex+1&&this.drawBuffer(),this.setRectColors(d,a),this.setRectTexCoords(i.s0*l.get_width()/l.get_realWidth(),i.t0*l.get_height()/l.get_realHeight(),i.s1*l.get_width()/l.get_realWidth(),i.t1*l.get_height()/l.get_realHeight());var g=i.x0,p=i.y1;null==p&&(p=0),null==g&&(g=0);var h=g,m=p,b=o._02*h+o._12*m+o._22,x=(o._00*h+o._10*m+o._20)/b,S=(o._01*h+o._11*m+o._21)/b,y=x,w=S;null==w&&(w=0),null==y&&(y=0);var T=y,E=w,C=i.x0,I=i.y0;null==I&&(I=0),null==C&&(C=0);var v=C,k=I,L=o._02*v+o._12*k+o._22,B=(o._00*v+o._10*k+o._20)/L,O=(o._01*v+o._11*k+o._21)/L,N=B,A=O;null==A&&(A=0),null==N&&(N=0);var P=N,R=A,V=i.x1,D=i.y0;null==D&&(D=0),null==V&&(V=0);var F=V,M=D,H=o._02*F+o._12*M+o._22,W=(o._00*F+o._10*M+o._20)/H,U=(o._01*F+o._11*M+o._21)/H,G=W,z=U;null==z&&(z=0),null==G&&(G=0);var X=G,Y=z,j=i.x1,Z=i.y1;null==Z&&(Z=0),null==j&&(j=0);var K=j,q=Z,Q=o._02*K+o._12*q+o._22,J=(o._00*K+o._10*q+o._20)/Q,$=(o._01*K+o._11*q+o._21)/Q,ee=J,te=$;null==te&&(te=0),null==ee&&(ee=0);var ne=ee,ie=te;this.setRectVertices(T,E,P,R,X,Y,ne,ie),_+=i.xadvance,++Rt.bufferIndex}}},end:function(){0<Rt.bufferIndex&&this.drawBuffer(),Rt.lastTexture=null},__class__:Rt};var Vt=function(e){this.scissorH=-1,this.scissorW=-1,this.scissorY=-1,this.scissorX=-1,this.scissorEnabled=!1,this.lastPipeline=null,this.pipelineCache=new k,this.myMipmapScaleQuality=0,this.myImageScaleQuality=0,st.call(this),this.set_color(-1),this.canvas=e,this.g=e.get_g4(),this.imagePainter=new At(this.g),this.coloredPainter=new Pt(this.g),this.textPainter=new Rt(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new sn(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==Vt.videoPipeline&&(Vt.videoPipeline=Vt.createImagePipeline(Vt.createImageVertexStructure()),Vt.videoPipeline.fragmentShader=fe.painter_video_frag,Vt.videoPipeline.vertexShader=fe.painter_video_vert,Vt.videoPipeline.compile())};s["kha.graphics4.Graphics2"]=Vt,Vt.__name__=!0,Vt.upperPowerOfTwo=function(e){return--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e},Vt.createImageVertexStructure=function(){var e=new jt;return e.add("vertexPosition",2),e.add("texPosition",1),e.add("vertexColor",3),e},Vt.createImagePipeline=function(e){var t=new Mt;return t.fragmentShader=fe.painter_image_frag,t.vertexShader=fe.painter_image_vert,t.inputLayout=[e],t.blendSource=1,t.blendDestination=5,t.alphaBlendSource=1,t.alphaBlendDestination=5,t},Vt.createColoredVertexStructure=function(){var e=new jt;return e.add("vertexPosition",2),e.add("vertexColor",3),e},Vt.createColoredPipeline=function(e){var t=new Mt;return t.fragmentShader=fe.painter_colored_frag,t.vertexShader=fe.painter_colored_vert,t.inputLayout=[e],t.blendSource=1,t.blendDestination=5,t.alphaBlendSource=1,t.alphaBlendDestination=5,t},Vt.createTextVertexStructure=function(){var e=new jt;return e.add("vertexPosition",2),e.add("texPosition",1),e.add("vertexColor",3),e},Vt.createTextPipeline=function(e){var t=new Mt;return t.fragmentShader=fe.painter_text_frag,t.vertexShader=fe.painter_text_vert,t.inputLayout=[e],t.blendSource=3,t.blendDestination=5,t.alphaBlendSource=3,t.alphaBlendDestination=5,t},Vt.__super__=st,Vt.prototype=n(st.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var e=this.canvas.get_width(),t=this.canvas.get_height();if(this.canvas instanceof te){var n=this.projectionMatrix,i=-e/e,d=-t/(0-t),a=2/e,r=2/(0-t);n._00=a,n._10=0,n._20=0,n._30=i,n._01=0,n._11=r,n._21=0,n._31=d,n._02=0,n._12=0,n._22=-.002000200020002,n._32=-1.0002000200020003,n._03=0,n._13=0,n._23=0,n._33=1}else if(de.get_nonPow2Supported()||(e=Vt.upperPowerOfTwo(e),t=Vt.upperPowerOfTwo(t)),de.renderTargetsInvertedY()){var s=this.projectionMatrix,o=-e/e,u=-t/t,l=2/e,_=2/t;s._00=l,s._10=0,s._20=0,s._30=o,s._01=0,s._11=_,s._21=0,s._31=u,s._02=0,s._12=0,s._22=-.002000200020002,s._32=-1.0002000200020003,s._03=0,s._13=0,s._23=0,s._33=1}else{var f=this.projectionMatrix,c=-e/e,g=-t/(0-t),p=2/e,h=2/(0-t);f._00=p,f._10=0,f._20=0,f._30=c,f._01=0,f._11=h,f._21=0,f._31=g,f._02=0,f._12=0,f._22=-.002000200020002,f._32=-1.0002000200020003,f._03=0,f._13=0,f._23=0,f._33=1}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(e,t,n){var i=this.coloredPainter;0<Pt.triangleBufferIndex&&i.drawTriBuffer(!1),0<Pt.bufferIndex&&i.drawBuffer(!1),this.textPainter.end();var d=t+e.get_width(),s=n+e.get_height(),o=this.transformations[this.transformationIndex],u=t,l=s;null==l&&(l=0),null==u&&(u=0);var _=u,f=l,c=o._02*_+o._12*f+o._22,p=(o._00*_+o._10*f+o._20)/c,h=(o._01*_+o._11*f+o._21)/c,m=p,x=h;null==x&&(x=0),null==m&&(m=0);var S=m,y=x,w=this.transformations[this.transformationIndex],T=t,E=n;null==E&&(E=0),null==T&&(T=0);var C=T,I=E,v=w._02*C+w._12*I+w._22,k=(w._00*C+w._10*I+w._20)/v,L=(w._01*C+w._11*I+w._21)/v,B=k,O=L;null==O&&(O=0),null==B&&(B=0);var N=B,A=O,P=this.transformations[this.transformationIndex],R=d,V=n;null==V&&(V=0),null==R&&(R=0);var D=R,F=V,M=P._02*D+P._12*F+P._22,H=(P._00*D+P._10*F+P._20)/M,W=(P._01*D+P._11*F+P._21)/M,U=H,G=W;null==G&&(G=0),null==U&&(U=0);var z=U,X=G,Y=this.transformations[this.transformationIndex],j=d,Z=s;null==Z&&(Z=0),null==j&&(j=0);var K=j,q=Z,Q=Y._02*K+Y._12*q+Y._22,J=(Y._00*K+Y._10*q+Y._20)/Q,$=(Y._01*K+Y._11*q+Y._21)/Q,ee=J,te=$;null==te&&(te=0),null==ee&&(ee=0);var ne=ee,ie=te,de=this.imagePainter,ae=this.get_opacity(),re=this.get_color(),se=e;(1500<=At.bufferIndex+1||null!=At.lastTexture&&se!=At.lastTexture)&&de.drawBuffer();var oe=.00392156862745098*((16711680&re)>>>16),r=.00392156862745098*((65280&re)>>>8),g=.00392156862745098*(255&re),b=.00392156862745098*(re>>>24)*ae,a=4*(9*At.bufferIndex);At.rectVertices[a+5]=oe,At.rectVertices[a+6]=r,At.rectVertices[a+7]=g,At.rectVertices[a+8]=b,At.rectVertices[a+14]=oe,At.rectVertices[a+15]=r,At.rectVertices[a+16]=g,At.rectVertices[a+17]=b,At.rectVertices[a+23]=oe,At.rectVertices[a+24]=r,At.rectVertices[a+25]=g,At.rectVertices[a+26]=b,At.rectVertices[a+32]=oe,At.rectVertices[a+33]=r,At.rectVertices[a+34]=g,At.rectVertices[a+35]=b;var ue=se.get_width()/se.get_realWidth(),le=se.get_height()/se.get_realHeight(),_e=4*(9*At.bufferIndex);At.rectVertices[_e+3]=0,At.rectVertices[_e+4]=le,At.rectVertices[_e+12]=0,At.rectVertices[_e+13]=0,At.rectVertices[_e+21]=ue,At.rectVertices[_e+22]=0,At.rectVertices[_e+30]=ue,At.rectVertices[_e+31]=le;var fe=4*(9*At.bufferIndex);At.rectVertices[fe]=S,At.rectVertices[fe+1]=y,At.rectVertices[fe+2]=-5,At.rectVertices[fe+9]=N,At.rectVertices[fe+10]=A,At.rectVertices[fe+11]=-5,At.rectVertices[fe+18]=z,At.rectVertices[fe+19]=X,At.rectVertices[fe+20]=-5,At.rectVertices[fe+27]=ne,At.rectVertices[fe+28]=ie,At.rectVertices[fe+29]=-5,++At.bufferIndex,At.lastTexture=se},drawScaledSubImage:function(e,t,n,i,d,s,o,u,l){var _=this.coloredPainter;0<Pt.triangleBufferIndex&&_.drawTriBuffer(!1),0<Pt.bufferIndex&&_.drawBuffer(!1),this.textPainter.end();var f=this.transformations[this.transformationIndex],c=s,p=o+l;null==p&&(p=0),null==c&&(c=0);var h=c,m=p,S=f._02*h+f._12*m+f._22,w=(f._00*h+f._10*m+f._20)/S,T=(f._01*h+f._11*m+f._21)/S,E=w,C=T;null==C&&(C=0),null==E&&(E=0);var I=E,v=C,k=this.transformations[this.transformationIndex],L=s,B=o;null==B&&(B=0),null==L&&(L=0);var O=L,N=B,A=k._02*O+k._12*N+k._22,P=(k._00*O+k._10*N+k._20)/A,R=(k._01*O+k._11*N+k._21)/A,V=P,D=R;null==D&&(D=0),null==V&&(V=0);var F=V,M=D,H=this.transformations[this.transformationIndex],W=s+u,U=o;null==U&&(U=0),null==W&&(W=0);var G=W,z=U,X=H._02*G+H._12*z+H._22,Y=(H._00*G+H._10*z+H._20)/X,j=(H._01*G+H._11*z+H._21)/X,Z=Y,K=j;null==K&&(K=0),null==Z&&(Z=0);var q=Z,Q=K,J=this.transformations[this.transformationIndex],$=s+u,ee=o+l;null==ee&&(ee=0),null==$&&($=0);var te=$,ne=ee,ie=J._02*te+J._12*ne+J._22,de=(J._00*te+J._10*ne+J._20)/ie,ae=(J._01*te+J._11*ne+J._21)/ie,re=de,se=ae;null==se&&(se=0),null==re&&(re=0);var oe=re,ue=se,le=this.imagePainter,_e=this.get_opacity(),fe=this.get_color(),ce=e;(1500<=At.bufferIndex+1||null!=At.lastTexture&&ce!=At.lastTexture)&&le.drawBuffer();var ge=t/ce.get_realWidth(),pe=n/ce.get_realHeight(),he=(t+i)/ce.get_realWidth(),me=(n+d)/ce.get_realHeight(),be=4*(9*At.bufferIndex);At.rectVertices[be+3]=ge,At.rectVertices[be+4]=me,At.rectVertices[be+12]=ge,At.rectVertices[be+13]=pe,At.rectVertices[be+21]=he,At.rectVertices[be+22]=pe,At.rectVertices[be+30]=he,At.rectVertices[be+31]=me;var xe=.00392156862745098*((16711680&fe)>>>16),r=.00392156862745098*((65280&fe)>>>8),g=.00392156862745098*(255&fe),b=.00392156862745098*(fe>>>24)*_e,a=4*(9*At.bufferIndex);At.rectVertices[a+5]=xe,At.rectVertices[a+6]=r,At.rectVertices[a+7]=g,At.rectVertices[a+8]=b,At.rectVertices[a+14]=xe,At.rectVertices[a+15]=r,At.rectVertices[a+16]=g,At.rectVertices[a+17]=b,At.rectVertices[a+23]=xe,At.rectVertices[a+24]=r,At.rectVertices[a+25]=g,At.rectVertices[a+26]=b,At.rectVertices[a+32]=xe,At.rectVertices[a+33]=r,At.rectVertices[a+34]=g,At.rectVertices[a+35]=b;var Se=4*(9*At.bufferIndex);At.rectVertices[Se]=I,At.rectVertices[Se+1]=v,At.rectVertices[Se+2]=-5,At.rectVertices[Se+9]=F,At.rectVertices[Se+10]=M,At.rectVertices[Se+11]=-5,At.rectVertices[Se+18]=q,At.rectVertices[Se+19]=Q,At.rectVertices[Se+20]=-5,At.rectVertices[Se+27]=oe,At.rectVertices[Se+28]=ue,At.rectVertices[Se+29]=-5,++At.bufferIndex,At.lastTexture=ce},get_color:function(){return this.myColor},set_color:function(e){return this.myColor=e},drawRect:function(e,t,n,i,d){null==d&&(d=1),this.imagePainter.end(),this.textPainter.end();var a=this.transformations[this.transformationIndex],r=e-d/2,s=t+d/2;null==s&&(s=0),null==r&&(r=0);var o=r,u=s,l=a._02*o+a._12*u+a._22,_=(a._00*o+a._10*u+a._20)/l,f=(a._01*o+a._11*u+a._21)/l,c=_,g=f;null==g&&(g=0),null==c&&(c=0);var p=c,h=g,m=this.transformations[this.transformationIndex],b=e-d/2,x=t-d/2;null==x&&(x=0),null==b&&(b=0);var S=b,y=x,w=m._02*S+m._12*y+m._22,T=(m._00*S+m._10*y+m._20)/w,E=(m._01*S+m._11*y+m._21)/w,C=T,I=E;null==I&&(I=0),null==C&&(C=0);var v=C,k=I,L=this.transformations[this.transformationIndex],B=e+n+d/2,O=t-d/2;null==O&&(O=0),null==B&&(B=0);var N=B,A=O,P=L._02*N+L._12*A+L._22,R=(L._00*N+L._10*A+L._20)/P,V=(L._01*N+L._11*A+L._21)/P,D=R,F=V;null==F&&(F=0),null==D&&(D=0);var M=D,H=F,W=this.transformations[this.transformationIndex],U=e+n+d/2,G=t+d/2;null==G&&(G=0),null==U&&(U=0);var z=U,X=G,Y=W._02*z+W._12*X+W._22,j=(W._00*z+W._10*X+W._20)/Y,Z=(W._01*z+W._11*X+W._21)/Y,K=j,q=Z;null==q&&(q=0),null==K&&(K=0);var Q=K,J=q;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),p,h,v,k,M,H,Q,J);var $=this.transformations[this.transformationIndex],ee=e-d/2,te=t+i-d/2;null==te&&(te=0),null==ee&&(ee=0);var ne=ee,ie=te,de=$._02*ne+$._12*ie+$._22,ae=($._00*ne+$._10*ie+$._20)/de,re=($._01*ne+$._11*ie+$._21)/de,se=ae,oe=re;null==oe&&(oe=0),null==se&&(se=0);var ue=se,le=oe;p=ue,h=le;var _e=this.transformations[this.transformationIndex],fe=e-d/2,ce=t+d/2;null==ce&&(ce=0),null==fe&&(fe=0);var ge=fe,pe=ce,he=_e._02*ge+_e._12*pe+_e._22,me=(_e._00*ge+_e._10*pe+_e._20)/he,be=(_e._01*ge+_e._11*pe+_e._21)/he,xe=me,Se=be;null==Se&&(Se=0),null==xe&&(xe=0);var ye=xe,we=Se;v=ye,k=we;var Te=this.transformations[this.transformationIndex],Ee=e+d/2,Ce=t+d/2;null==Ce&&(Ce=0),null==Ee&&(Ee=0);var Ie=Ee,ve=Ce,ke=Te._02*Ie+Te._12*ve+Te._22,Le=(Te._00*Ie+Te._10*ve+Te._20)/ke,Be=(Te._01*Ie+Te._11*ve+Te._21)/ke,Oe=Le,Ne=Be;null==Ne&&(Ne=0),null==Oe&&(Oe=0);var Ae=Oe,Pe=Ne;M=Ae,H=Pe;var Re=this.transformations[this.transformationIndex],Ve=e+d/2,De=t+i-d/2;null==De&&(De=0),null==Ve&&(Ve=0);var Fe=Ve,Me=De,He=Re._02*Fe+Re._12*Me+Re._22,We=(Re._00*Fe+Re._10*Me+Re._20)/He,Ue=(Re._01*Fe+Re._11*Me+Re._21)/He,Ge=We,ze=Ue;null==ze&&(ze=0),null==Ge&&(Ge=0);var Xe=Ge,Ye=ze;Q=Xe,J=Ye,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),p,h,v,k,M,H,Q,J);var je=this.transformations[this.transformationIndex],Ze=e-d/2,Ke=t+i+d/2;null==Ke&&(Ke=0),null==Ze&&(Ze=0);var qe=Ze,Qe=Ke,Je=je._02*qe+je._12*Qe+je._22,$e=(je._00*qe+je._10*Qe+je._20)/Je,et=(je._01*qe+je._11*Qe+je._21)/Je,tt=$e,nt=et;null==nt&&(nt=0),null==tt&&(tt=0);var it=tt,dt=nt;p=it,h=dt;var at=this.transformations[this.transformationIndex],rt=e-d/2,st=t+i-d/2;null==st&&(st=0),null==rt&&(rt=0);var ot=rt,ut=st,lt=at._02*ot+at._12*ut+at._22,_t=(at._00*ot+at._10*ut+at._20)/lt,ft=(at._01*ot+at._11*ut+at._21)/lt,ct=_t,gt=ft;null==gt&&(gt=0),null==ct&&(ct=0);var pt=ct,ht=gt;v=pt,k=ht;var mt=this.transformations[this.transformationIndex],bt=e+n+d/2,xt=t+i-d/2;null==xt&&(xt=0),null==bt&&(bt=0);var St=bt,yt=xt,wt=mt._02*St+mt._12*yt+mt._22,Tt=(mt._00*St+mt._10*yt+mt._20)/wt,Et=(mt._01*St+mt._11*yt+mt._21)/wt,Ct=Tt,It=Et;null==It&&(It=0),null==Ct&&(Ct=0);var vt=Ct,kt=It;M=vt,H=kt;var Lt=this.transformations[this.transformationIndex],Bt=e+n+d/2,Ot=t+i+d/2;null==Ot&&(Ot=0),null==Bt&&(Bt=0);var Nt=Bt,At=Ot,Pt=Lt._02*Nt+Lt._12*At+Lt._22,Rt=(Lt._00*Nt+Lt._10*At+Lt._20)/Pt,Vt=(Lt._01*Nt+Lt._11*At+Lt._21)/Pt,Dt=Rt,Ft=Vt;null==Ft&&(Ft=0),null==Dt&&(Dt=0);var Mt=Dt,Ht=Ft;Q=Mt,J=Ht,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),p,h,v,k,M,H,Q,J);var Wt=this.transformations[this.transformationIndex],Ut=e+n-d/2,Gt=t+i-d/2;null==Gt&&(Gt=0),null==Ut&&(Ut=0);var zt=Ut,Xt=Gt,Yt=Wt._02*zt+Wt._12*Xt+Wt._22,jt=(Wt._00*zt+Wt._10*Xt+Wt._20)/Yt,Zt=(Wt._01*zt+Wt._11*Xt+Wt._21)/Yt,Kt=jt,qt=Zt;null==qt&&(qt=0),null==Kt&&(Kt=0);var Qt=Kt,Jt=qt;p=Qt,h=Jt;var $t=this.transformations[this.transformationIndex],en=e+n-d/2,tn=t+d/2;null==tn&&(tn=0),null==en&&(en=0);var nn=en,dn=tn,an=$t._02*nn+$t._12*dn+$t._22,rn=($t._00*nn+$t._10*dn+$t._20)/an,sn=($t._01*nn+$t._11*dn+$t._21)/an,on=rn,un=sn;null==un&&(un=0),null==on&&(on=0);var ln=on,_n=un;v=ln,k=_n;var fn=this.transformations[this.transformationIndex],cn=e+n+d/2,gn=t+d/2;null==gn&&(gn=0),null==cn&&(cn=0);var pn=cn,hn=gn,mn=fn._02*pn+fn._12*hn+fn._22,bn=(fn._00*pn+fn._10*hn+fn._20)/mn,xn=(fn._01*pn+fn._11*hn+fn._21)/mn,Sn=bn,yn=xn;null==yn&&(yn=0),null==Sn&&(Sn=0);var wn=Sn,Tn=yn;M=wn,H=Tn;var En=this.transformations[this.transformationIndex],Cn=e+n+d/2,In=t+i-d/2;null==In&&(In=0),null==Cn&&(Cn=0);var vn=Cn,kn=In,Ln=En._02*vn+En._12*kn+En._22,Bn=(En._00*vn+En._10*kn+En._20)/Ln,On=(En._01*vn+En._11*kn+En._21)/Ln,Nn=Bn,An=On;null==An&&(An=0),null==Nn&&(Nn=0);var Pn=Nn,Rn=An;Q=Pn,J=Rn,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),p,h,v,k,M,H,Q,J)},fillRect:function(e,t,n,i){this.imagePainter.end(),this.textPainter.end();var d=this.transformations[this.transformationIndex],a=e,r=t+i;null==r&&(r=0),null==a&&(a=0);var s=a,o=r,u=d._02*s+d._12*o+d._22,l=(d._00*s+d._10*o+d._20)/u,_=(d._01*s+d._11*o+d._21)/u,f=l,c=_;null==c&&(c=0),null==f&&(f=0);var g=f,p=c,h=this.transformations[this.transformationIndex],m=e,b=t;null==b&&(b=0),null==m&&(m=0);var x=m,S=b,y=h._02*x+h._12*S+h._22,w=(h._00*x+h._10*S+h._20)/y,T=(h._01*x+h._11*S+h._21)/y,E=w,C=T;null==C&&(C=0),null==E&&(E=0);var I=E,v=C,k=this.transformations[this.transformationIndex],L=e+n,B=t;null==B&&(B=0),null==L&&(L=0);var O=L,N=B,A=k._02*O+k._12*N+k._22,P=(k._00*O+k._10*N+k._20)/A,R=(k._01*O+k._11*N+k._21)/A,V=P,D=R;null==D&&(D=0),null==V&&(V=0);var F=V,M=D,H=this.transformations[this.transformationIndex],W=e+n,U=t+i;null==U&&(U=0),null==W&&(W=0);var G=W,z=U,X=H._02*G+H._12*z+H._22,Y=(H._00*G+H._10*z+H._20)/X,j=(H._01*G+H._11*z+H._21)/X,Z=Y,K=j;null==K&&(K=0),null==Z&&(Z=0);var q=Z,Q=K;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),g,p,I,v,F,M,q,Q)},drawString:function(e,t,n){this.imagePainter.end();var i=this.coloredPainter;0<Pt.triangleBufferIndex&&i.drawTriBuffer(!1),0<Pt.bufferIndex&&i.drawBuffer(!1),this.textPainter.drawString(e,this.get_opacity(),this.get_color(),t,n,this.transformations[this.transformationIndex])},drawCharacters:function(e,t,n,i,d){this.imagePainter.end();var a=this.coloredPainter;0<Pt.triangleBufferIndex&&a.drawTriBuffer(!1),0<Pt.bufferIndex&&a.drawBuffer(!1),this.textPainter.drawCharacters(e,t,n,this.get_opacity(),this.get_color(),i,d,this.transformations[this.transformationIndex])},get_font:function(){return this.myFont},set_font:function(e){return this.textPainter.setFont(e),this.myFont=e},set_fontSize:function(e){return st.prototype.set_fontSize.call(this,this.textPainter.fontSize=e)},drawLine:function(e,t,n,i,d){null==d&&(d=1),this.imagePainter.end(),this.textPainter.end();var a=0,r=0;if(i==t){var s=0,o=-1;null==o&&(o=0),null==s&&(s=0);var u=s,l=o;a=u,r=l}else{var _=1,f=-(n-e)/(i-t);null==f&&(f=0),null==_&&(_=0);var c=_,g=f;a=c,r=g}var p=Math.sqrt(a*a+r*r);if(0!=p){var h=d/p;a*=h,r*=h}var m=e+.5*a,b=t+.5*r;null==b&&(b=0),null==m&&(m=0);var S=m,T=b,E=n+.5*a,C=i+.5*r;null==C&&(C=0),null==E&&(E=0);var I=E,v=C,k=S-a,L=T-r;null==L&&(L=0),null==k&&(k=0);var B=k,O=L,N=I-a,A=v-r;null==A&&(A=0),null==N&&(N=0);var P=N,R=A,V=this.transformations[this.transformationIndex],D=V._02*S+V._12*T+V._22,w=(V._00*S+V._10*T+V._20)/D,F=(V._01*S+V._11*T+V._21)/D,M=w,H=F;null==H&&(H=0),null==M&&(M=0);var W=M,U=H;S=W,T=U;var G=this.transformations[this.transformationIndex],z=G._02*I+G._12*v+G._22,X=(G._00*I+G._10*v+G._20)/z,Y=(G._01*I+G._11*v+G._21)/z,j=X,Z=Y;null==Z&&(Z=0),null==j&&(j=0);var K=j,q=Z;I=K,v=q;var Q=this.transformations[this.transformationIndex],J=Q._02*B+Q._12*O+Q._22,$=(Q._00*B+Q._10*O+Q._20)/J,ee=(Q._01*B+Q._11*O+Q._21)/J,te=$,ne=ee;null==ne&&(ne=0),null==te&&(te=0);var ie=te,de=ne;B=ie,O=de;var ae=this.transformations[this.transformationIndex],re=ae._02*P+ae._12*R+ae._22,se=(ae._00*P+ae._10*R+ae._20)/re,oe=(ae._01*P+ae._11*R+ae._21)/re,ue=se,le=oe;null==le&&(le=0),null==ue&&(ue=0);var _e=ue,fe=le;P=_e,R=fe,this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),S,T,I,v,B,O),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),B,O,I,v,P,R)},fillTriangle:function(e,t,n,i,d,a){this.imagePainter.end(),this.textPainter.end();var r=this.transformations[this.transformationIndex],s=e,o=t;null==o&&(o=0),null==s&&(s=0);var u=s,l=o,_=r._02*u+r._12*l+r._22,f=(r._00*u+r._10*l+r._20)/_,c=(r._01*u+r._11*l+r._21)/_,g=f,p=c;null==p&&(p=0),null==g&&(g=0);var h=g,m=p,b=this.transformations[this.transformationIndex],S=n,w=i;null==w&&(w=0),null==S&&(S=0);var T=S,E=w,C=b._02*T+b._12*E+b._22,I=(b._00*T+b._10*E+b._20)/C,v=(b._01*T+b._11*E+b._21)/C,k=I,L=v;null==L&&(L=0),null==k&&(k=0);var B=k,O=L,N=this.transformations[this.transformationIndex],A=d,P=a;null==P&&(P=0),null==A&&(A=0);var R=A,V=P,D=N._02*R+N._12*V+N._22,F=(N._00*R+N._10*V+N._20)/D,M=(N._01*R+N._11*V+N._21)/D,H=F,W=M;null==W&&(W=0),null==H&&(H=0);var U=H,G=W;this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),h,m,B,O,U,G)},myImageScaleQuality:null,get_imageScaleQuality:function(){return this.myImageScaleQuality},set_imageScaleQuality:function(e){return e==this.myImageScaleQuality?e:(this.imagePainter.setBilinearFilter(1==e),this.textPainter.setBilinearFilter(1==e),this.myImageScaleQuality=e)},myMipmapScaleQuality:null,get_mipmapScaleQuality:function(){return this.myMipmapScaleQuality},set_mipmapScaleQuality:function(e){return this.imagePainter.setBilinearMipmapFilter(1==e),this.myMipmapScaleQuality=e},pipelineCache:null,lastPipeline:null,setPipeline:function(e){if(e!=this.lastPipeline)if(this.lastPipeline=e,this.flush(),null==e)this.imagePainter.set_pipeline(null),this.coloredPainter.set_pipeline(null),this.textPainter.set_pipeline(null);else{var t=this.pipelineCache.h[e.__id__];null==t&&(t=new Nt(e),this.pipelineCache.set(e,t)),this.imagePainter.set_pipeline(t),this.coloredPainter.set_pipeline(t),this.textPainter.set_pipeline(t)}},scissorEnabled:null,scissorX:null,scissorY:null,scissorW:null,scissorH:null,scissor:function(e,t,n,i){this.scissorEnabled=!0,this.scissorX=e,this.scissorY=t,this.scissorW=n,this.scissorH=i,this.flush(),this.g.scissor(e,t,n,i)},disableScissor:function(){this.scissorEnabled=!1,this.flush(),this.g.disableScissor()},begin:function(e,t){if(null==e&&(e=!0),null==Vt.current)Vt.current=this;else throw new W("End before you begin");this.g.begin(),e&&this.clear(t),this.setProjection()},clear:function(e){this.flush(),this.g.clear(null==e?-16777216:e)},flush:function(){this.imagePainter.end(),this.textPainter.end();var e=this.coloredPainter;0<Pt.triangleBufferIndex&&e.drawTriBuffer(!1),0<Pt.bufferIndex&&e.drawBuffer(!1)},end:function(){if(this.flush(),this.g.end(),Vt.current==this)Vt.current=null;else throw new W("Begin before you end")},drawVideoInternal:function(){},drawVideo:function(e,t,n,i,d){this.setPipeline(Vt.videoPipeline),this.drawVideoInternal(e,t,n,i,d),this.setPipeline(null)},__class__:Vt});var Dt=function(e,t,n){null==n&&(n=!1),this.indexCount=e,this.buffer=Krom.createIndexBuffer(e)};s["kha.graphics4.IndexBuffer"]=Dt,Dt.__name__=!0,Dt.prototype={buffer:null,_data:null,indexCount:null,delete:function(){Krom.deleteIndexBuffer(this.buffer),this.buffer=null},lock:function(e,t){return this._data=Krom.lockIndexBuffer(this.buffer),null==e&&(e=0),null==t&&(t=this.indexCount),this._data.subarray(e,e+t)},unlock:function(){Krom.unlockIndexBuffer(this.buffer)},set:function(){Krom.setIndexBuffer(this.buffer)},count:function(){return this.indexCount},__class__:Dt};var Ft=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=2,this.depthWrite=!1,this.depthMode=0,this.stencilMode=0,this.stencilBothPass=0,this.stencilDepthFail=0,this.stencilFail=0,this.stencilReferenceValue=Ht.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=1,this.blendDestination=2,this.blendOperation=0,this.alphaBlendSource=1,this.alphaBlendDestination=2,this.alphaBlendOperation=0,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1};s["kha.graphics4.PipelineStateBase"]=Ft,Ft.__name__=!0,Ft.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,set_colorWriteMask:function(e){var t=this.colorWriteMasksAlpha[0]=e,n=this.colorWriteMasksGreen[0]=t,i=this.colorWriteMasksBlue[0]=n;return this.colorWriteMasksRed[0]=i},get_colorWriteMaskRed:function(){return this.colorWriteMasksRed[0]},set_colorWriteMaskRed:function(e){return this.colorWriteMasksRed[0]=e},get_colorWriteMaskGreen:function(){return this.colorWriteMasksGreen[0]},set_colorWriteMaskGreen:function(e){return this.colorWriteMasksGreen[0]=e},get_colorWriteMaskBlue:function(){return this.colorWriteMasksBlue[0]},set_colorWriteMaskBlue:function(e){return this.colorWriteMasksBlue[0]=e},get_colorWriteMaskAlpha:function(){return this.colorWriteMasksAlpha[0]},set_colorWriteMaskAlpha:function(e){return this.colorWriteMasksAlpha[0]=e},conservativeRasterization:null,__class__:Ft};var Mt=function(){Ft.call(this),this.pipeline=Krom.createPipeline()};s["kha.graphics4.PipelineState"]=Mt,Mt.__name__=!0,Mt.convertBlendingFactor=function(e){return 0===e||1===e?0:2===e?1:3===e?2:4===e?3:5===e?4:6===e?5:7===e?6:8===e?7:9===e?8:10===e?9:void 0},Mt.__super__=Ft,Mt.prototype=n(Ft.prototype,{pipeline:null,delete:function(){Krom.deletePipeline(this.pipeline),this.pipeline=null},compile:function(){var e=0<this.inputLayout.length?this.inputLayout[0]:null,t=1<this.inputLayout.length?this.inputLayout[1]:null,n=2<this.inputLayout.length?this.inputLayout[2]:null,i=3<this.inputLayout.length?this.inputLayout[3]:null,d=null==this.geometryShader?null:this.geometryShader.shader,a=null==this.tessellationControlShader?null:this.tessellationControlShader.shader,r=null==this.tessellationEvaluationShader?null:this.tessellationEvaluationShader.shader,s=0,o=this.stencilReferenceValue;if(1==o._hx_index){var u=o.value;s=u}Krom.compilePipeline(this.pipeline,e,t,n,i,this.inputLayout.length,this.vertexShader.shader,this.fragmentShader.shader,d,a,r,{cullMode:this.cullMode,depthWrite:this.depthWrite,depthMode:this.depthMode,stencilMode:this.stencilMode,stencilBothPass:this.stencilBothPass,stencilDepthFail:this.stencilDepthFail,stencilFail:this.stencilFail,stencilReferenceValue:s,stencilReadMask:this.stencilReadMask,stencilWriteMask:this.stencilWriteMask,blendSource:Mt.convertBlendingFactor(this.blendSource),blendDestination:Mt.convertBlendingFactor(this.blendDestination),alphaBlendSource:Mt.convertBlendingFactor(this.alphaBlendSource),alphaBlendDestination:Mt.convertBlendingFactor(this.alphaBlendDestination),colorWriteMaskRed:this.colorWriteMasksRed,colorWriteMaskGreen:this.colorWriteMasksGreen,colorWriteMaskBlue:this.colorWriteMasksBlue,colorWriteMaskAlpha:this.colorWriteMasksAlpha,conservativeRasterization:this.conservativeRasterization})},set:function(){Krom.setPipeline(this.pipeline)},getConstantLocation:function(e){return Krom.getConstantLocation(this.pipeline,e)},getTextureUnit:function(e){return Krom.getTextureUnit(this.pipeline,e)},__class__:Mt});var Ht=u["kha.graphics4.StencilValue"]={__ename__:!0,__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:o},Static:(_=function(e){return{_hx_index:1,value:e,__enum__:"kha.graphics4.StencilValue",toString:o}},_.__params__=["value"],_)},Wt=function(e,t){this.shader=Krom.createTessellationControlShader(e[0].bytes.b.bufferValue,t[0])};s["kha.graphics4.TessellationControlShader"]=Wt,Wt.__name__=!0,Wt.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Wt};var Ut=function(e,t){this.shader=Krom.createTessellationEvaluationShader(e[0].bytes.b.bufferValue,t[0])};s["kha.graphics4.TessellationEvaluationShader"]=Ut,Ut.__name__=!0,Ut.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Ut};var Gt=function(){};s["kha.graphics4.TextureUnit"]=Gt,Gt.__name__=!0,Gt.__isInterface__=!0;var zt=function(e,t,n,i,d){null==d&&(d=!1),null==i&&(i=0),this.vertexCount=e,this.structure=t,this.buffer=Krom.createVertexBuffer(e,t.elements,n,i)};s["kha.graphics4.VertexBuffer"]=zt,zt.__name__=!0,zt.prototype={buffer:null,_data:null,vertexCount:null,structure:null,delete:function(){Krom.deleteVertexBuffer(this.buffer),this.buffer=null},lock:function(){return this._data=Krom.lockVertexBuffer(this.buffer),this._data},lockInt16:function(e,t){var n=new Int16Array(this.lock(e,t).buffer);return n},unlock:function(){Krom.unlockVertexBuffer(this.buffer)},stride:function(){return this.structure.byteSize()},count:function(){return this.vertexCount},set:function(){return Krom.setVertexBuffer(this.buffer),0},__class__:zt};var Xt=function(e,t){this.name=e,this.data=t};s["kha.graphics4.VertexElement"]=Xt,Xt.__name__=!0,Xt.prototype={name:null,data:null,__class__:Xt};var Yt=function(e,t){null!=e&&(this.shader=Krom.createVertexShader(e[0].bytes.b.bufferValue,t[0]))};s["kha.graphics4.VertexShader"]=Yt,Yt.__name__=!0,Yt.fromSource=function(e){var t=new Yt(null,null);return t.shader=Krom.createVertexShaderFromSource(e),t},Yt.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Yt};var jt=function(){this.elements=[],this.instanced=!1};s["kha.graphics4.VertexStructure"]=jt,jt.__name__=!0,jt.prototype={elements:null,instanced:null,add:function(e,t){this.elements.push(new Xt(e,t))},size:function(){return this.elements.length},byteSize:function(){for(var e=0,t=0,n=this.elements.length;t<n;){var d=t++;e+=this.dataByteSize(this.elements[d].data)}return e},dataByteSize:function(e){return 0===e?4:1===e?8:2===e?12:3===e?16:4===e?64:5===e?4:6===e?8:void 0},get:function(e){return this.elements[e]},__class__:jt};var Zt=e.kha.input.Gamepad=function(e,t){null==t&&(t="unknown"),null==e&&(e=0),this.index=e,this.axisListeners=[],this.buttonListeners=[],Zt.instances[e]=this};s["kha.input.Gamepad"]=Zt,Zt.__name__=!0,Zt.get=function(e){return null==e&&(e=0),e>=Zt.instances.length?null:Zt.instances[e]},Zt.notifyOnConnect=function(e,t){null!=e&&Zt.connectListeners.push(e),null!=t&&Zt.disconnectListeners.push(t)},Zt.removeConnect=function(e,t){null!=e&&f.remove(Zt.connectListeners,e),null!=t&&f.remove(Zt.disconnectListeners,t)},Zt.sendConnectEvent=function(e){Zt.instances[e].connected=!0;for(var t=0,n=Zt.connectListeners;t<n.length;){var i=n[t];++t,i(e)}},Zt.sendDisconnectEvent=function(e){Zt.instances[e].connected=!1;for(var t=0,n=Zt.disconnectListeners;t<n.length;){var i=n[t];++t,i(e)}},Zt.prototype={index:null,notify:function(e,t){null!=e&&this.axisListeners.push(e),null!=t&&this.buttonListeners.push(t)},remove:function(e,t){null!=e&&f.remove(this.axisListeners,e),null!=t&&f.remove(this.buttonListeners,t)},axisListeners:null,buttonListeners:null,id:null,connected:null,get_id:function(){return he.getGamepadId(this.index)},sendAxisEvent:function(e,t){for(var n=0,i=this.axisListeners;n<i.length;){var d=i[n];++n,d(e,t)}},sendButtonEvent:function(e,t){for(var n=0,i=this.buttonListeners;n<i.length;){var d=i[n];++n,d(e,t)}},__class__:Zt};var Kt=u["kha.input.BlockInterventions"]={__ename__:!0,__constructs__:["Default","Full","None","Custom"],Default:{_hx_index:0,__enum__:"kha.input.BlockInterventions",toString:o},Full:{_hx_index:1,__enum__:"kha.input.BlockInterventions",toString:o},None:{_hx_index:2,__enum__:"kha.input.BlockInterventions",toString:o},Custom:(_=function(e){return{_hx_index:3,func:e,__enum__:"kha.input.BlockInterventions",toString:o}},_.__params__=["func"],_)},qt=function(){this.__id=mn.nextId++,this._inputBuffer=new B(new ArrayBuffer(1))};s["kha.netsync.Controller"]=qt,qt.__name__=!0,qt.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},_receive:function(){},__class__:qt};var Qt=e.kha.input.Keyboard=function(){qt.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Qt.instance=this};s["kha.input.Keyboard"]=Qt,Qt.__name__=!0,Qt.get=function(e){return null==e&&(e=0),he.getKeyboard(e)},Qt.disableSystemInterventions=function(e){Qt.keyBehavior=e},Qt.__super__=qt,Qt.prototype=n(qt.prototype,{notify:function(e,t,n){null!=e&&this.downListeners.push(e),null!=t&&this.upListeners.push(t),null!=n&&this.pressListeners.push(n)},remove:function(e,t,n){null!=e&&f.remove(this.downListeners,e),null!=t&&f.remove(this.upListeners,t),null!=n&&f.remove(this.pressListeners,n)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(e){for(var t=0,n=this.downListeners;t<n.length;){var i=n[t];++t,i(e)}},sendUpEvent:function(e){for(var t=0,n=this.upListeners;t<n.length;){var i=n[t];++t,i(e)}},sendPressEvent:function(e){for(var t=0,n=this.pressListeners;t<n.length;){var i=n[t];++t,i(e)}},_receive:function(){},__class__:Qt});var Jt=e.kha.input.Mouse=function(){qt.call(this),Jt.instance=this};s["kha.input.Mouse"]=Jt,Jt.__name__=!0,Jt.get=function(e){return null==e&&(e=0),he.getMouse(e)},Jt.__super__=qt,Jt.prototype=n(qt.prototype,{notify:function(e,t,n,i,d){this.notifyWindowed(0,e,t,n,i,d)},remove:function(e,t,n,i,d){this.removeWindowed(0,e,t,n,i,d)},notifyWindowed:function(e,t,n,i,d,a){if(null!=t){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=e;)this.windowDownListeners.push([]);this.windowDownListeners[e].push(t)}if(null!=n){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=e;)this.windowUpListeners.push([]);this.windowUpListeners[e].push(n)}if(null!=i){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=e;)this.windowMoveListeners.push([]);this.windowMoveListeners[e].push(i)}if(null!=d){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=e;)this.windowWheelListeners.push([]);this.windowWheelListeners[e].push(d)}if(null!=a){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=e;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[e].push(a)}},removeWindowed:function(e,t,n,i,d,a){null!=t&&(null==this.windowDownListeners?w.trace("no downListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:114,className:"kha.input.Mouse",methodName:"removeWindowed"}):e<this.windowDownListeners.length?f.remove(this.windowDownListeners[e],t):w.trace("no downListeners for window \""+e+"\" are registered",{fileName:"kha/input/Mouse.hx",lineNumber:110,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null==this.windowUpListeners?w.trace("no upListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:128,className:"kha.input.Mouse",methodName:"removeWindowed"}):e<this.windowUpListeners.length?f.remove(this.windowUpListeners[e],n):w.trace("no upListeners for window \""+e+"\" are registered",{fileName:"kha/input/Mouse.hx",lineNumber:124,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null==this.windowMoveListeners?w.trace("no moveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:142,className:"kha.input.Mouse",methodName:"removeWindowed"}):e<this.windowMoveListeners.length?f.remove(this.windowMoveListeners[e],i):w.trace("no moveListeners for window \""+e+"\" are registered",{fileName:"kha/input/Mouse.hx",lineNumber:138,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=d&&(null==this.windowWheelListeners?w.trace("no wheelListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:156,className:"kha.input.Mouse",methodName:"removeWindowed"}):e<this.windowWheelListeners.length?f.remove(this.windowWheelListeners[e],d):w.trace("no wheelListeners for window \""+e+"\" are registered",{fileName:"kha/input/Mouse.hx",lineNumber:152,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=a&&(null==this.windowLeaveListeners?w.trace("no leaveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:170,className:"kha.input.Mouse",methodName:"removeWindowed"}):e<this.windowLeaveListeners.length?f.remove(this.windowLeaveListeners[e],a):w.trace("no leaveListeners for window \""+e+"\" are registered",{fileName:"kha/input/Mouse.hx",lineNumber:166,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(){},removeFromLockChange:function(){},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(e){if(null!=this.windowLeaveListeners)for(var t=0,n=this.windowLeaveListeners[e],i;t<n.length;)i=n[t],++t,i()},sendDownEvent:function(e,t,n,i){if(null!=this.windowDownListeners)for(var d=0,a=this.windowDownListeners[e],r;d<a.length;)r=a[d],++d,r(t,n,i)},sendUpEvent:function(e,t,n,i){if(null!=this.windowUpListeners)for(var d=0,a=this.windowUpListeners[e],r;d<a.length;)r=a[d],++d,r(t,n,i)},sendMoveEvent:function(e,t,n,i,d){if(null!=this.windowMoveListeners)for(var a=0,r=this.windowMoveListeners[e],s;a<r.length;)s=r[a],++a,s(t,n,i,d)},sendWheelEvent:function(e,t){if(null!=this.windowWheelListeners)for(var n=0,i=this.windowWheelListeners[e],d;n<i.length;)d=i[n],++n,d(t)},_receive:function(){},__class__:Jt});var $t=function(){Jt.call(this)};s["kha.input.MouseImpl"]=$t,$t.__name__=!0,$t.__super__=Jt,$t.prototype=n(Jt.prototype,{lock:function(){he.lockMouse()},unlock:function(){he.unlockMouse()},canLock:function(){return he.canLockMouse()},isLocked:function(){return he.isMouseLocked()},notifyOnLockChange:function(e,t){he.notifyOfMouseLockChange(e,t)},removeFromLockChange:function(e,t){he.removeFromMouseLockChange(e,t)},hideSystemCursor:function(){he.hideSystemCursor()},showSystemCursor:function(){he.showSystemCursor()},_receive:function(){},__class__:$t});var en=function(){en.instance=this};s["kha.input.Pen"]=en,en.__name__=!0,en.get=function(e){return null==e&&(e=0),he.getPen(e)},en.prototype={notify:function(e,t,n){this.notifyWindowed(0,e,t,n)},remove:function(e,t,n){this.removeWindowed(0,e,t,n)},notifyWindowed:function(e,t,n,i){if(null!=t){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=e;)this.windowDownListeners.push([]);this.windowDownListeners[e].push(t)}if(null!=n){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=e;)this.windowUpListeners.push([]);this.windowUpListeners[e].push(n)}if(null!=i){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=e;)this.windowMoveListeners.push([]);this.windowMoveListeners[e].push(i)}},removeWindowed:function(e,t,n,i){null!=t&&null!=this.windowDownListeners&&e<this.windowDownListeners.length&&f.remove(this.windowDownListeners[e],t),null!=n&&null!=this.windowUpListeners&&e<this.windowUpListeners.length&&f.remove(this.windowUpListeners[e],n),null!=i&&null!=this.windowMoveListeners&&e<this.windowMoveListeners.length&&f.remove(this.windowMoveListeners[e],i)},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,sendDownEvent:function(e,t,n,i){if(null!=this.windowDownListeners)for(var d=0,a=this.windowDownListeners[e],r;d<a.length;)r=a[d],++d,r(t,n,i)},sendUpEvent:function(e,t,n,i){if(null!=this.windowUpListeners)for(var d=0,a=this.windowUpListeners[e],r;d<a.length;)r=a[d],++d,r(t,n,i)},sendMoveEvent:function(e,t,n,i){if(null!=this.windowMoveListeners)for(var d=0,a=this.windowMoveListeners[e],r;d<a.length;)r=a[d],++d,r(t,n,i)},__class__:en};var tn=e.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],tn.instance=this};s["kha.input.Surface"]=tn,tn.__name__=!0,tn.get=function(e){return null==e&&(e=0),0==e?tn.instance:null},tn.prototype={notify:function(e,t,n){null!=e&&this.touchStartListeners.push(e),null!=t&&this.touchEndListeners.push(t),null!=n&&this.moveListeners.push(n)},remove:function(e,t,n){null!=e&&f.remove(this.touchStartListeners,e),null!=t&&f.remove(this.touchEndListeners,t),null!=n&&f.remove(this.moveListeners,n)},touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(e,t,n){for(var i=0,d=this.touchStartListeners;i<d.length;){var a=d[i];++i,a(e,t,n)}},sendTouchEndEvent:function(e,t,n){for(var i=0,d=this.touchEndListeners;i<d.length;){var a=d[i];++i,a(e,t,n)}},sendMoveEvent:function(e,t,n){for(var i=0,d=this.moveListeners;i<d.length;){var a=d[i];++i,a(e,t,n)}},__class__:tn};var nn=function(e){this.bytes=e};s["kha.internal.BytesBlob"]=nn,nn.__name__=!0,nn.__interfaces__=[ie],nn.fromBytes=function(e){return new nn(e)},nn.alloc=function(e){return new nn(new B(new ArrayBuffer(e)))},nn.readF32=function(e){var t=0==(-2147483648&e)?1:-1,n=255&e>>23,i=8388607&e;switch(n){case 0:return 0;case 255:return 0==i?0<t?1/0:-Infinity:NaN;break;default:return t*((i+8388608)/8388608)*Math.pow(2,n-127);}},nn.bit=function(e,t){if(1==(1&e>>>t)){var n=3;return++n,!0}var i=4;return--i,!1},nn.toText=function(e,t){for(var n="",d=0;d<t;){var a=d++;n+=String.fromCodePoint(e[a])}return n},nn.prototype={bytes:null,sub:function(e,t){return new nn(this.bytes.sub(e,t))},length:null,get_length:function(){return this.bytes.length},writeU8:function(e,t){this.bytes.b[e]=t},readU8:function(e){var t=this.bytes.b[e];return++e,t},readS8:function(e){var t=this.bytes.b[e];++e;var n=0==(128&t)?1:-1;return t&=127,n*t},readU16BE:function(e){var t=this.bytes.b[e],n=this.bytes.b[e+1];return e+=2,256*t+n},readU16LE:function(e){var t=this.bytes.b[e],n=this.bytes.b[e+1];return e+=2,256*n+t},readU32LE:function(e){var t=this.bytes.b[e],n=this.bytes.b[e+1],i=this.bytes.b[e+2],d=this.bytes.b[e+3];return e+=4,t+256*n+256*(256*i)+256*(256*(256*d))},readU32BE:function(e){var t=this.bytes.b[e],n=this.bytes.b[e+1],i=this.bytes.b[e+2],d=this.bytes.b[e+3];return e+=4,d+256*i+256*(256*n)+256*(256*(256*t))},readS16BE:function(e){var t=this.bytes.b[e],n=this.bytes.b[e+1];e+=2;var i=0==(128&t)?1:-1;return t&=127,-1==i?-32767+256*t+n:256*t+n},readS16LE:function(e){var t=this.bytes.b[e],n=this.bytes.b[e+1],i=0==(128&n)?1:-1;return n&=127,e+=2,-1==i?-32767+256*n+t:256*n+t},readS32LE:function(e){var t=this.bytes.b[e],n=this.bytes.b[e+1],i=this.bytes.b[e+2],d=this.bytes.b[e+3],a=0==(128&d)?1:-1;return d&=127,e+=4,-1==a?-2147483647+t+256*n+256*(256*i)+256*(256*(256*d)):t+256*n+256*(256*i)+256*(256*(256*d))},readS32BE:function(e){var t=this.bytes.b[e],n=this.bytes.b[e+1],i=this.bytes.b[e+2],d=this.bytes.b[e+3],a=0==(128&t)?1:-1;return t&=127,e+=4,-1==a?-2147483647+d+256*i+256*(256*n)+256*(256*(256*t)):d+256*i+256*(256*n)+256*(256*(256*t))},readF32LE:function(e){return nn.readF32(this.readS32LE(e))},readF32BE:function(e){return nn.readF32(this.readS32BE(e))},toString:function(){return this.bytes.toString()},readUtf8String:function(){return this.bytes.toString()},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:nn};var dn=function(e){this.renderTarget=e};s["kha.krom.Graphics"]=dn,dn.__name__=!0,dn.__interfaces__=[Ot],dn.prototype={renderTarget:null,begin:function(e){Krom.begin(this.renderTarget,e)},beginFace:function(e){Krom.beginFace(this.renderTarget,e)},beginEye:function(){},end:function(){Krom.end()},flush:function(){},vsynced:function(){return!0},refreshRate:function(){return 60},clear:function(e,t,n){var i=0;null!=e&&(i|=1),null!=t&&(i|=2),null!=n&&(i|=4),Krom.clear(i,null==e?0:e,t,n)},viewport:function(e,t,n,i){Krom.viewport(e,t,n,i)},setVertexBuffer:function(e){e.set(0)},setVertexBuffers:function(e){Krom.setVertexBuffers(e)},setIndexBuffer:function(e){e.set()},setCubeMap:function(e,t){null==t||(null==t.texture_?Krom.setRenderTarget(e,t.renderTarget_):Krom.setTexture(e,t.texture_))},setCubeMapDepth:function(e,t){null==t||Krom.setTextureDepth(e,t.renderTarget_)},setTexture:function(e,t){null==t||(null==t.texture_?Krom.setRenderTarget(e,t.renderTarget_):Krom.setTexture(e,t.texture_))},setTextureDepth:function(e,t){null==t||Krom.setTextureDepth(e,t.renderTarget_)},setTextureArray:function(){},setVideoTexture:function(){},setImageTexture:function(e,t){null==t||Krom.setImageTexture(e,t.texture_)},setTextureParameters:function(e,t,n,i,d,a){Krom.setTextureParameters(e,t,n,i,d,a)},setTexture3DParameters:function(e,t,n,i,d,a,r){Krom.setTexture3DParameters(e,t,n,i,d,a,r)},setTextureCompareMode:function(e,t){Krom.setTextureCompareMode(e,t)},setCubeMapCompareMode:function(e,t){Krom.setCubeMapCompareMode(e,t)},setPipeline:function(e){e.set()},setStencilReferenceValue:function(){},setBool:function(e,t){Krom.setBool(e,t)},setInt:function(e,t){Krom.setInt(e,t)},setInt2:function(){},setInt3:function(){},setInt4:function(){},setInts:function(){},setFloat:function(e,t){Krom.setFloat(e,t)},setFloat2:function(e,t,n){Krom.setFloat2(e,t,n)},setFloat3:function(e,t,n,i){Krom.setFloat3(e,t,n,i)},setFloat4:function(e,t,n,i,d){Krom.setFloat4(e,t,n,i,d)},setFloats:function(e,t){Krom.setFloats(e,t.buffer)},setVector2:function(e,t){Krom.setFloat2(e,t.x,t.y)},setVector3:function(e,t){Krom.setFloat3(e,t.x,t.y,t.z)},setVector4:function(e,t){Krom.setFloat4(e,t.x,t.y,t.z,t.w)},setMatrix:function(e,t){dn.mat[0]=t._00,dn.mat[1]=t._01,dn.mat[2]=t._02,dn.mat[3]=t._03,dn.mat[4]=t._10,dn.mat[5]=t._11,dn.mat[6]=t._12,dn.mat[7]=t._13,dn.mat[8]=t._20,dn.mat[9]=t._21,dn.mat[10]=t._22,dn.mat[11]=t._23,dn.mat[12]=t._30,dn.mat[13]=t._31,dn.mat[14]=t._32,dn.mat[15]=t._33,Krom.setMatrix(e,dn.mat.buffer)},setMatrix3:function(e,t){dn.mat[0]=t._00,dn.mat[1]=t._01,dn.mat[2]=t._02,dn.mat[3]=t._10,dn.mat[4]=t._11,dn.mat[5]=t._12,dn.mat[6]=t._20,dn.mat[7]=t._21,dn.mat[8]=t._22,Krom.setMatrix3(e,dn.mat.buffer)},drawIndexedVertices:function(e,t){null==t&&(t=-1),null==e&&(e=0),Krom.drawIndexedVertices(e,t)},drawIndexedVerticesInstanced:function(e,t,n){null==n&&(n=-1),null==t&&(t=0),Krom.drawIndexedVerticesInstanced(e,t,n)},instancedRenderingAvailable:function(){return!0},scissor:function(e,t,n,i){Krom.scissor(e,t,n,i)},disableScissor:function(){Krom.disableScissor()},__class__:dn};var an=function(e){ce.call(this),this.sampleRate=44100;var t=0|e.length/4,n=new Float32Array(t);this.uncompressedData=n;for(var d=0;d<t;){var a=d++;this.uncompressedData[a]=e.getFloat(4*a)}this.compressedData=null};s["kha.krom.Sound"]=an,an.__name__=!0,an.__super__=ce,an.prototype=n(ce.prototype,{uncompress:function(e){e()},unload:function(){ce.prototype.unload.call(this)},__class__:an});var rn=function(e,t,n,i,d,a,r,s,o){this._00=e,this._10=t,this._20=n,this._01=i,this._11=d,this._21=a,this._02=r,this._12=s,this._22=o};s["kha.math.FastMatrix3"]=rn,rn.__name__=!0,rn.fromMatrix3=function(e){return new rn(e._00,e._10,e._20,e._01,e._11,e._21,e._02,e._12,e._22)},rn.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:rn};var sn=function(e,t,n,i,d,a,r,s,o,u,l,_,f,c,g,p){this._00=e,this._10=t,this._20=n,this._30=i,this._01=d,this._11=a,this._21=r,this._31=s,this._02=o,this._12=u,this._22=l,this._32=_,this._03=f,this._13=c,this._23=g,this._33=p};s["kha.math.FastMatrix4"]=sn,sn.__name__=!0,sn.fromMatrix4=function(e){return new sn(e._00,e._10,e._20,e._30,e._01,e._11,e._21,e._31,e._02,e._12,e._22,e._32,e._03,e._13,e._23,e._33)},sn.orthogonalProjection=function(e,t,n,i,d,a){return new sn(2/(t-e),0,0,-(t+e)/(t-e),0,2/(i-n),0,-(i+n)/(i-n),0,0,-2/(a-d),-(a+d)/(a-d),0,0,0,1)},sn.perspectiveProjection=function(e,t,n,i){var d=1/Math.tan(e/2);return new sn(d/t,0,0,0,0,d,0,0,0,0,(i+n)/(n-i),2*i*n/(n-i),0,0,-1,0)},sn.lookAt=function(e,t,n){var i=t.x-e.x,d=t.y-e.y,a=t.z-e.z;null==a&&(a=0),null==d&&(d=0),null==i&&(i=0);var r=i,s=d,o=a,u=r,l=s,_=o;null==_&&(_=0),null==l&&(l=0),null==u&&(u=0);var f=u,c=l,g=_,p=Math.sqrt(f*f+c*c+g*g);if(0!=p){var h=1/p;f*=h,c*=h,g*=h}var m=c*n.z-g*n.y,b=g*n.x-f*n.z,S=f*n.y-c*n.x,w=m,T=b,E=S;null==E&&(E=0),null==T&&(T=0),null==w&&(w=0);var C=w,I=T,v=E,k=C,L=I,B=v;null==B&&(B=0),null==L&&(L=0),null==k&&(k=0);var O=k,N=L,A=B,P=Math.sqrt(O*O+N*N+A*A);if(0!=P){var R=1/P;O*=R,N*=R,A*=R}var V=N*g-A*c,D=A*f-O*g,F=O*c-N*f,M=V,H=D,W=F;null==W&&(W=0),null==H&&(H=0),null==M&&(M=0);var U=M,G=H,X=W;return new sn(O,N,A,-(O*e.x+N*e.y+A*e.z),U,G,X,-(U*e.x+G*e.y+X*e.z),-f,-c,-g,f*e.x+c*e.y+g*e.z,0,0,0,1)},sn.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:sn};var on=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};s["kha.math.FastVector2"]=on,on.__name__=!0,on.fromVector2=function(e){return new on(e.x,e.y)},on.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(0==t)return 0;var n=e/t;return this.x*=n,this.y*=n,e},toString:function(){return"FastVector2("+this.x+", "+this.y+")"},__class__:on};var un=function(e,t,n){null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=n};s["kha.math.FastVector3"]=un,un.__name__=!0,un.fromVector3=function(e){return new un(e.x,e.y,e.z)},un.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==t)return 0;var n=e/t;return this.x*=n,this.y*=n,this.z*=n,e},toString:function(){return"FastVector3("+this.x+", "+this.y+", "+this.z+")"},__class__:un};var ln=function(e,t,n,i){null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=n,this.w=i};s["kha.math.FastVector4"]=ln,ln.__name__=!0,ln.fromVector4=function(e){return new ln(e.x,e.y,e.z,e.w)},ln.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==t)return 0;var n=e/t;return this.x*=n,this.y*=n,this.z*=n,this.w*=n,e},toString:function(){return"FastVector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},__class__:ln};var _n=function(e,t,n,i,d,a,r,s,o){this._00=e,this._10=t,this._20=n,this._01=i,this._11=d,this._21=a,this._02=r,this._12=s,this._22=o};s["kha.math.Matrix3"]=_n,_n.__name__=!0,_n.fromFastMatrix3=function(e){return new _n(e._00,e._10,e._20,e._01,e._11,e._21,e._02,e._12,e._22)},_n.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:_n};var fn=function(e,t,n,i,d,a,r,s,o,u,l,_,f,c,g,p){this._00=e,this._10=t,this._20=n,this._30=i,this._01=d,this._11=a,this._21=r,this._31=s,this._02=o,this._12=u,this._22=l,this._32=_,this._03=f,this._13=c,this._23=g,this._33=p};s["kha.math.Matrix4"]=fn,fn.__name__=!0,fn.fromFastMatrix4=function(e){return new fn(e._00,e._10,e._20,e._30,e._01,e._11,e._21,e._31,e._02,e._12,e._22,e._32,e._03,e._13,e._23,e._33)},fn.orthogonalProjection=function(e,t,n,i,d,a){return new fn(2/(t-e),0,0,-(t+e)/(t-e),0,2/(i-n),0,-(i+n)/(i-n),0,0,-2/(a-d),-(a+d)/(a-d),0,0,0,1)},fn.perspectiveProjection=function(e,t,n,i){var d=1/Math.tan(e/2);return new fn(d/t,0,0,0,0,d,0,0,0,0,(i+n)/(n-i),2*i*n/(n-i),0,0,-1,0)},fn.lookAt=function(e,t,n){var i=t.x-e.x,d=t.y-e.y,a=t.z-e.z;null==a&&(a=0),null==d&&(d=0),null==i&&(i=0);var r=i,s=d,o=a,u=r,l=s,_=o;null==_&&(_=0),null==l&&(l=0),null==u&&(u=0);var f=u,c=l,g=_,p=Math.sqrt(f*f+c*c+g*g);if(0!=p){var h=1/p;f*=h,c*=h,g*=h}var m=c*n.z-g*n.y,b=g*n.x-f*n.z,S=f*n.y-c*n.x,w=m,T=b,E=S;null==E&&(E=0),null==T&&(T=0),null==w&&(w=0);var C=w,I=T,v=E,k=C,L=I,B=v;null==B&&(B=0),null==L&&(L=0),null==k&&(k=0);var O=k,N=L,A=B,P=Math.sqrt(O*O+N*N+A*A);if(0!=P){var R=1/P;O*=R,N*=R,A*=R}var V=N*g-A*c,D=A*f-O*g,F=O*c-N*f,M=V,H=D,W=F;null==W&&(W=0),null==H&&(H=0),null==M&&(M=0);var U=M,G=H,X=W;return new fn(O,N,A,-(O*e.x+N*e.y+A*e.z),U,G,X,-(U*e.x+G*e.y+X*e.z),-f,-c,-g,f*e.x+c*e.y+g*e.z,0,0,0,1)},fn.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:fn};var cn=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};s["kha.math.Vector2"]=cn,cn.__name__=!0,cn.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y);if(0==t)return 0;var n=e/t;return this.x*=n,this.y*=n,e},__class__:cn};var gn=function(e,t,n){null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=n};s["kha.math.Vector3"]=gn,gn.__name__=!0,gn.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==t)return 0;var n=e/t;return this.x*=n,this.y*=n,this.z*=n,e},__class__:gn};var pn=function(e,t,n,i){null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=n,this.w=i};s["kha.math.Vector4"]=pn,pn.__name__=!0,pn.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==t)return 0;var n=e/t;return this.x*=n,this.y*=n,this.z*=n,this.w*=n,e},__class__:pn};var hn=function(){};s["kha.netsync.Client"]=hn,hn.__name__=!0,hn.__isInterface__=!0,hn.prototype={get_id:null,id:null,send:null,receive:null,onClose:null,__class__:hn};var mn=function(){};s["kha.netsync.ControllerBuilder"]=mn,mn.__name__=!0;var bn=function(){};s["kha.netsync.Entity"]=bn,bn.__name__=!0,bn.__isInterface__=!0,bn.prototype={_id:null,_size:null,_send:null,_receive:null,__class__:bn};var xn=function(e){this.myId=e};s["kha.netsync.LocalClient"]=xn,xn.__name__=!0,xn.__interfaces__=[hn],xn.prototype={myId:null,send:function(){},receive:function(){},onClose:function(){},controllers:null,get_controllers:function(){return null},id:null,get_id:function(){return this.myId},__class__:xn};var Sn=function(e,t){this.time=e,this.data=t};s["kha.netsync.State"]=Sn,Sn.__name__=!0,Sn.prototype={time:null,data:null,__class__:Sn};var yn=function(e,t,n){this.ping=1,this.currentPlayers=0,this.controllers=new C,this.entities=new C,yn.instance=this,this.maxPlayers=e,this.address=t,this.port=n};s["kha.netsync.Session"]=yn,yn.__name__=!0,yn.the=function(){return yn.instance},yn.prototype={entities:null,controllers:null,maxPlayers:null,currentPlayers:null,ping:null,address:null,port:null,startCallback:null,refusedCallback:null,resetCallback:null,localClient:null,network:null,updateTaskId:null,pingTaskId:null,me:null,get_me:function(){return this.localClient},addEntity:function(e){var t=this.entities,n=e._id();t.h[n]=e},addController:function(e){w.trace("Adding controller id "+e._id(),{fileName:"kha/netsync/Session.hx",lineNumber:88,className:"kha.netsync.Session",methodName:"addController"}),e._inputBufferIndex=0;var t=this.controllers,n=e._id();t.h[n]=e},sendControllerUpdate:function(e,t){if(this.controllers.h.hasOwnProperty(e)){if(this.controllers.h[e]._inputBuffer.length<this.controllers.h[e]._inputBufferIndex+4+t.length){var n=new B(new ArrayBuffer(this.controllers.h[e]._inputBufferIndex+4+t.length));n.blit(0,this.controllers.h[e]._inputBuffer,0,this.controllers.h[e]._inputBufferIndex),this.controllers.h[e]._inputBuffer=n}this.controllers.h[e]._inputBuffer.setInt32(this.controllers.h[e]._inputBufferIndex,t.length),this.controllers.h[e]._inputBuffer.blit(this.controllers.h[e]._inputBufferIndex+4,t,0,t.length),this.controllers.h[e]._inputBufferIndex+=4+t.length}},sendPing:function(){var e=new B(new ArrayBuffer(5));e.b[0]=4,e.setFloat(1,_e.realTime()),this.sendToServer(e)},sendPlayerUpdate:function(){},receive:function(e){switch(e.b[0]){case 0:var t=e.b[1];this.localClient=new xn(t),_e.resetTime(),this.startCallback();break;case 1:for(var n=e.getDouble(1),i=9,d=this.entities.iterator();d.hasNext();){var a=d.next();a._receive(i,e),i+=a._size()}_e.warp(n);break;case 3:switch(e.b[1]){case 0:break;case 1:this.executeRPC(e);}break;case 4:var r=e.getFloat(1);this.ping=_e.realTime()-r;break;case 5:this.refusedCallback();break;case 6:this.currentPlayers=e.getInt32(1);}},executeRPC:function(e){var t=[],n=e.getInt32(2),d=6,a=e.getUInt16(d);d+=2;for(var r="",o=0;o<a;){var u=o++,i=e.b[d];r+=String.fromCodePoint(i),++d}var l=e.getUInt16(d);d+=2;for(var _="",f=0;f<l;){var c=f++,g=e.b[d];_+=String.fromCodePoint(g),++d}for(;d<e.length;){var h=e.b[d];switch(++d,h){case 66:var m=1==e.b[d];++d,w.trace("Bool: "+(null==m?"null":""+m),{fileName:"kha/netsync/Session.hx",lineNumber:295,className:"kha.netsync.Session",methodName:"executeRPC"}),t.push(m);break;case 70:var b=e.getDouble(d);d+=8,w.trace("Float: "+b,{fileName:"kha/netsync/Session.hx",lineNumber:300,className:"kha.netsync.Session",methodName:"executeRPC"}),t.push(b);break;case 73:var x=e.getInt32(d);d+=4,w.trace("Int: "+x,{fileName:"kha/netsync/Session.hx",lineNumber:305,className:"kha.netsync.Session",methodName:"executeRPC"}),t.push(x);break;case 83:var S=e.getUInt16(d);d+=2;for(var y="",T=0;T<S;){var E=T++,C=e.b[d];y+=String.fromCodePoint(C),++d}w.trace("String: "+y,{fileName:"kha/netsync/Session.hx",lineNumber:315,className:"kha.netsync.Session",methodName:"executeRPC"}),t.push(y);break;default:w.trace("Unknown argument type.",{fileName:"kha/netsync/Session.hx",lineNumber:318,className:"kha.netsync.Session",methodName:"executeRPC"});}}-1==n?p.field(s[r],_+"_remotely").apply(null,t):p.field(wn.objects[n],_+"_remotely").apply(wn.objects[n],t)},waitForStart:function(e,t,n,i,d){var a=this;this.startCallback=e,this.refusedCallback=t,this.resetCallback=d,this.network=new kha.netsync.Network(this.address,this.port,n,function(){i(),a.reset()}),this.network.listen(function(e){a.receive(e)}),this.updateTaskId=_e.addFrameTask(r(this,this.update),0),this.ping=1,this.pingTaskId=_e.addTimeTask(r(this,this.sendPing),0,1)},reset:function(){_e.removeFrameTask(this.updateTaskId),_e.removeTimeTask(this.pingTaskId),this.currentPlayers=0,this.ping=1,this.controllers=new C,this.entities=new C,this.resetCallback()},update:function(){for(var e=this.controllers.iterator();e.hasNext();){var t=e.next();if(0<t._inputBufferIndex){var n=new B(new ArrayBuffer(22+t._inputBufferIndex));n.b[0]=2,n.setInt32(1,t._id()),n.setDouble(5,_e.time()),n.setInt32(13,pe.windowWidth(0)),n.setInt32(17,pe.windowHeight(0)),n.b[21]=0,n.blit(22,t._inputBuffer,0,t._inputBufferIndex),this.sendToServer(n),t._inputBufferIndex=0}}},sendToServer:function(e){this.network.send(e,!1)},__class__:yn};var wn=function(){};s["kha.netsync.SyncBuilder"]=wn,wn.__name__=!0;var Tn=function(e,t,n,i){this._0=e,this._1=t,this._2=n,this._3=i};s["kha.simd.Float32x4"]=Tn,Tn.__name__=!0,Tn.create=function(){return new Tn(0,0,0,0)},Tn.loadAllFast=function(e){return new Tn(e,e,e,e)},Tn.load=function(e,t,n,i){return new Tn(e,t,n,i)},Tn.loadFast=function(e,t,n,i){return new Tn(e,t,n,i)},Tn.get=function(e,t){var n=0;return 0===t?n=e._0:1===t?n=e._1:2===t?n=e._2:3===t?n=e._3:void 0,n},Tn.getFast=function(e,t){return 0===t?e._0:1===t?e._1:2===t?e._2:3===t?e._3:0},Tn.abs=function(e){return new Tn(Math.abs(e._0),Math.abs(e._1),Math.abs(e._2),Math.abs(e._3))},Tn.add=function(e,t){return new Tn(e._0+t._0,e._1+t._1,e._2+t._2,e._3+t._3)},Tn.div=function(e,t){return new Tn(e._0/t._0,e._1/t._1,e._2/t._2,e._3/t._3)},Tn.mul=function(e,t){return new Tn(e._0*t._0,e._1*t._1,e._2*t._2,e._3*t._3)},Tn.neg=function(e){return new Tn(-e._0,-e._1,-e._2,-e._3)},Tn.reciprocalApproximation=function(){return new Tn(0,0,0,0)},Tn.reciprocalSqrtApproximation=function(){return new Tn(0,0,0,0)},Tn.sub=function(e,t){return new Tn(e._0-t._0,e._1-t._1,e._2-t._2,e._3-t._3)},Tn.sqrt=function(e){return new Tn(Math.sqrt(e._0),Math.sqrt(e._1),Math.sqrt(e._2),Math.sqrt(e._3))},Tn.prototype={_0:null,_1:null,_2:null,_3:null,__class__:Tn};var En=function(e){this.changed=!1,this.dragY=0,this.dragX=0,this.dragEnabled=!1,this.dragging=!1,this.lastMaxY=0,this.lastMaxX=0,this.layout=0,this.scrollEnabled=!1,this.scrollOffset=0,this.scrolling=!1,this.redraws=2,this.texture=null,this.text="",this.value=0,this.color=-1,this.position=0,this.selected=!1,null!=e&&(null!=e.selected&&(this.selected=e.selected),null!=e.position&&(this.position=e.position),null!=e.value&&(this.value=e.value),null!=e.text&&(this.text=e.text),null!=e.color&&(this.color=e.color),null!=e.layout&&(this.layout=e.layout))};s["zui.Handle"]=En,En.__name__=!0,En.prototype={selected:null,position:null,color:null,value:null,text:null,texture:null,redraws:null,scrolling:null,scrollOffset:null,scrollEnabled:null,layout:null,lastMaxX:null,lastMaxY:null,dragging:null,dragEnabled:null,dragX:null,dragY:null,changed:null,children:null,nest:function(e,t){null==this.children&&(this.children=new C);var n=this.children.h[e];if(null==n){var i=this.children;n=new En(t),i.h[e]=n}return n},__class__:En};var Cn=function(){};s["zui.Canvas"]=Cn,Cn.__name__=!0,Cn.draw=function(e,t,n){Cn.screenW=pe.windowWidth(),Cn.screenH=pe.windowHeight(),Cn.events=[],Cn._ui=e,n.end(),e.begin(n),n.begin(!1),e.g=n;for(var i=0,d=t.elements,a;i<d.length;)a=d[i],++i,null==a.parent&&Cn.drawElement(e,t,a);return n.end(),e.end(),n.begin(!1),Cn.events},Cn.drawElement=function(t,n,i,d,a){if(null==a&&(a=0),null==d&&(d=0),null!=i&&!1!=i.visible){var r=0|n.width*Cn._ui.SCALE,s=0|n.height*Cn._ui.SCALE;switch(i.anchor){case 1:d-=(r-Cn.screenW)/2;break;case 2:d-=r-Cn.screenW;break;case 3:a-=(s-Cn.screenH)/2;break;case 4:d-=(r-Cn.screenW)/2,a-=(s-Cn.screenH)/2;break;case 5:d-=r-Cn.screenW,a-=(s-Cn.screenH)/2;break;case 6:a-=s-Cn.screenH;break;case 7:d-=(r-Cn.screenW)/2,a-=s-Cn.screenH;break;case 8:d-=r-Cn.screenW,a-=s-Cn.screenH;}t._x=n.x+(0|i.x*Cn._ui.SCALE)+(0|d*Cn._ui.SCALE),t._y=n.y+(0|i.y*Cn._ui.SCALE)+(0|a*Cn._ui.SCALE),t._w=0|i.width*Cn._ui.SCALE;var o=null!=i.rotation&&0!=i.rotation;switch(o&&t.g.pushRotation(i.rotation,t._x+(0|i.width*Cn._ui.SCALE)/2,t._y+(0|i.height*Cn._ui.SCALE)/2),i.type){case 0:var u=t.ops.font,l=t.fontSize,_=t.t.TEXT_COL,f=null!=i.asset&&m.endsWith(i.asset,".ttf");f&&(t.ops.font=Cn.getAsset(n,i.asset)),t.fontSize=0|i.height*Cn._ui.SCALE,t.t.TEXT_COL=i.color_text,t.text(i.text,i.alignment),t.ops.font=u,t.fontSize=l,t.t.TEXT_COL=_;break;case 1:var c=Cn.getAsset(n,i.asset),g=null!=i.asset&&m.endsWith(i.asset,".ttf");if(null!=c&&!g){t.imageScrollAlign=!1;var p=null==i.color?-1:i.color;if(3==t.image(c,p,0|i.height*Cn._ui.SCALE)){var h=i.event;null!=h&&""!=h&&Cn.events.push(h)}t.imageScrollAlign=!0}break;case 2:var e=t.t.BUTTON_H;if(t.t.BUTTON_H=0|i.height*Cn._ui.SCALE,t.t.BUTTON_COL=i.color,t.t.BUTTON_TEXT_COL=i.color_text,t.t.BUTTON_HOVER_COL=i.color_hover,t.t.BUTTON_PRESSED_COL=i.color_press,t.button(i.text,i.alignment)){var b=i.event;null!=b&&""!=b&&Cn.events.push(b)}t.t.BUTTON_H=e;break;case 3:break;case 6:t.t.TEXT_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.check(Cn.h.nest(i.id),i.text);break;case 7:t.t.TEXT_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.inlineRadio(Cn.h.nest(i.id),i.text.split(";"));break;case 8:t.t.TEXT_COL=i.color_text,t.t.LABEL_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.SEPARATOR_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.combo(Cn.h.nest(i.id),i.text.split(";"));break;case 9:t.t.TEXT_COL=i.color_text,t.t.LABEL_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.slider(Cn.h.nest(i.id),i.text,0,1,!0,100,!0,i.alignment);break;case 10:t.t.TEXT_COL=i.color_text,t.t.LABEL_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,t.textInput(Cn.h.nest(i.id),i.text,i.alignment);break;case 11:t.t.TEXT_COL=i.color_text,t.t.LABEL_COL=i.color_text,t.t.ACCENT_COL=i.color,t.t.ACCENT_HOVER_COL=i.color_hover,In.keyInput(t,Cn.h.nest(i.id),i.text);break;case 12:var x=t.g.get_color();t.g.set_color(i.color),t.g.fillRect(t._x,t._y,t._w,0|i.height*Cn._ui.SCALE),t.g.set_color(x);break;case 13:var S=t.g.get_color();t.g.set_color(i.color),t.g.drawRect(t._x,t._y,t._w,0|i.height*Cn._ui.SCALE,i.strength),t.g.set_color(S);break;case 14:var y=t.g.get_color();t.g.set_color(i.color),ut.fillCircle(t.g,t._x+(0|i.width*Cn._ui.SCALE)/2,t._y+(0|i.height*Cn._ui.SCALE)/2,t._w/2),t.g.set_color(y);break;case 15:var w=t.g.get_color();t.g.set_color(i.color),ut.drawCircle(t.g,t._x+(0|i.width*Cn._ui.SCALE)/2,t._y+(0|i.height*Cn._ui.SCALE)/2,t._w/2,i.strength),t.g.set_color(w);break;case 16:var T=t.g.get_color();t.g.set_color(i.color),t.g.fillTriangle(t._x+t._w/2,t._y,t._x,t._y+(0|i.height*Cn._ui.SCALE),t._x+t._w,t._y+(0|i.height*Cn._ui.SCALE)),t.g.set_color(T);break;case 17:var E=t.g.get_color();t.g.set_color(i.color),t.g.drawLine(t._x+t._w/2,t._y,t._x,t._y+(0|i.height*Cn._ui.SCALE),i.strength),t.g.drawLine(t._x,t._y+(0|i.height*Cn._ui.SCALE),t._x+t._w,t._y+(0|i.height*Cn._ui.SCALE),i.strength),t.g.drawLine(t._x+t._w,t._y+(0|i.height*Cn._ui.SCALE),t._x+t._w/2,t._y,i.strength),t.g.set_color(E);break;case 18:var C=t.g.get_color(),I=i.progress_at,v=i.progress_total;t.g.set_color(i.color_progress),t.g.fillRect(t._x,t._y,t._w/v*Math.min(I,v),0|i.height*Cn._ui.SCALE),t.g.set_color(i.color),t.g.drawRect(t._x,t._y,t._w,0|i.height*Cn._ui.SCALE,i.strength),t.g.set_color(C);break;case 19:var k=t.g.get_color(),L=i.progress_at,B=i.progress_total;t.g.set_color(i.color_progress),ut.drawArc(t.g,t._x+(0|i.width*Cn._ui.SCALE)/2,t._y+(0|i.height*Cn._ui.SCALE)/2,t._w/2,-Math.PI/2,2*Math.PI/B*L-Math.PI/2,i.strength),t.g.set_color(i.color),ut.fillCircle(t.g,t._x+(0|i.width*Cn._ui.SCALE)/2,t._y+(0|i.height*Cn._ui.SCALE)/2,t._w/2-10),t.g.set_color(k);}if(null!=i.children)for(var O=0,N=i.children,A;O<N.length;)A=N[O],++O,Cn.drawElement(t,n,Cn.elemById(n,A),i.x+d,i.y+a);o&&t.g.popTransformation()}},Cn.getText=function(t,n){return n.text},Cn.getAsset=function(e,t){for(var n=0,i=e.assets,d;n<i.length;)if(d=i[n],++n,d.name==t)return Cn.assetMap.h[d.id];return null},Cn.getElementId=function(t){if(-1==Cn.elemId)for(var n=0,i=t.elements,d;n<i.length;)d=i[n],++n,Cn.elemId<d.id&&(Cn.elemId=d.id);return++Cn.elemId},Cn.getAssetId=function(e){if(-1==Cn.assetId)for(var t=0,n=e.assets,i;t<n.length;)i=n[t],++t,Cn.assetId<i.id&&(Cn.assetId=i.id);return++Cn.assetId},Cn.elemById=function(t,n){for(var i=0,d=t.elements,a;i<d.length;)if(a=d[i],++i,a.id==n)return a;return null},Cn.scaled=function(e){return 0|e*Cn._ui.SCALE};var In=function(){};s["zui.Ext"]=In,In.__name__=!0,In.floatInput=function(e,t,n,i){null==i&&(i=0),null==n&&(n=""),t.text=null==t.value?"null":""+t.value;var d=e.textInput(t,n,i);return t.value=parseFloat(d),t.value},In.keyInput=function(e,t,n,i){if(null==i&&(i=0),null==n&&(n=""),!e.isVisible(e.t.ELEMENT_H*e.SCALE))return e.endElement(),0|t.value;var d=e.getHover();d&&null!=Ln.onTextHover&&Ln.onTextHover(),e.g.set_color(d?e.t.ACCENT_HOVER_COL:e.t.ACCENT_COL);var a=e.g,r=e.t.FILL_ACCENT_BG,s=e._x+e.buttonOffsetY,o=e._y+e.buttonOffsetY,u=e._w-2*e.buttonOffsetY,l=e.t.BUTTON_H*e.SCALE,_=0;0==_&&(_=e.t.LINE_STRENGTH*e.SCALE),e.enabled||e.fadeColor(),r?a.fillRect(s,o,u,l):a.drawRect(s,o,u,l,_);var f=e.getReleased()||e.tabPressed;if(e.textSelectedHandle!=t&&f&&e.startTextEdit(t),e.textSelectedHandle==t?In.listenToKey(e,t):t.changed=!1,""!=n){e.g.set_color(e.t.LABEL_COL);var c=2==i?0:2,g=0==c?7:0;e.drawString(e.g,n,g,0,c)}return t.text=In.keycodeToString(0|t.value),e.g.set_color(e.t.TEXT_COL),e.textSelectedHandle==t?e.drawString(e.g,e.textSelectedCurrentText,null,0,i):e.drawString(e.g,t.text,null,0,i),e.endElement(),0|t.value},In.listenToKey=function(e,t){e.isKeyDown?(t.value=e.key,t.changed=e.changed=!0,e.textSelectedHandle=null,e.isTyping=!1,null!=Qt.get()&&Qt.get().hide()):e.textSelectedCurrentText="Press a key..."},In.list=function(e,t,n,i){var d=0;null==i&&(i={});for(var a=null==i.addCb?function(e){n.push(e)}:i.addCb,r=null==i.removeCb?function(e){n.splice(e,1)}:i.removeCb,s=null==i.getNameCb?function(e){return n[e]}:i.getNameCb,o=null==i.setNameCb?function(e,t){n[e]=t}:i.setNameCb,u=null==i.getLabelCb?function(){return""}:i.getLabelCb,l=i.itemDrawCb,_=null!=i.showRadio&&i.showRadio,f=null==i.editable||i.editable,c=null==i.showAdd||i.showAdd,g=null==i.addLabel?"Add":i.addLabel,p=0;p<n.length;){_?(e.row([.12,.68,.2]),e.radio(t.nest(0),p,"")&&(d=p)):e.row([.8,.2]);var h=t.nest(p);h.text=s(p),f?o(p,e.textInput(h,u(p))):e.text(s(p)),e.button("X")?r(p):++p,null!=l&&l(h.nest(p),p-1)}return c&&e.button(g)&&a("untitled"),d},In.panelList=function(e,t,n,i,d,a,r,s,o,u,l){null==l&&(l="Add"),null==u&&(u=!0),null==o&&(o=!0),null==i&&(i=function(e){n.push(e)}),null==d&&(d=function(e){n.splice(e,1)}),null==a&&(a=function(e){return n[e]}),null==r&&(r=function(e,t){n[e]=t});for(var _=0;_<n.length;){e.row([.12,.68,.2]);var f=e.panel(t.nest(_),"",0),c=t.nest(_);o?r(_,e.textInput(c,a(_))):e.text(a(_)),e.button("X")?d(_):++_,null!=s&&f&&s(c.nest(_),_-1)}u&&e.button(l)&&i("untitled")},In.colorPicker=function(e,t,n){null==n&&(n=!1);var i=e.slider(t.nest(0,{value:.00392156862745098*((16711680&t.color)>>>16)}),"R",0,1,!0),d=e.slider(t.nest(1,{value:.00392156862745098*((65280&t.color)>>>8)}),"G",0,1,!0),r=e.slider(t.nest(2,{value:.00392156862745098*(255&t.color)}),"B",0,1,!0),s=.00392156862745098*(t.color>>>24);n&&(s=e.slider(t.nest(3,{value:s}),"A",0,1,!0));var o=Q.fromFloats(i,d,r,s);return e.text("",2,o),o},In.initPath=function(e,t){e.text="Windows"==t?"C:\\Users":"/"},In.fileBrowser=function(e,t,n){null==n&&(n=!1);var i="/",d="ls ",a=pe.get_systemId();"Windows"==a&&(d="dir /b ",n&&(d+="/ad "),i="\\",t.text=m.replace(t.text,"\\\\","\\"),t.text=m.replace(t.text,"\r","")),""==t.text&&In.initPath(t,a);var r=Krom.getFilesLocation()+i+In.dataPath+"dir.txt";t.text!=In.lastPath&&Krom.sysCommand(d+"\""+t.text+"\" > \""+r+"\""),In.lastPath=t.text;var s=B.ofData(Krom.loadBlob(r)).toString(),o=s.split("\n"),u=t.text.indexOf("/"),l=t.text.indexOf("\\"),_=-1<u&&t.text.length-1>u||-1<l&&t.text.length-1>l;_&&e.button("..",0)&&(t.text=t.text.substring(0,t.text.lastIndexOf(i)),2==t.text.length&&":"==t.text.charAt(1)&&(t.text+=i));for(var c=0,g;c<o.length;)g=o[c],(++c,""!=g&&"."!=g.charAt(0))&&e.button(g,0)&&(t.text.charAt(t.text.length-1)!=i&&(t.text+=i),t.text+=g);return t.text},In.colorWheel=function(e,t,n,i,d){null==d&&(d=!1),null==n&&(n=!1),null==i&&(i=e._w),In.rgbToHsv(.00392156862745098*((16711680&t.color)>>>16),.00392156862745098*((65280&t.color)>>>8),.00392156862745098*(255&t.color),In.ar);var a=In.ar[0],r=In.ar[1],s=In.ar[2],o=.00392156862745098*(t.color>>>24),u=e._x,l=e._y,_=null!=e.currentWindow&&e.currentWindow.scrollEnabled;_||(i-=0|e.t.SCROLL_W*e.SCALE,u+=(0|e.t.SCROLL_W*e.SCALE)/2),e.image(e.ops.color_wheel,Q.fromFloats(s,s,s));var f=e._y-l,c=u+i/2,g=l+f/2,p=.7*i,h=p/2,m=c,b=g+r*h,x=a*(2*Math.PI),S=Math.cos(x)*(m-c)-Math.sin(x)*(b-g)+c,y=Math.sin(x)*(m-c)+Math.cos(x)*(b-g)+g;m=S,b=y,e.g.set_color(-16777216),e.g.fillRect(m-3*e.SCALE,b-3*e.SCALE,6*e.SCALE,6*e.SCALE),e.g.set_color(-1),e.g.fillRect(m-2*e.SCALE,b-2*e.SCALE,4*e.SCALE,4*e.SCALE),d&&(n?e.row([.3333333333333333,.3333333333333333,.3333333333333333]):e.row([.5,.5]));var T=t.nest(0);if(T.value=Math.round(100*s)/100,s=e.slider(T,"Value",0,1,!0),T.changed&&(t.changed=e.changed=!0),n){var E=t.nest(1,{value:Math.round(100*o)/100});o=e.slider(E,"Alpha",0,1,!0),E.changed&&(t.changed=e.changed=!0)}var C=c+e._windowX,I=g+e._windowY;if(e.inputStarted&&e.getInputInRect(C-h,I-h,p,p)&&(In.wheelSelectedHande=t),e.inputReleased&&(In.wheelSelectedHande=null),e.inputDown&&In.wheelSelectedHande==t){var v=C-e.inputX,k=I-e.inputY;r=Math.min(Math.sqrt(v*v+k*k),h)/h;var L=Math.atan2(e.inputX-C,e.inputY-I);0>L&&(L=Math.PI+(Math.PI-Math.abs(L))),L=2*Math.PI-L,a=L/(2*Math.PI),t.changed=e.changed=!0}return In.hsvToRgb(a,r,s,In.ar),t.color=Q.fromFloats(In.ar[0],In.ar[1],In.ar[2],o),e.text("",2,t.color),t.color},In.keycodeToString=function(e){return-1===e?"None":0===e?"Unknown":1===e?"Back":3===e?"Cancel":6===e?"Help":8===e?"Backspace":9===e?"Tab":12===e?"Clear":13===e?"Return":16===e?"Shift":17===e?"Ctrl":18===e?"Alt":19===e?"Pause":20===e?"CapsLock":21===e?"Kana":22===e?"Eisu":23===e?"Junja":24===e?"Final":25===e?"Hanja":27===e?"Esc":28===e?"Convert":29===e?"NonConvert":30===e?"Accept":31===e?"ModeChange":32===e?"Space":33===e?"PageUp":34===e?"PageDown":35===e?"End":36===e?"Home":37===e?"Left":38===e?"Up":39===e?"Right":40===e?"Down":41===e?"Select":42===e?"Print":43===e?"Execute":44===e?"PrintScreen":45===e?"Insert":46===e?"Delete":58===e?"Colon":59===e?"Semicolon":60===e?"LessThan":61===e?"Equals":62===e?"GreaterThan":63===e?"QuestionMark":64===e?"At":91===e?"Win":93===e?"ContextMenu":95===e?"Sleep":96===e?"Numpad0":97===e?"Numpad1":98===e?"Numpad2":99===e?"Numpad3":100===e?"Numpad4":101===e?"Numpad5":102===e?"Numpad6":103===e?"Numpad7":104===e?"Numpad8":105===e?"Numpad9":106===e?"Multiply":107===e?"Add":108===e?"Separator":109===e?"Subtract":110===e?"Decimal":111===e?"Divide":112===e?"F1":113===e?"F2":114===e?"F3":115===e?"F4":116===e?"F5":117===e?"F6":118===e?"F7":119===e?"F8":120===e?"F9":121===e?"F10":122===e?"F11":123===e?"F12":124===e?"F13":125===e?"F14":126===e?"F15":127===e?"F16":128===e?"F17":129===e?"F18":130===e?"F19":131===e?"F20":132===e?"F21":133===e?"F22":134===e?"F23":135===e?"F24":144===e?"NumLock":145===e?"ScrollLock":146===e?"WinOemFjJisho":147===e?"WinOemFjMasshou":148===e?"WinOemFjTouroku":149===e?"WinOemFjLoya":150===e?"WinOemFjRoya":160===e?"Circumflex":161===e?"Exclamation":162===e?"DoubleQuote":163===e?"Hash":164===e?"Dollar":165===e?"Percent":166===e?"Ampersand":167===e?"Underscore":168===e?"OpenParen":169===e?"CloseParen":170===e?"Asterisk":171===e?"Plus":172===e?"Pipe":173===e?"HyphenMinus":174===e?"OpenCurlyBracket":175===e?"CloseCurlyBracket":176===e?"Tilde":181===e?"VolumeMute":182===e?"VolumeDown":183===e?"VolumeUp":188===e?"Comma":190===e?"Period":191===e?"Slash":192===e?"BackQuote":219===e?"OpenBracket":220===e?"BackSlash":221===e?"CloseBracket":222===e?"Quote":224===e?"Meta":225===e?"AltGr":227===e?"WinIcoHelp":228===e?"WinIco00":230===e?"WinIcoClear":233===e?"WinOemReset":234===e?"WinOemJump":235===e?"WinOemPA1":236===e?"WinOemPA2":237===e?"WinOemPA3":238===e?"WinOemWSCTRL":239===e?"WinOemCUSEL":240===e?"WinOemATTN":241===e?"WinOemFinish":242===e?"WinOemCopy":243===e?"WinOemAuto":244===e?"WinOemENLW":245===e?"WinOemBackTab":246===e?"ATTN":247===e?"CRSEL":248===e?"EXSEL":249===e?"EREOF":250===e?"Play":251===e?"Zoom":253===e?"PA1":254===e?"WinOemClear":String.fromCodePoint(e)},In.dist=function(e,t,n,i){var d=e-n,a=t-i;return Math.sqrt(d*d+a*a)},In.fract=function(e){return e-(0|e)},In.mix=function(e,t,n){return e*(1-n)+t*n},In.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},In.step=function(e,t){return t<e?0:1},In.hsvToRgb=function(e,t,n,i){var d=e+1,a=Math.abs(6*(d-(0|d))-3),r=e+.6666666666666666,s=Math.abs(6*(r-(0|r))-3),o=e+.3333333333333333,u=Math.abs(6*(o-(0|o))-3);i[0]=n*(1-t+Math.min(Math.max(a-1,0),1)*t),i[1]=n*(1-t+Math.min(Math.max(s-1,0),1)*t),i[2]=n*(1-t+Math.min(Math.max(u-1,0),1)*t)},In.rgbToHsv=function(e,t,n,i){var r=t<n?0:1,a=n*(1-r)+t*r,s=t<n?0:1,o=t*(1-s)+n*s,u=t<n?0:1,l=t<n?0:1,_=e<a?0:1,f=a*(1-_)+e*_,c=e<a?0:1,g=o*(1-c)+o*c,p=e<a?0:1,h=e<a?0:1,m=e*(1-h)+a*h,b=f-Math.min(m,g);i[0]=Math.abs((.6666666666666666*(1-l)+-.3333333333333333*l)*(1-p)+(-1*(1-u)+0*u)*p+(m-g)/(6*b+1e-10)),i[1]=b/(f+1e-10),i[2]=f};var vn=function(){};s["zui.Id"]=vn,vn.__name__=!0;var kn=function(){};s["zui.Themes"]=kn,kn.__name__=!0;var Ln=function(e){this.restoreY=-1,this.restoreX=-1,this.checkSelectImage=null,this.elementsBaked=!1,this.tabScroll=0,this.tabHandle=null,this.tabNames=null,this.tooltipTime=0,this.tooltipWait=!1,this.tooltipShown=!1,this.tooltipY=0,this.tooltipX=0,this.tooltipInvertY=!1,this.tooltipImgMaxWidth=null,this.tooltipImg=null,this.tooltipText="",this.comboToSubmit=0,this.submitComboHandle=null,this.comboSelectedWindow=null,this.comboSelectedHandle=null,this.tabPressedHandle=null,this.tabPressed=!1,this.textToSubmit="",this.submitTextHandle=null,this.textSelectedHandle=null,this.windowHeader=0,this.scrollingHandle=null,this.windowEnded=!0,this._windowY=0,this._windowX=0,this.imageScrollAlign=!0,this.scrollAlign=0,this.curRatio=-1,this.highlightAnchor=0,this.cursorY=0,this.cursorX=0,this.key=null,this.isReturnDown=!1,this.isEscapeDown=!1,this.isDeleteDown=!1,this.isBackspaceDown=!1,this.isAltDown=!1,this.isCtrlDown=!1,this.isShiftDown=!1,this.isKeyDown=!1,this.isKeyPressed=!1,this.inputWheelDelta=0,this.inputEnabled=!0,this.inputRegistered=!1,this.alwaysRedraw=!1,this.scrollEnabled=!0,this.imageInvertY=!1,this.changed=!1,this.isReleased=!1,this.isHovered=!1,this.isPushed=!1,this.isStarted=!1,this.enabled=!0,this.isTyping=!1,this.isScrolling=!1,null==e.theme&&(e.theme=kn.dark),this.t=e.theme,null==e.khaWindowId&&(e.khaWindowId=0),null==e.scaleFactor&&(e.scaleFactor=1),null==e.scaleTexture&&(e.scaleTexture=1),null==e.autoNotifyInput&&(e.autoNotifyInput=!0),this.ops=e,this.setScale(e.scaleFactor),e.autoNotifyInput&&this.registerInput(),null==Ln.copyReceiver&&(Ln.copyReceiver=this,pe.notifyOnCutCopyPaste(r(this,this.onCut),r(this,this.onCopy),r(this,this.onPaste)),pe.notifyOnFrames(function(){(Ln.isCopy||Ln.isPaste)&&1<++Ln.copyFrame&&(Ln.isCopy=Ln.isCut=Ln.isPaste=!1,Ln.copyFrame=0)}));var t=Vt.createTextVertexStructure();this.rtTextPipeline=Vt.createTextPipeline(t),this.rtTextPipeline.alphaBlendSource=1,this.rtTextPipeline.compile()};s["zui.Zui"]=Ln,Ln.__name__=!0,Ln.prototype={isScrolling:null,isTyping:null,enabled:null,isStarted:null,isPushed:null,isHovered:null,isReleased:null,changed:null,imageInvertY:null,scrollEnabled:null,alwaysRedraw:null,inputRegistered:null,inputEnabled:null,inputX:null,inputY:null,inputInitialX:null,inputInitialY:null,inputDX:null,inputDY:null,inputWheelDelta:null,inputStarted:null,inputStartedR:null,inputReleased:null,inputReleasedR:null,inputDown:null,inputDownR:null,isKeyPressed:null,isKeyDown:null,isShiftDown:null,isCtrlDown:null,isAltDown:null,isBackspaceDown:null,isDeleteDown:null,isEscapeDown:null,isReturnDown:null,key:null,char:null,cursorX:null,cursorY:null,highlightAnchor:null,ratios:null,curRatio:null,xBeforeSplit:null,wBeforeSplit:null,g:null,globalG:null,rtTextPipeline:null,t:null,SCALE:null,ops:null,fontSize:null,fontOffsetY:null,arrowOffsetX:null,arrowOffsetY:null,titleOffsetX:null,buttonOffsetY:null,checkOffsetX:null,checkOffsetY:null,checkSelectOffsetX:null,checkSelectOffsetY:null,radioOffsetX:null,radioOffsetY:null,radioSelectOffsetX:null,radioSelectOffsetY:null,scrollAlign:null,imageScrollAlign:null,_x:null,_y:null,_w:null,_h:null,_windowX:null,_windowY:null,_windowW:null,_windowH:null,currentWindow:null,windowEnded:null,scrollingHandle:null,windowHeader:null,textSelectedHandle:null,textSelectedCurrentText:null,submitTextHandle:null,textToSubmit:null,tabPressed:null,tabPressedHandle:null,comboSelectedHandle:null,comboSelectedWindow:null,comboSelectedAlign:null,comboSelectedTexts:null,comboSelectedLabel:null,comboSelectedX:null,comboSelectedY:null,comboSelectedW:null,submitComboHandle:null,comboToSubmit:null,tooltipText:null,tooltipImg:null,tooltipImgMaxWidth:null,tooltipInvertY:null,tooltipX:null,tooltipY:null,tooltipShown:null,tooltipWait:null,tooltipTime:null,tabNames:null,tabHandle:null,tabScroll:null,elementsBaked:null,checkSelectImage:null,setScale:function(e){this.ops.scaleFactor=e,this.SCALE=this.ops.scaleFactor*this.ops.scaleTexture,this.fontSize=0|this.t.FONT_SIZE*this.ops.scaleFactor;var t=this.ops.font.height(this.fontSize);this.fontOffsetY=(this.t.ELEMENT_H*this.SCALE-t)/2,this.arrowOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.ARROW_SIZE*this.SCALE)/2,this.arrowOffsetX=this.arrowOffsetY,this.titleOffsetX=(2*this.arrowOffsetX+this.t.ARROW_SIZE*this.SCALE)/this.SCALE,this.buttonOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.BUTTON_H*this.SCALE)/2,this.checkOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.CHECK_SIZE*this.SCALE)/2,this.checkOffsetX=this.checkOffsetY,this.checkSelectOffsetY=(this.t.CHECK_SIZE*this.SCALE-this.t.CHECK_SELECT_SIZE*this.SCALE)/2,this.checkSelectOffsetX=this.checkSelectOffsetY,this.radioOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.CHECK_SIZE*this.SCALE)/2,this.radioOffsetX=this.radioOffsetY,this.radioSelectOffsetY=(this.t.CHECK_SIZE*this.SCALE-this.t.CHECK_SELECT_SIZE*this.SCALE)/2,this.radioSelectOffsetX=this.radioSelectOffsetY,this.elementsBaked=!1},bakeElements:function(){null!=this.checkSelectImage&&this.checkSelectImage.unload(),this.checkSelectImage=de.createRenderTarget(0|this.t.CHECK_SELECT_SIZE*this.SCALE,0|this.t.CHECK_SELECT_SIZE*this.SCALE,null,0,1,this.ops.khaWindowId);var e=this.checkSelectImage.get_g2();e.begin(!0,0),e.set_color(this.t.ACCENT_SELECT_COL),e.drawLine(0,0,this.checkSelectImage.get_width(),this.checkSelectImage.get_height(),2*this.SCALE),e.drawLine(this.checkSelectImage.get_width(),0,0,this.checkSelectImage.get_height(),2*this.SCALE),e.end(),this.elementsBaked=!0},remove:function(){this.ops.autoNotifyInput&&this.unregisterInput()},registerInput:function(){Jt.get().notifyWindowed(this.ops.khaWindowId,r(this,this.onMouseDown),r(this,this.onMouseUp),r(this,this.onMouseMove),r(this,this.onMouseWheel)),Qt.get().notify(r(this,this.onKeyDown),r(this,this.onKeyUp),r(this,this.onKeyPress)),this.inputRegistered=!0},unregisterInput:function(){Jt.get().removeWindowed(this.ops.khaWindowId,r(this,this.onMouseDown),r(this,this.onMouseUp),r(this,this.onMouseMove),r(this,this.onMouseWheel)),Qt.get().remove(r(this,this.onKeyDown),r(this,this.onKeyUp),r(this,this.onKeyPress)),this.endInput(),this.inputX=this.inputY=0,this.inputRegistered=!1},begin:function(e){this.elementsBaked||this.bakeElements(),this.changed=!1,this.globalG=e,this._x=0,this._y=0,this._w=0,this._h=0},end:function(e){null==e&&(e=!0),this.windowEnded||this.endWindow(),null!=this.comboSelectedHandle&&this.drawCombo(),""!=this.tooltipText||null!=this.tooltipImg?(this.inputChanged()&&(this.tooltipShown=!1,this.tooltipWait=0==this.inputDX&&0==this.inputDY),!this.tooltipShown&&(this.tooltipShown=!0,this.tooltipX=this.inputX,this.tooltipTime=_e.time()),!this.tooltipWait&&1<_e.time()-this.tooltipTime&&(""==this.tooltipText?this.drawTooltipImage():this.drawTooltip())):this.tooltipShown=!1,e&&this.endInput(),this.tabPressedHandle=null},endInput:function(){this.isKeyPressed=!1,this.inputStarted=!1,this.inputStartedR=!1,this.inputReleased=!1,this.inputReleasedR=!1,this.inputDX=0,this.inputDY=0,this.inputWheelDelta=0,Ln.textToPaste=""},beginLayout:function(e,t,n,i){this.elementsBaked||this.bakeElements(),this.currentWindow=null,this.g=e,this._windowX=0,this._windowY=0,this._windowW=i,this._x=t,this._y=n,this._w=i},endLayout:function(e){null==e&&(e=!0),e&&this.endInput()},inputChanged:function(){return!!(0!=this.inputDX||0!=this.inputDY||0!=this.inputWheelDelta||this.inputStarted||this.inputStartedR||this.inputReleased||this.inputReleasedR||this.inputDown||this.inputDownR)||this.isKeyPressed},windowDirty:function(e,t,n,i,d){var a=t+e.dragX,r=n+e.dragY,s=this.getInputInRect(a,r,i,d)&&this.inputChanged();return!!(this.alwaysRedraw||this.isScrolling||this.isTyping)||s},window:function(e,t,n,i,d,a){return(null==a&&(a=!1),(null==e.texture||i!=e.texture.get_width()||d!=e.texture.get_height())&&this.resize(e,i,d,this.ops.khaWindowId),this.windowEnded||this.endWindow(),this.windowEnded=!1,this.g=e.texture.get_g2(),this.currentWindow=e,this._windowX=t+e.dragX,this._windowY=n+e.dragY,this._windowW=i,this._windowH=d,this.windowHeader=0,this.windowDirty(e,t,n,i,d)&&(e.redraws=2),null!=Ln.onBorderHover&&(this.getInputInRect(this._windowX-4,this._windowY,8,this._windowH)?Ln.onBorderHover(e,0):this.getInputInRect(this._windowX+this._windowW-4,this._windowY,8,this._windowH)?Ln.onBorderHover(e,1):this.getInputInRect(this._windowX,this._windowY-4,this._windowW,8)?Ln.onBorderHover(e,2):this.getInputInRect(this._windowX,this._windowY+this._windowH-4,this._windowW,8)&&Ln.onBorderHover(e,3)),!(0>=e.redraws))&&(this._x=0,this._y=e.scrollOffset,1==e.layout&&(i=0|this.t.ELEMENT_W*this.SCALE),this._w=e.scrollEnabled?i-(0|this.t.SCROLL_W*this.SCALE):i,this._h=d,this.tooltipText="",this.tooltipImg=null,this.tabNames=null,this.t.FILL_WINDOW_BG?this.g.begin(!0,this.t.WINDOW_BG_COL):(this.g.begin(!0,0),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x,this._y-e.scrollOffset,e.lastMaxX,e.lastMaxY)),e.dragEnabled=a,a&&(this.inputStarted&&this.getInputInRect(this._windowX,this._windowY,this._windowW,15)?e.dragging=!0:this.inputReleased&&(e.dragging=!1),e.dragging&&(e.redraws=2,e.dragX+=0|this.inputDX,e.dragY+=0|this.inputDY),this._y+=15,this.windowHeader+=15),!0)},endWindow:function(e){null==e&&(e=!0);var t=this.currentWindow;if(null!=t){if(0<t.redraws||this.isScrolling||this.isTyping){null!=this.tabNames&&this.drawTabs(),t.dragEnabled&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,0,this._windowW,15));var n=this._y-t.scrollOffset;if(n<this._windowH||1==t.layout||!this.scrollEnabled)t.scrollEnabled=!1,t.scrollOffset=0;else{t.scrollEnabled=!0,0>this.tabScroll&&(t.scrollOffset=this.tabScroll,this.tabScroll=0);var i=n-this._windowH,d=-t.scrollOffset,a=this._windowH*Math.abs(this._windowH/n);a=Math.max(a,this.t.ELEMENT_H*this.SCALE);var r=this._windowH-a,s=r*(d/i),o=this.getInputInRect(this._windowX+this._windowW-(0|this.t.SCROLL_W*this.SCALE),s+this._windowY,0|this.t.SCROLL_W*this.SCALE,a);this.inputStarted&&o&&(t.scrolling=!0,this.scrollingHandle=t,this.isScrolling=!0),t.scrolling?this.scroll(this.inputDY*(i/r),n):0!=this.inputWheelDelta&&null==this.comboSelectedHandle&&this.getInputInRect(this._windowX,this._windowY,this._windowW,this._windowH)&&this.scroll(this.inputWheelDelta*(this.t.ELEMENT_H*this.SCALE),n),0<t.scrollOffset?t.scrollOffset=0:n+t.scrollOffset<this._windowH&&(t.scrollOffset=this._windowH-n),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._windowW-(0|this.t.SCROLL_W*this.SCALE),this._windowY,0|this.t.SCROLL_W*this.SCALE,this._windowH),this.g.set_color(this.t.ACCENT_COL);var u=this.getInputInRect(this._windowX+this._windowW-(0|this.t.SCROLL_W*this.SCALE),this._windowY,0|this.t.SCROLL_W*this.SCALE,this._windowH),l=u||t.scrolling?0|this.t.SCROLL_W*this.SCALE:(0|this.t.SCROLL_W*this.SCALE)/3;this.g.fillRect(this._windowW-l-this.scrollAlign,s,l,a)}t.lastMaxX=this._x,t.lastMaxY=this._y,0==t.layout?t.lastMaxX+=this._windowW:t.lastMaxY+=this._windowH,t.redraws--,this.g.end()}this.windowEnded=!0,(Ln.alwaysRedrawWindow||-4<t.redraws)&&(e&&this.globalG.begin(!1),this.globalG.set_color(this.t.WINDOW_TINT_COL),this.globalG.drawScaledImage(t.texture,this._windowX,this._windowY,t.texture.get_width()/this.ops.scaleTexture,t.texture.get_height()/this.ops.scaleTexture),e&&this.globalG.end(),0>=t.redraws&&t.redraws--)}},scroll:function(e){this.currentWindow.scrollOffset-=e},restoreX:null,restoreY:null,tab:function(e,t){null==this.tabNames&&(this.tabNames=[],this.tabHandle=e,this.windowHeader+=this.buttonOffsetY+this.t.BUTTON_H*this.SCALE,this.restoreX=this.inputX,this.restoreY=this.inputY,this.getInputInRect(this._windowX,this._windowY,this._windowW,this.windowHeader)&&(this.inputX=this.inputY=-1)),this.tabNames.push(t);var n=e.position==this.tabNames.length-1;return n&&this.endElement(),n},drawTabs:function(){if(this.inputX=this.restoreX,this.inputY=this.restoreY,null!=this.currentWindow){var e=0,t=0|1.1*(this.t.BUTTON_H*this.SCALE),n=this._y;this._y=this.currentWindow.dragEnabled?15:0,this.tabHandle.changed=!1,this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,this._y,this._windowW,this.buttonOffsetY+t+2),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this.buttonOffsetY,this._y+this.buttonOffsetY+t+2,this._windowW-2*this.buttonOffsetY,this.t.LINE_STRENGTH*this.SCALE),this._y+=2;for(var d=0,a=this.tabNames.length,r;d<a;){r=d++,this._x=e,this._w=0|this.ops.font.width(this.fontSize,this.tabNames[r])+2*this.buttonOffsetY+14*this.SCALE;var s=this.getReleased(),o=this.getPushed(),u=this.getHover();if(s){var l=this.tabHandle.nest(this.tabHandle.position);l.scrollOffset=this.currentWindow.scrollOffset,l=this.tabHandle.nest(r),this.tabScroll=l.scrollOffset,this.tabHandle.position=r,this.currentWindow.redraws=3,this.tabHandle.changed=!0}var _=this.tabHandle.position==r;this.g.set_color(_?this.t.WINDOW_BG_COL:o||u?this.t.BUTTON_HOVER_COL:this.t.SEPARATOR_COL),e+=this._w+1;var f=this.g,c=this._x+this.buttonOffsetY,g=this._y+this.buttonOffsetY,p=this._w,m=0;0==m&&(m=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),f.fillRect(c,g,p,t),this.g.set_color(_?this.t.BUTTON_TEXT_COL:this.t.LABEL_COL),this.drawString(this.g,this.tabNames[r],this.t.TEXT_OFFSET,0,0),_&&(this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x+this.buttonOffsetY+1,this._y+this.buttonOffsetY+t,this._w-1,this.t.LINE_STRENGTH*this.SCALE))}this._x=0,this._y=n,this._w=0|(this.currentWindow.scrollEnabled?this._windowW-(0|this.t.SCROLL_W*this.SCALE):this._windowW)}},panel:function(e,t,n,i){return(null==i&&(i=!1),null==n&&(n=0),!this.isVisible(this.t.ELEMENT_H*this.SCALE))?(this.endElement(),e.selected):(this.getReleased()&&(e.selected=!e.selected),0<n&&(this.g.set_color(this.t.PANEL_BG_COL),this.g.fillRect(this._x,this._y,this._w,this.t.ELEMENT_H*this.SCALE)),i?this.drawTree(e.selected):this.drawArrow(e.selected),this.g.set_color(this.t.PANEL_TEXT_COL),this.g.set_opacity(1),this.drawString(this.g,t,this.titleOffsetX,0),this.endElement(),e.selected)},image:function(e,t,n,i,d,a,s){null==s&&(s=0),null==a&&(a=0),null==d&&(d=0),null==i&&(i=0),null==t&&(t=-1);var o=(0<a?a:e.get_width())*this.SCALE,u=(0<s?s:e.get_height())*this.SCALE,l=Math.min(o,this._w),_=this._x;if(this.imageScrollAlign){l=Math.min(o,this._w-2*this.buttonOffsetY),_+=this.buttonOffsetY;var f=null!=this.currentWindow&&this.currentWindow.scrollEnabled;if(!f){var c=-1==this.curRatio?1:this.ratios[this.curRatio];l-=(0|this.t.SCROLL_W*this.SCALE)*c,_+=(0|this.t.SCROLL_W*this.SCALE)*c/2}}var r=null==n?l/o:n/u;if(null==n?n=u*r:l=o*r,!this.isVisible(n))return this.endElement(n),0;var g=this.getStarted(n),p=this.getPushed(n),m=this.getReleased(n),b=this.getHover(n);this.g.set_color(t),this.enabled||this.fadeColor();var S=n;return 0<a?this.imageInvertY?this.g.drawScaledSubImage(e,i,d,a,s,_,this._y+S,l,-S):this.g.drawScaledSubImage(e,i,d,a,s,_,this._y,l,S):this.imageInvertY?this.g.drawScaledImage(e,_,this._y+S,l,-S):this.g.drawScaledImage(e,_,this._y,l,S),this.endElement(n),g?1:m?3:p?2:0},text:function(e,t,n){if(null==n&&(n=0),null==t&&(t=0),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),0;var i=this.getStarted(),d=this.getPushed(),a=this.getReleased(),r=this.getHover();return 0!=n&&(this.g.set_color(n),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.t.TEXT_OFFSET,0,t),this.endElement(),i?1:a?3:d?2:0},startTextEdit:function(e){this.isTyping=!0,this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=e,this.textSelectedCurrentText=e.text,this.tabPressed&&(this.tabPressed=!1,this.isKeyPressed=!1),this.tabPressedHandle=e,this.cursorX=e.text.length,this.cursorY=0,this.highlightAnchor=0,null!=Qt.get()&&Qt.get().show()},submitTextEdit:function(){this.submitTextHandle.text=this.textToSubmit,this.submitTextHandle.changed=this.changed=!0,this.submitTextHandle=null,this.textToSubmit="",this.textSelectedCurrentText=""},updateTextEdit:function(e){null==e&&(e=0);var t=this.textSelectedCurrentText;if(this.isKeyPressed){37==this.key?0<this.cursorX&&this.cursorX--:39==this.key?this.cursorX<t.length&&this.cursorX++:8==this.key?0<this.cursorX&&this.highlightAnchor==this.cursorX?(t=f.substr(t,0,this.cursorX-1)+f.substr(t,this.cursorX,t.length),this.cursorX--):this.highlightAnchor<this.cursorX?(t=f.substr(t,0,this.highlightAnchor)+f.substr(t,this.cursorX,t.length),this.cursorX=this.highlightAnchor):t=f.substr(t,0,this.cursorX)+f.substr(t,this.highlightAnchor,t.length):46==this.key?this.highlightAnchor==this.cursorX?t=f.substr(t,0,this.cursorX)+f.substr(t,this.cursorX+1,null):this.highlightAnchor<this.cursorX?(t=f.substr(t,0,this.highlightAnchor)+f.substr(t,this.cursorX,t.length),this.cursorX=this.highlightAnchor):t=f.substr(t,0,this.cursorX)+f.substr(t,this.highlightAnchor,t.length):13==this.key?this.deselectText():27==this.key?(this.textSelectedCurrentText=this.textSelectedHandle.text,this.deselectText()):9==this.key?(this.tabPressed=!0,this.deselectText(),this.key=null):36==this.key?this.cursorX=0:35==this.key?this.cursorX=t.length:16!=this.key&&20!=this.key&&17!=this.key&&18!=this.key&&38!=this.key&&40!=this.key&&null!=this.char&&""!=this.char&&32<=f.cca(this.char,0)&&(t=f.substr(t,0,this.highlightAnchor)+this.char+f.substr(t,this.cursorX,null),this.cursorX=this.cursorX+1>t.length?t.length:this.cursorX+1);var n=this.isShiftDown&&(37==this.key||39==this.key||16==this.key);n||this.isCtrlDown||(this.highlightAnchor=this.cursorX)}""!=Ln.textToPaste&&(t=f.substr(t,0,this.highlightAnchor)+Ln.textToPaste+f.substr(t,this.cursorX,null),this.cursorX+=Ln.textToPaste.length,this.highlightAnchor=this.cursorX,Ln.textToPaste=""),Ln.textToCopy=this.highlightAnchor==this.cursorX?t:this.highlightAnchor<this.cursorX?t.substring(this.highlightAnchor,this.cursorX):t.substring(this.cursorX,this.highlightAnchor),Ln.isCut&&(this.highlightAnchor==this.cursorX?t="":this.highlightAnchor<this.cursorX?(t=f.substr(t,0,this.highlightAnchor)+f.substr(t,this.cursorX,t.length),this.cursorX=this.highlightAnchor):t=f.substr(t,0,this.cursorX)+f.substr(t,this.highlightAnchor,t.length));var i=this.t.TEXT_OFFSET,d=this.t.ELEMENT_H*this.SCALE,a=d-3*this.buttonOffsetY;if(this.highlightAnchor!=this.cursorX){var r=this.cursorX,s=this.highlightAnchor;this.highlightAnchor<this.cursorX&&(r=this.highlightAnchor,s=this.cursorX);var o=f.substr(t,r,s-r),u=this.ops.font.width(this.fontSize,o),l=this.ops.font.width(this.fontSize,f.substr(t,0,r)),_=0==e?this._x+l+i:this._x+this._w-u-i;2==e&&(_-=this.ops.font.width(this.fontSize,f.substr(t,s,t.length))),this.g.set_color(this.t.ACCENT_SELECT_COL),this.g.fillRect(_,this._y+this.cursorY*d+1.5*this.buttonOffsetY,u*this.SCALE,a)}var c=_e.time();if(.5>c%1){var g=0==e?f.substr(t,0,this.cursorX):t.substring(this.cursorX,t.length),p=this.ops.font.width(this.fontSize,g),h=0==e?this._x+p+i:this._x+this._w-p-i;this.g.set_color(this.t.TEXT_COL),this.g.fillRect(h,this._y+this.cursorY*d+1.5*this.buttonOffsetY,this.SCALE,a)}this.textSelectedCurrentText=t},textInput:function(e,t,n){if(null==n&&(n=0),null==t&&(t=""),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),e.text;var i=this.getHover();i&&null!=Ln.onTextHover&&Ln.onTextHover(),this.g.set_color(i?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var d=this.g,a=this.t.FILL_ACCENT_BG,r=this._x+this.buttonOffsetY,s=this._y+this.buttonOffsetY,o=this._w-2*this.buttonOffsetY,u=this.t.BUTTON_H*this.SCALE,l=0;0==l&&(l=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),a?d.fillRect(r,s,o,u):d.drawRect(r,s,o,u,l);var _=this.getReleased()||this.tabPressed;if(this.textSelectedHandle!=e&&_&&this.startTextEdit(e),this.textSelectedHandle==e&&this.updateTextEdit(n),this.submitTextHandle==e?this.submitTextEdit():e.changed=!1,""!=t){this.g.set_color(this.t.LABEL_COL);var f=2==n?0:2,c=0==f?7:0;this.drawString(this.g,t,c,0,f)}return this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle==e?this.drawString(this.g,this.textSelectedCurrentText,null,0,n):this.drawString(this.g,e.text,null,0,n),this.endElement(),e.text},deselectText:function(){this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=null,this.isTyping=!1,null!=this.currentWindow&&(this.currentWindow.redraws=2),null!=Qt.get()&&Qt.get().hide(),this.highlightAnchor=this.cursorX},button:function(e,t,n){if(null==n&&(n=""),null==t&&(t=1),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),!1;var i=this.getReleased(),d=this.getPushed(),a=this.getHover();i&&(this.changed=!0),this.g.set_color(d?this.t.BUTTON_PRESSED_COL:a?this.t.BUTTON_HOVER_COL:this.t.BUTTON_COL);var r=this.g,s=this.t.FILL_BUTTON_BG,o=this._x+this.buttonOffsetY,u=this._y+this.buttonOffsetY,l=this._w-2*this.buttonOffsetY,_=this.t.BUTTON_H*this.SCALE,f=0;return 0==f&&(f=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),s?r.fillRect(o,u,l,_):r.drawRect(o,u,l,_,f),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,e,this.t.TEXT_OFFSET,0,t),""!=n&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,n,this.t.TEXT_OFFSET,0,2==t?0:2)),this.endElement(),i},check:function(e,t){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),e.selected;this.getReleased()?(e.selected=!e.selected,e.changed=this.changed=!0):e.changed=!1;var n=this.getHover();return this.drawCheck(e.selected,n),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.titleOffsetX,0,0),this.endElement(),e.selected},radio:function(e,t,n){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),e.position==t;this.getReleased()?(e.position=t,e.changed=this.changed=!0):e.changed=!1;var i=this.getHover();return this.drawRadio(e.position==t,i),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,n,this.titleOffsetX,0),this.endElement(),e.position==t},inlineRadio:function(e,t){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),e.position;this.getReleased()?(++e.position>=t.length&&(e.position=0),e.changed=this.changed=!0):e.changed=!1;var n=this.getHover();return this.drawInlineRadio(t[e.position],n),this.endElement(),e.position},combo:function(e,t,n,i,d){if(null==d&&(d=0),null==i&&(i=!1),null==n&&(n=""),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),e.position;this.getReleased()&&null==this.comboSelectedHandle&&(this.inputEnabled=!1,this.comboSelectedHandle=e,this.comboSelectedWindow=this.currentWindow,this.comboSelectedAlign=d,this.comboSelectedTexts=t,this.comboSelectedLabel=n,this.comboSelectedX=0|this._x+this._windowX,this.comboSelectedY=0|this._y+this._windowY+this.t.ELEMENT_H*this.SCALE,this.comboSelectedW=0|this._w),e==this.submitComboHandle?(e.position=this.comboToSubmit,this.submitComboHandle=null,e.changed=this.changed=!0):e.changed=!1;var a=this.getHover();if(a){this.g.set_color(this.t.ACCENT_HOVER_COL);var r=this.g,s=this.t.FILL_ACCENT_BG,o=this._x+this.buttonOffsetY,u=this._y+this.buttonOffsetY,l=this._w-2*this.buttonOffsetY,_=this.t.BUTTON_H*this.SCALE,f=0;0==f&&(f=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),s?r.fillRect(o,u,l,_):r.drawRect(o,u,l,_,f)}else{this.g.set_color(this.t.ACCENT_COL);var c=this.g,g=this.t.FILL_ACCENT_BG,p=this._x+this.buttonOffsetY,h=this._y+this.buttonOffsetY,m=this._w-2*this.buttonOffsetY,b=this.t.BUTTON_H*this.SCALE,x=0;0==x&&(x=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),g?c.fillRect(p,h,m,b):c.drawRect(p,h,m,b,x)}var S=this._x+this._w-this.arrowOffsetX-8,y=this._y+this.arrowOffsetY+3;return this.g.fillTriangle(S,y,S+this.t.ARROW_SIZE*this.SCALE,y,S+this.t.ARROW_SIZE*this.SCALE/2,y+this.t.ARROW_SIZE*this.SCALE/2),i&&""!=n&&(0==d&&(this._x-=15),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,n,null,0,0==d?2:0),0==d&&(this._x+=15)),2==d&&(this._x-=15),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t[e.position],null,0,d),2==d&&(this._x+=15),this.endElement(),e.position},slider:function(e,t,n,i,d,a,r,s,o){if(null==o&&(o=!0),null==s&&(s=2),null==r&&(r=!0),null==a&&(a=100),null==d&&(d=!1),null==i&&(i=1),null==n&&(n=0),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),e.value;if(this.getStarted()&&(e.scrolling=!0,this.scrollingHandle=e,this.isScrolling=!0),e.changed=!1,e.scrolling){var u=i-n,l=this._x+this._windowX+this.buttonOffsetY,_=this._w-2*this.buttonOffsetY,f=n+(this.inputX-l)*(u/_);e.value=Math.round(f*a)/a,e.value<n?e.value=n:e.value>i&&(e.value=i),e.changed=this.changed=!0}var c=this.getHover();this.drawSlider(e.value,n,i,d,c);var g=(this.getReleased()||this.tabPressed)&&o;g&&(e.text=e.value+"",this.startTextEdit(e));var p=0==s?2:0;return this.textSelectedHandle==e&&this.updateTextEdit(p),this.submitTextHandle==e&&(this.submitTextEdit(),e.value=parseFloat(e.text)),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,t,null,0,s),r&&(this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle==e?this.drawString(this.g,this.textSelectedCurrentText,null,0,p):this.drawString(this.g,e.value+"",null,0,p)),this.endElement(),e.value},separator:function(e,t){return null==t&&(t=!0),null==e&&(e=4),this.isVisible(this.t.ELEMENT_H*this.SCALE)?void(t&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(this._x,this._y,this._w,e*this.SCALE)),this._y+=e*this.SCALE):void(this._y+=e*this.SCALE)},tooltip:function(e){this.tooltipText=e,this.tooltipY=this._y+this._windowY},tooltipImage:function(e,t){this.tooltipImg=e,this.tooltipImgMaxWidth=t,this.tooltipInvertY=this.imageInvertY,this.tooltipY=this._y+this._windowY},drawArrow:function(e){var t=this._x+this.arrowOffsetX,n=this._y+this.arrowOffsetY;this.g.set_color(this.t.ARROW_COL),e?this.g.fillTriangle(t,n,t+this.t.ARROW_SIZE*this.SCALE,n,t+this.t.ARROW_SIZE*this.SCALE/2,n+this.t.ARROW_SIZE*this.SCALE):this.g.fillTriangle(t,n,t,n+this.t.ARROW_SIZE*this.SCALE,t+this.t.ARROW_SIZE*this.SCALE,n+this.t.ARROW_SIZE*this.SCALE/2)},drawTree:function(e){var t=7*this.SCALE,n=this._x+this.arrowOffsetX+1,i=this._y+this.arrowOffsetY+1;this.g.set_color(this.t.ARROW_COL),e?this.g.fillRect(n,i+t/2-1,t,t/8):(this.g.fillRect(n,i+t/2-1,t,t/8),this.g.fillRect(n+t/2-1,i,t/8,t))},drawCheck:function(e,t){var n=this._x+this.checkOffsetX,i=this._y+this.checkOffsetY;this.g.set_color(t?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var d=this.g,a=this.t.FILL_ACCENT_BG,r=this.t.CHECK_SIZE*this.SCALE,s=this.t.CHECK_SIZE*this.SCALE,o=0;if(0==o&&(o=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),a?d.fillRect(n,i,r,s):d.drawRect(n,i,r,s,o),e){this.g.set_color(-1),this.enabled||this.fadeColor();var u=0|this.t.CHECK_SELECT_SIZE*this.SCALE;this.g.drawScaledImage(this.checkSelectImage,n+this.checkSelectOffsetX,i+this.checkSelectOffsetY,u,u)}},drawRadio:function(e,t){var n=this._x+this.radioOffsetX,i=this._y+this.radioOffsetY;this.g.set_color(t?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var d=this.g,a=this.t.FILL_ACCENT_BG,r=this.t.CHECK_SIZE*this.SCALE,s=this.t.CHECK_SIZE*this.SCALE,o=0;0==o&&(o=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),a?d.fillRect(n,i,r,s):d.drawRect(n,i,r,s,o),e&&(this.g.set_color(this.t.ACCENT_SELECT_COL),!this.enabled&&this.fadeColor(),this.g.fillRect(n+this.radioSelectOffsetX,i+this.radioSelectOffsetY,this.t.CHECK_SELECT_SIZE*this.SCALE,this.t.CHECK_SELECT_SIZE*this.SCALE))},drawInlineRadio:function(e,t){t?(this.g.set_color(this.t.ACCENT_HOVER_COL),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)):(this.g.set_color(this.t.ACCENT_COL),!this.enabled&&this.fadeColor(),this.g.drawRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.titleOffsetX,0,1)},drawSlider:function(e,t,n,i,d){var a=this._x+this.buttonOffsetY,r=this._y+this.buttonOffsetY,s=this._w-2*this.buttonOffsetY;this.g.set_color(d?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var o=this.g,u=this.t.FILL_ACCENT_BG,l=this.t.BUTTON_H*this.SCALE,_=0;0==_&&(_=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),u?o.fillRect(a,r,s,l):o.drawRect(a,r,s,l,_),this.g.set_color(d?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var f=(e-t)/(n-t),c=8*this.SCALE,g=i?a:a+(s-c)*f,p=i?s*f:c;p=Math.max(Math.min(p,s),0);var h=this.g,m=this.t.BUTTON_H*this.SCALE,b=0;0==b&&(b=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),h.fillRect(g,r,p,m)},drawCombo:function(){var e=this.g;this.globalG.set_color(this.t.SEPARATOR_COL);var t=0|this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE,n=(this.comboSelectedTexts.length+1)*t;this.globalG.begin(!1);var d=this.comboSelectedY+n>pe.windowHeight(),a=d?this.comboSelectedY-n-(0|this.t.ELEMENT_H*this.SCALE):this.comboSelectedY;this.globalG.fillRect(this.comboSelectedX,a,this.comboSelectedW,n),this.beginLayout(this.globalG,this.comboSelectedX,a,this.comboSelectedW),d&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2),this._y+=t,this.fill(0,0,this._w/this.SCALE,this.SCALE,this.t.ACCENT_SELECT_COL)),this.inputEnabled=!0;for(var r=this.t.BUTTON_COL,s=0,o=this.comboSelectedTexts.length;s<o;){var u=s++,i=d?this.comboSelectedTexts.length-1-u:u;if(this.t.BUTTON_COL=i==this.comboSelectedHandle.position?this.t.PANEL_BG_COL:this.t.SEPARATOR_COL,this.button(this.comboSelectedTexts[i],this.comboSelectedAlign)){this.comboToSubmit=i,this.submitComboHandle=this.comboSelectedHandle,null!=this.comboSelectedWindow&&(this.comboSelectedWindow.redraws=2);break}}this.t.BUTTON_COL=r,d||(this.fill(0,0,this._w/this.SCALE,this.SCALE,this.t.ACCENT_SELECT_COL),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2)),(this.inputReleased||this.isEscapeDown)&&!Ln.comboFirst?(this.comboSelectedHandle=null,Ln.comboFirst=!0):Ln.comboFirst=!1,this.inputEnabled=null==this.comboSelectedHandle,this.endLayout(!1),this.globalG.end(),this.g=e},drawTooltip:function(){this.globalG.set_color(this.t.TEXT_COL);for(var e=this.tooltipText.split("\n"),t=0,n=0;n<e.length;){var d=e[n];++n;var a=this.ops.font.width(this.fontSize,d);a>t&&(t=a)}this.tooltipX=Math.min(this.tooltipX,pe.windowWidth()-t-20),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,t+20,.6*(this.t.ELEMENT_H*this.SCALE*e.length)),this.globalG.set_font(this.ops.font),this.globalG.set_fontSize(this.fontSize),this.globalG.set_color(this.t.ACCENT_COL);for(var r=0,s=e.length;r<s;){var o=r++;this.globalG.drawString(e[o],this.tooltipX+5,this.tooltipY+o*this.fontSize)}this.globalG.end()},drawTooltipImage:function(){var e=this.tooltipImg.get_width();null!=this.tooltipImgMaxWidth&&e>this.tooltipImgMaxWidth&&(e=this.tooltipImgMaxWidth);var t=this.tooltipImg.get_height()*(e/this.tooltipImg.get_width());this.tooltipX=Math.min(this.tooltipX,pe.windowWidth()-e-20),this.tooltipY=Math.min(this.tooltipY,pe.windowHeight()-t-20),this.globalG.set_color(-16777216),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,e,t),this.globalG.set_color(-1),this.tooltipInvertY?this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY+t,e,-t):this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY,e,t),this.globalG.end()},drawString:function(e,t,n,i,d){null==d&&(d=0),null==i&&(i=0);var a=0|this._w/(0|this.fontSize/2);t.length>a&&(t=t.substring(0,a)+".."),null==n&&(n=this.t.TEXT_OFFSET),n*=this.SCALE,e.set_font(this.ops.font),e.set_fontSize(this.fontSize),1==d?n=this._w/2-this.ops.font.width(this.fontSize,t)/2:2==d&&(n=this._w-this.ops.font.width(this.fontSize,t)-this.t.TEXT_OFFSET),this.enabled||this.fadeColor(),e.set_pipeline(this.rtTextPipeline),e.drawString(t,this._x+n,this._y+this.fontOffsetY+i),e.set_pipeline(null)},endElement:function(e){return null==this.currentWindow?void(this._y+=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE):void(0==this.currentWindow.layout?-1==this.curRatio||null!=this.ratios&&this.curRatio==this.ratios.length-1?(null==e&&(e=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE),this._y+=e,null!=this.ratios&&this.curRatio==this.ratios.length-1&&(this.curRatio=-1,this.ratios=null,this._x=this.xBeforeSplit,this._w=this.wBeforeSplit)):(this.curRatio++,this._x+=this._w,this._w=0|this.wBeforeSplit*this.ratios[this.curRatio]):this._x+=this._w+this.t.ELEMENT_OFFSET*this.SCALE)},row:function(e){this.ratios=e,this.curRatio=0,this.xBeforeSplit=this._x,this.wBeforeSplit=this._w,this._w=0|this._w*e[this.curRatio]},indent:function(){this._x+=0|this.t.TAB_W*this.SCALE,this._w-=0|this.t.TAB_W*this.SCALE},unindent:function(){this._x-=0|this.t.TAB_W*this.SCALE,this._w+=0|this.t.TAB_W*this.SCALE},fadeColor:function(){this.g.set_color(Q.fromFloats(.00392156862745098*((16711680&this.g.get_color())>>>16),.00392156862745098*((65280&this.g.get_color())>>>8),.00392156862745098*(255&this.g.get_color()),.25))},fill:function(e,t,n,i,d){this.g.set_color(d),this.enabled||this.fadeColor(),this.g.fillRect(this._x+e*this.SCALE,this._y+t*this.SCALE,n*this.SCALE,i*this.SCALE),this.g.set_color(-1)},rect:function(e,t,n,i,d,a){null==a&&(a=1),this.g.set_color(d),this.enabled||this.fadeColor(),this.g.drawRect(this._x+e*this.SCALE,this._y+t*this.SCALE,n*this.SCALE,i*this.SCALE,a),this.g.set_color(-1)},drawRect:function(e,t,n,i,d,a,r){null==r&&(r=0),0==r&&(r=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),t?e.fillRect(n,i,d,a):e.drawRect(n,i,d,a,r)},isVisible:function(e){return!(null!=this.currentWindow)||!!(0<this._y+e)&&this._y<this.currentWindow.texture.get_height()},getReleased:function(e){return null==e&&(e=-1),this.isReleased=this.enabled&&this.inputEnabled&&this.inputReleased&&this.getHover(e)&&this.getInitialHover(e),this.isReleased},getPushed:function(e){return null==e&&(e=-1),this.isPushed=this.enabled&&this.inputEnabled&&this.inputDown&&this.getHover(e)&&this.getInitialHover(e),this.isPushed},getStarted:function(e){return null==e&&(e=-1),this.isStarted=this.enabled&&this.inputEnabled&&this.inputStarted&&this.getHover(e),this.isStarted},getInitialHover:function(e){return null==e&&(e=-1),-1==e&&(e=this.t.ELEMENT_H*this.SCALE),!!(this.enabled&&this.inputEnabled&&this.inputInitialX>=this._windowX+this._x&&this.inputInitialX<this._windowX+this._x+this._w&&this.inputInitialY>=this._windowY+this._y)&&this.inputInitialY<this._windowY+this._y+e},getHover:function(e){return null==e&&(e=-1),-1==e&&(e=this.t.ELEMENT_H*this.SCALE),this.isHovered=this.enabled&&this.inputEnabled&&this.inputX>=this._windowX+this._x&&this.inputX<this._windowX+this._x+this._w&&this.inputY>=this._windowY+this._y&&this.inputY<this._windowY+this._y+e,this.isHovered},getInputInRect:function(e,t,n,i,d){return null==d&&(d=1),!!(this.enabled&&this.inputEnabled&&this.inputX>=e*d&&this.inputX<(e+n)*d&&this.inputY>=t*d)&&this.inputY<(t+i)*d},onMouseDown:function(e,t,n){0==e?this.inputStarted=!0:this.inputStartedR=!0,0==e?this.inputDown=!0:this.inputDownR=!0;var i=0|t*this.ops.scaleTexture,d=0|n*this.ops.scaleTexture;this.setInputPosition(i,d),this.inputInitialX=i,this.inputInitialY=d},onMouseUp:function(e,t,n){0==e?this.isScrolling?(this.isScrolling=!1,null!=this.scrollingHandle&&(this.scrollingHandle.scrolling=!1),t==this.inputInitialX&&n==this.inputInitialY&&(this.inputReleased=!0)):this.inputReleased=!0:1==e&&(this.inputReleasedR=!0),0==e?this.inputDown=!1:this.inputDownR=!1,this.setInputPosition(0|t*this.ops.scaleTexture,0|n*this.ops.scaleTexture),this.deselectText()},onMouseMove:function(e,t){this.setInputPosition(0|e*this.ops.scaleTexture,0|t*this.ops.scaleTexture)},onMouseWheel:function(e){this.inputWheelDelta=e},setInputPosition:function(e,t){this.inputDX+=e-this.inputX,this.inputDY+=t-this.inputY,this.inputX=e,this.inputY=t},onKeyDown:function(e){switch(this.key=e,this.isKeyPressed=!0,this.isKeyDown=!0,e){case 8:this.isBackspaceDown=!0;break;case 13:this.isReturnDown=!0;break;case 16:this.isShiftDown=!0;break;case 17:this.isCtrlDown=!0;break;case 18:this.isAltDown=!0;break;case 27:this.isEscapeDown=!0;break;case 32:this.char=" ";break;case 46:this.isDeleteDown=!0;break;default:}},onKeyUp:function(e){switch(this.isKeyDown=!1,e){case 8:this.isBackspaceDown=!1;break;case 13:this.isReturnDown=!1;break;case 16:this.isShiftDown=!1;break;case 17:this.isCtrlDown=!1;break;case 18:this.isAltDown=!1;break;case 27:this.isEscapeDown=!1;break;case 46:this.isDeleteDown=!1;break;default:}},onKeyPress:function(e){this.char=e,this.isKeyPressed=!0},onCut:function(){return Ln.isCut=!0,this.onCopy()},onCopy:function(){return Ln.isCopy=!0,Ln.textToCopy},onPaste:function(e){Ln.isPaste=!0,Ln.textToPaste=e},ELEMENT_W:function(){return this.t.ELEMENT_W*this.SCALE},ELEMENT_H:function(){return this.t.ELEMENT_H*this.SCALE},ELEMENT_OFFSET:function(){return this.t.ELEMENT_OFFSET*this.SCALE},ARROW_SIZE:function(){return this.t.ARROW_SIZE*this.SCALE},BUTTON_H:function(){return this.t.BUTTON_H*this.SCALE},CHECK_SIZE:function(){return this.t.CHECK_SIZE*this.SCALE},CHECK_SELECT_SIZE:function(){return this.t.CHECK_SELECT_SIZE*this.SCALE},SCROLL_W:function(){return 0|this.t.SCROLL_W*this.SCALE},TEXT_OFFSET:function(){return this.t.TEXT_OFFSET},TAB_W:function(){return 0|this.t.TAB_W*this.SCALE},LINE_STRENGTH:function(){return this.t.LINE_STRENGTH*this.SCALE},FLASH_SPEED:function(){return .5},TOOLTIP_DELAY:function(){return 1},resize:function(e,t,n,i){null==i&&(i=0),e.redraws=2,null!=e.texture&&e.texture.unload(),1>t&&(t=1),1>n&&(n=1),e.texture=de.createRenderTarget(t,n,0,0,1,i),e.texture.get_g2().set_imageScaleQuality(1)},__class__:Ln},t.$haxeUID|=0,s.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(e){return 65536>e?String.fromCharCode(e):String.fromCharCode((e>>10)+55232)+String.fromCharCode((1023&e)+56320)}),String.prototype.__class__=s.String=String,String.__name__=!0,s.Array=Array,Array.__name__=!0,Date.prototype.__class__=s.Date=Date,Date.__name__="Date";var Bn={},On={},Nn=Number,An=Boolean,Pn={},Rn={};k.count=0;var Vn={};Object.defineProperty(W.prototype,"message",{get:function(){return this.val+""}}),U.__toStr={}.toString,null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=G.sliceImpl),l.defaultWindowW=240,l.windowW=l.defaultWindowW,l.coffX=70,l.coffY=50,l.modalW=625,l.modalH=545,l.modalHeaderH=66,l.modalRectW=625,l.modalRectH=545,l.path="/",g.cwd="",E.DEFAULT_RESOLVER=new T,E.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",M.helper=new DataView(new ArrayBuffer(8)),K.images=new z,K.sounds=new X,K.blobs=new Y,K.fonts=new j,K.videos=new Z,Q.Black=-16777216,Q.White=-1,Q.Red=-65536,Q.Blue=-16776961,Q.Green=-16711936,Q.Magenta=-65281,Q.Yellow=-256,Q.Cyan=-16711681,Q.Purple=-8388480,Q.Pink=-16181,Q.Orange=-23296,Q.Transparent=0,Q.invMaxChannelValue=.00392156862745098,J.displays=[],ee.Default=new ee(!1,!1,!1),_e.timeWarpSaveTime=10,_e.DIF_COUNT=3,_e.maxframetime=.5,_e.startTime=0,fe.painter_colored_fragData0="s274:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgpvdXQgdmVjNCBGcmFnQ29sb3I7CmluIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIEZyYWdDb2xvciA9IGZyYWdtZW50Q29sb3I7Cn0KCg",fe.painter_colored_vertData0="s439:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",fe.painter_image_fragData0="s506:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7CgppbiB2ZWMyIHRleENvb3JkOwppbiB2ZWM0IGNvbG9yOwpvdXQgdmVjNCBGcmFnQ29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZSh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgRnJhZ0NvbG9yID0gdGV4Y29sb3I7Cn0KCg",fe.painter_image_vertData0="s508:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",fe.painter_text_fragData0="s402:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7CgpvdXQgdmVjNCBGcmFnQ29sb3I7CmluIHZlYzQgZnJhZ21lbnRDb2xvcjsKaW4gdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIEZyYWdDb2xvciA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUodGV4LCB0ZXhDb29yZCkueCAqIGZyYWdtZW50Q29sb3Iudyk7Cn0KCg",fe.painter_text_vertData0="s530:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",fe.painter_video_fragData0="s506:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7CgppbiB2ZWMyIHRleENvb3JkOwppbiB2ZWM0IGNvbG9yOwpvdXQgdmVjNCBGcmFnQ29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZSh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgRnJhZ0NvbG9yID0gdGV4Y29sb3I7Cn0KCg",fe.painter_video_vertData0="s508:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",pe.renderListeners=[],pe.foregroundListeners=[],pe.resumeListeners=[],pe.pauseListeners=[],pe.backgroundListeners=[],pe.shutdownListeners=[],pe.dropFilesListeners=[],he.maxGamepads=4,he.mouseLockListeners=[],be.windows=[],xe.None=0,xe.FeatureResizable=1,xe.FeatureMinimizable=2,xe.FeatureMaximizable=4,xe.FeatureBorderless=8,xe.FeatureOnTop=16,ve.disableGcInteractions=!1,ve.intBox=new Ie(0),ke.channelCount=32,ke.lastAllocationCount=0,Ae.POLY=79764919,De.INVALID_BITS=-1,He.EOP=-1,He.M__PI=3.141592653589793,He.DIVTAB_NUMER=32,He.DIVTAB_DENOM=64,He.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],We.NO_CODE=255,We.delay=0,Ye.PACKET_ID=1,Ye.PACKET_COMMENT=3,Ye.PACKET_SETUP=5,Je.CONTINUED_PACKET=1,Je.FIRST_PAGE=2,Je.LAST_PAGE=4,it.MAX_CHANNELS=16,it.PUSHDATA_CRC_COUNT=4,it.FAST_HUFFMAN_LENGTH=10,it.FAST_HUFFMAN_TABLE_SIZE=1024,it.FAST_HUFFMAN_TABLE_MASK=1023,st.fontGlyphs=function(){for(var e=[],t=32,n,d;256>t;)d=t++,e.push(d);return n=e,n}(this),It.STBTT_vmove=1,It.STBTT_vline=2,It.STBTT_vcurve=3,It.STBTT_MACSTYLE_DONTCARE=0,It.STBTT_MACSTYLE_BOLD=1,It.STBTT_MACSTYLE_ITALIC=2,It.STBTT_MACSTYLE_UNDERSCORE=4,It.STBTT_MACSTYLE_NONE=8,It.STBTT_PLATFORM_ID_UNICODE=0,It.STBTT_PLATFORM_ID_MAC=1,It.STBTT_PLATFORM_ID_ISO=2,It.STBTT_PLATFORM_ID_MICROSOFT=3,It.STBTT_UNICODE_EID_UNICODE_1_0=0,It.STBTT_UNICODE_EID_UNICODE_1_1=1,It.STBTT_UNICODE_EID_ISO_10646=2,It.STBTT_UNICODE_EID_UNICODE_2_0_BMP=3,It.STBTT_UNICODE_EID_UNICODE_2_0_FULL=4,It.STBTT_MS_EID_SYMBOL=0,It.STBTT_MS_EID_UNICODE_BMP=1,It.STBTT_MS_EID_SHIFTJIS=2,It.STBTT_MS_EID_UNICODE_FULL=10,It.STBTT_MAC_EID_ROMAN=0,It.STBTT_MAC_EID_ARABIC=4,It.STBTT_MAC_EID_JAPANESE=1,It.STBTT_MAC_EID_HEBREW=5,It.STBTT_MAC_EID_CHINESE_TRAD=2,It.STBTT_MAC_EID_GREEK=6,It.STBTT_MAC_EID_KOREAN=3,It.STBTT_MAC_EID_RUSSIAN=7,It.STBTT_MS_LANG_ENGLISH=1033,It.STBTT_MS_LANG_ITALIAN=1040,It.STBTT_MS_LANG_CHINESE=2052,It.STBTT_MS_LANG_JAPANESE=1041,It.STBTT_MS_LANG_DUTCH=1043,It.STBTT_MS_LANG_KOREAN=1042,It.STBTT_MS_LANG_FRENCH=1036,It.STBTT_MS_LANG_RUSSIAN=1049,It.STBTT_MS_LANG_GERMAN=1031,It.STBTT_MS_LANG_SPANISH=1033,It.STBTT_MS_LANG_HEBREW=1037,It.STBTT_MS_LANG_SWEDISH=1053,It.STBTT_MAC_LANG_ENGLISH=0,It.STBTT_MAC_LANG_JAPANESE=11,It.STBTT_MAC_LANG_ARABIC=12,It.STBTT_MAC_LANG_KOREAN=23,It.STBTT_MAC_LANG_DUTCH=4,It.STBTT_MAC_LANG_RUSSIAN=32,It.STBTT_MAC_LANG_FRENCH=1,It.STBTT_MAC_LANG_SPANISH=6,It.STBTT_MAC_LANG_GERMAN=2,It.STBTT_MAC_LANG_SWEDISH=5,It.STBTT_MAC_LANG_HEBREW=10,It.STBTT_MAC_LANG_CHINESE_SIMPLIFIED=33,It.STBTT_MAC_LANG_ITALIAN=3,It.STBTT_MAC_LANG_CHINESE_TRAD=19,It.STBTT_MAX_OVERSAMPLE=8,It.STBTT_RASTERIZER_VERSION=2,At.bufferSize=1500,At.vertexSize=9,Pt.bufferSize=1e3,Pt.triangleBufferSize=1e3,Rt.bufferSize=1e3,Zt.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Zt.instances=[],Zt.connectListeners=[],Zt.disconnectListeners=[],Qt.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},Qt.keyBehavior=Kt.Default,Jt.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},nn.bufferSize=2e3,dn.mat=function(){var e=new Float32Array(16),t;return t=e,t}(this),rn.width=3,rn.height=3,sn.width=4,sn.height=4,_n.width=3,_n.height=3,fn.width=4,fn.height=4,mn.nextId=0,yn.START=0,yn.ENTITY_UPDATES=1,yn.CONTROLLER_UPDATES=2,yn.REMOTE_CALL=3,yn.PING=4,yn.SESSION_ERROR=5,yn.PLAYER_UPDATES=6,yn.RPC_SERVER=0,yn.RPC_ALL=1,wn.nextId=0,wn.objects=[],En.global=new En,Cn.assetMap=new C,Cn.events=[],Cn.screenW=-1,Cn.screenH=-1,Cn.locale="en",Cn.h=new En,Cn.elemId=-1,Cn.assetId=-1,In.dataPath="",In.lastPath="",In.kx=1,In.ky=.6666666666666666,In.kz=.3333333333333333,In.kw=3,In.ar=[0,0,0],In.Kx=0,In.Ky=-.3333333333333333,In.Kz=.6666666666666666,In.Kw=-1,In.e=1e-10,vn.i=0,kn.dark={FONT_SIZE:13,ELEMENT_W:100,ELEMENT_H:22,ELEMENT_OFFSET:4,ARROW_SIZE:5,BUTTON_H:17,CHECK_SIZE:15,CHECK_SELECT_SIZE:8,SCROLL_W:6,TEXT_OFFSET:8,TAB_W:12,LINE_STRENGTH:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-13421773,WINDOW_TINT_COL:-1,ACCENT_COL:-12303292,ACCENT_HOVER_COL:-12040120,ACCENT_SELECT_COL:-10461088,PANEL_BG_COL:-13421773,PANEL_TEXT_COL:-1513499,BUTTON_COL:-12040120,BUTTON_TEXT_COL:-1513499,BUTTON_HOVER_COL:-12895429,BUTTON_PRESSED_COL:-15000805,TEXT_COL:-1513499,LABEL_COL:-3618616,ARROW_COL:-1513499,SEPARATOR_COL:-14211289,HIGHLIGHT_COL:-14656100},kn.light={FONT_SIZE:26,ELEMENT_W:200,ELEMENT_H:44,ELEMENT_OFFSET:4,ARROW_SIZE:10,BUTTON_H:34,CHECK_SIZE:30,CHECK_SELECT_SIZE:16,SCROLL_W:12,TEXT_OFFSET:16,TAB_W:24,LINE_STRENGTH:2,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-1052689,WINDOW_TINT_COL:-14540254,ACCENT_COL:-1118482,ACCENT_HOVER_COL:-4473925,ACCENT_SELECT_COL:-5592406,PANEL_BG_COL:-1,PANEL_TEXT_COL:-14540254,BUTTON_COL:-3355444,BUTTON_TEXT_COL:-14540254,BUTTON_HOVER_COL:-5000269,BUTTON_PRESSED_COL:-5131855,TEXT_COL:-6710887,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-6710887,HIGHLIGHT_COL:-14656100},Ln.alwaysRedrawWindow=!0,Ln.textToPaste="",Ln.textToCopy="",Ln.isCut=!1,Ln.isCopy=!1,Ln.isPaste=!1,Ln.copyFrame=0,Ln.comboFirst=!0,g.main()})("undefined"==typeof exports?"undefined"==typeof window?"undefined"==typeof self?this:self:window:exports,"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window);